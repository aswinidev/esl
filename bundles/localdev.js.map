{"version":3,"file":"localdev.js","mappings":"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","sources":["webpack:///./src/common/test-media.ts","webpack:///../src/polyfills/list/dom.element.toggleAttribute.ts","webpack:///../src/polyfills/list/dom.keyboard.key.ts","webpack:///../src/polyfills/list/dom.node.isConnected.ts","webpack:///../src/polyfills/polyfills.validate.ts","webpack:///webpack/bootstrap","webpack:///webpack/runtime/global","webpack:///../src/modules/esl-utils/async/promise.ts","webpack:///../src/modules/esl-utils/async/debounce.ts","webpack:///../src/polyfills/es5-target-shim.ts","webpack:///./src/common/test-media-source.ts","webpack:///../src/modules/esl-utils/environment/export-ns.ts","webpack:///../src/modules/esl-utils/decorators/bind.ts","webpack:///../src/modules/lib.ts","webpack:///../src/modules/esl-utils/misc/array.ts","webpack:///../src/modules/esl-utils/dom/class.ts","webpack:///../src/modules/esl-utils/misc/object.ts","webpack:///../src/modules/esl-utils/misc/format.ts","webpack:///../src/modules/esl-base-element/decorators/attr.ts","webpack:///../src/modules/esl-base-element/decorators/bool-attr.ts","webpack:///../src/modules/esl-utils/dom/events.ts","webpack:///../src/modules/esl-base-element/core/esl-base-element.ts","webpack:///../src/modules/esl-utils/abstract/observable.ts","webpack:///../src/modules/esl-utils/misc/memoize.ts","webpack:///../src/modules/esl-utils/decorators/memoize.ts","webpack:///../src/modules/esl-utils/environment/device-detector.ts","webpack:///../src/modules/esl-media-query/core/common/screen-dpr.ts","webpack:///../src/modules/esl-media-query/core/common/screen-breakpoint.ts","webpack:///../src/modules/esl-media-query/core/common/env-shortcuts.ts","webpack:///../src/modules/esl-media-query/core/conditions/media-query-base.ts","webpack:///../src/modules/esl-media-query/core/conditions/media-query-condition.ts","webpack:///../src/modules/esl-media-query/core/conditions/media-query-containers.ts","webpack:///../src/modules/esl-media-query/core/esl-media-query.ts","webpack:///../src/modules/esl-media-query/core/esl-media-rule.ts","webpack:///../src/modules/esl-image/core/esl-image-iobserver.ts","webpack:///../src/modules/esl-media-query/core/esl-media-rule-list.ts","webpack:///../src/modules/esl-utils/dom/traversing.ts","webpack:///../src/modules/esl-traversing-query/core/esl-traversing-query.ts","webpack:///../src/modules/esl-image/core/esl-image-strategies.ts","webpack:///../src/modules/esl-media/core/esl-media-iobserver.ts","webpack:///../src/modules/esl-image/core/esl-image.ts","webpack:///../src/modules/esl-utils/async/raf.ts","webpack:///../src/modules/esl-utils/dom/keys.ts","webpack:///../src/modules/esl-media/core/esl-media-provider.ts","webpack:///../src/modules/esl-media/core/esl-media-registry.ts","webpack:///../src/modules/esl-media/core/esl-media-manager.ts","webpack:///../src/modules/esl-media/core/esl-media.ts","webpack:///../src/modules/esl-utils/async/delayed-task.ts","webpack:///../src/modules/esl-base-element/decorators/json-attr.ts","webpack:///../src/modules/esl-toggleable/core/esl-toggleable.ts","webpack:///../src/modules/esl-toggleable/core/esl-toggleable-dispatcher.ts","webpack:///../src/modules/esl-utils/dom/ready.ts","webpack:///../src/modules/esl-utils/decorators/ready.ts","webpack:///../src/modules/esl-utils/decorators/prop.ts","webpack:///../src/modules/esl-utils/dom/rect.ts","webpack:///../src/modules/esl-utils/dom/element.ts","webpack:///../src/modules/esl-utils/dom/scroll.ts","webpack:///../src/modules/esl-popup/core/esl-popup.ts","webpack:///../src/modules/esl-popup/core/esl-popup-position.ts","webpack:///../src/modules/esl-utils/dom/window.ts","webpack:///../src/modules/esl-panel/core/esl-panel.ts","webpack:///../src/modules/esl-panel-group/core/esl-panel-group.ts","webpack:///../src/modules/esl-trigger/core/esl-trigger.ts","webpack:///../src/modules/esl-tab/core/esl-tab.ts","webpack:///../src/modules/esl-a11y-group/core/esl-a11y-group.ts","webpack:///../src/modules/esl-utils/dom/rtl.ts","webpack:///../src/modules/esl-tab/core/esl-tabs.ts","webpack:///../src/modules/esl-scrollbar/core/esl-scrollbar.ts","webpack:///../src/modules/esl-alert/core/esl-alert.ts","webpack:///../src/modules/esl-utils/fixes/ie-fixes.ts","webpack:///../src/modules/esl-forms/esl-select-list/core/esl-select-item.ts","webpack:///../src/modules/esl-forms/esl-select-list/core/esl-select-wrapper.ts","webpack:///../src/modules/esl-forms/esl-select-list/core/esl-select-list.ts","webpack:///../src/modules/esl-forms/esl-select/core/esl-select-renderer.ts","webpack:///../src/modules/esl-forms/esl-select/core/esl-select-dropdown.ts","webpack:///../src/modules/esl-forms/esl-select/core/esl-select.ts","webpack:///../src/modules/esl-utils/misc/uid.ts","webpack:///../src/modules/esl-footnotes/core/esl-footnotes-data.ts","webpack:///../src/modules/esl-footnotes/core/esl-footnotes.ts","webpack:///../src/modules/esl-tooltip/core/esl-tooltip.ts","webpack:///../src/modules/esl-footnotes/core/esl-note.ts","webpack:///../src/modules/esl-media/providers/iframe-provider.ts","webpack:///../src/modules/esl-media/providers/html5/media-provider.ts","webpack:///../src/modules/esl-media/providers/html5/audio-provider.ts","webpack:///../src/modules/esl-utils/dom/script.ts","webpack:///../src/modules/esl-media/providers/html5/video-provider.ts","webpack:///../src/modules/esl-media/providers/youtube-provider.ts","webpack:///../src/modules/esl-media/providers/brightcove-provider.ts","webpack:///../src/modules/draft/esl-carousel/core/esl-carousel-slide.ts","webpack:///../src/modules/draft/esl-carousel/core/view/esl-carousel-view.ts","webpack:///../src/modules/draft/esl-carousel/core/esl-carousel.ts","webpack:///../src/modules/draft/esl-carousel/core/view/esl-single-carousel-view.ts","webpack:///../src/modules/draft/esl-carousel/core/view/esl-multi-carousel-view.ts","webpack:///../src/modules/draft/esl-carousel/plugin/esl-carousel-plugin.ts","webpack:///../src/modules/draft/esl-carousel/plugin/esl-carousel-dots.plugin.ts","webpack:///../src/modules/draft/esl-carousel/plugin/esl-carousel-link.plugin.ts","webpack:///../src/modules/draft/esl-carousel/plugin/esl-carousel-touch.plugin.ts","webpack:///../src/modules/draft/esl-carousel/all.ts","webpack:///../src/modules/draft/esl-carousel/plugin/esl-carousel-autoplay.plugin.ts","webpack:///./src/localdev.ts"],"sourcesContent":["interface MediaTarget {\n  play(): any;\n  pause(): any;\n  stop(): any;\n}\n\ninterface TestMediaAction {\n  title: string;\n  action: (target: MediaTarget, actionName: string, action: TestMediaAction) => void;\n  render: (actionName: string, action: TestMediaAction) => HTMLElement;\n}\n\nclass TestMediaControls extends HTMLElement {\n\n  public static ACTIONS: { [key: string]: TestMediaAction } = {\n    play: {\n      title: 'Play',\n      action: (target: any) => target.play(),\n      render: renderButton\n    },\n    pause: {\n      title: 'Pause',\n      action: (target: any) => target.pause(),\n      render: renderButton\n    },\n    stop: {\n      title: 'Stop',\n      action: (target: any) => target.stop(),\n      render: renderButton\n    }\n  };\n  public static ACTIONS_ALL = Object.keys(TestMediaControls.ACTIONS).join(',');\n\n  get target() {\n    const targetSel = this.getAttribute('target');\n    return targetSel ? Array.from(document.querySelectorAll(targetSel)) : [];\n  }\n\n  get actions() {\n    return this.getAttribute('actions') || TestMediaControls.ACTIONS_ALL;\n  }\n\n  private render() {\n    const actionList = this.actions.split(',');\n\n    this.innerHTML = '';\n    for (const actionName of actionList) {\n      const action: TestMediaAction = TestMediaControls.ACTIONS[actionName];\n      if (!action) return;\n      this.appendChild(action.render(actionName, action));\n    }\n  }\n\n  private onClick(e: Event) {\n    const target = e.target as HTMLElement;\n    const actionName = target.dataset.action;\n    if (actionName && TestMediaControls.ACTIONS[actionName]) {\n      const actionDesc = TestMediaControls.ACTIONS[actionName];\n      const actionFn = actionDesc.action;\n      this.target.forEach(($el) => actionFn.call($el, $el, actionName, actionDesc));\n    }\n  }\n\n  protected connectedCallback() {\n    this.render();\n    this.addEventListener('click', this.onClick.bind(this));\n  }\n}\n\nfunction renderButton(actionName: string, action: TestMediaAction) {\n  const btn = document.createElement('button');\n  btn.className = 'btn btn-primary';\n  btn.dataset.action = actionName;\n  btn.textContent = action.title;\n  return btn;\n}\n\ncustomElements.define('test-media-controls', TestMediaControls);\n","/**\n * Group: DOM API shims\n * Target Browsers: `IE11`, `Edge < 18`, `Safari < 13`\n * Element.toggleAttribute polyfill\n */\nif (!Element.prototype.toggleAttribute) {\n  Element.prototype.toggleAttribute = function (name: string, force: boolean | undefined): boolean {\n    const has = this.hasAttribute(name);\n    const state = force === void 0 ? !has : !!force;\n\n    if (has !== state) {\n      (state) ? this.setAttribute(name, '') : this.removeAttribute(name);\n    }\n    return state;\n  };\n}\n","/**\n * Group: DOM API shims\n * Target Browsers: `IE11`, `Edge < 18`\n * KeyboardEvent.prototype.key shim to normalize key values to W3C spec\n * Based on published shim https://www.npmjs.com/package/shim-keyboard-event-key\n */\n(function (KeyboardEventProto) {\n  const desc = Object.getOwnPropertyDescriptor(KeyboardEventProto, 'key');\n  if (!desc) return;\n\n  const keyMap: Record<string, string> = {\n    Win: 'Meta',\n    Scroll: 'ScrollLock',\n    Spacebar: ' ',\n\n    Down: 'ArrowDown',\n    Left: 'ArrowLeft',\n    Right: 'ArrowRight',\n    Up: 'ArrowUp',\n\n    Del: 'Delete',\n    Apps: 'ContextMenu',\n    Esc: 'Escape',\n\n    Multiply: '*',\n    Add: '+',\n    Subtract: '-',\n    Decimal: '.',\n    Divide: '/',\n  };\n\n  Object.defineProperty(KeyboardEventProto, 'key', {\n    get() {\n      const key = desc.get!.call(this);\n      return Object.prototype.hasOwnProperty.call(keyMap, key) ? keyMap[key] : key;\n    },\n  });\n})(KeyboardEvent.prototype);\n","/**\n * Group: DOM polyfills\n * Target browsers: `IE11`, `Edge <= 18`\n * Node.isConnected polyfill\n */\nif (!('isConnected' in Node.prototype)) {\n  Object.defineProperty(Node.prototype, 'isConnected', {\n    get() {\n      return !this.ownerDocument ||\n        // eslint-disable-next-line no-bitwise\n        !(this.ownerDocument.compareDocumentPosition(this) & this.DOCUMENT_POSITION_DISCONNECTED);\n    }\n  });\n}\n","if (!('customElements' in window)) {\n  throw new Error('Browser is not support customElements, load polyfills before');\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","import type {AnyToAnyFnSignature} from '../misc/functions';\n\n/**\n * @returns Promise that will be resolved in `timeout` with optional `payload`\n */\nexport function promisifyTimeout<T>(timeout: number, payload?: T): Promise<T> {\n  return new Promise<T>((resolve) =>\n    setTimeout(resolve.bind(null, payload), timeout)\n  );\n}\n\n/** Interface to describe abstract listenable target */\nexport type ListenableTarget = {\n  addEventListener: (\n    event: string,\n    callback: (payload: any) => void,\n    options?: boolean | AddEventListenerOptions | undefined\n  ) => void;\n  removeEventListener: (\n    event: string,\n    callback: (payload: any) => void,\n    options?: boolean | AddEventListenerOptions | undefined\n  ) => void;\n};\n\n/**\n * @returns Promise that will be resolved by dispatching `event` on `target`\n * Or it will be rejected in `timeout` if it's specified\n * Optional `options` for addEventListener can be also specified\n */\nexport function promisifyEvent(\n  target: ListenableTarget,\n  event: string,\n  timeout?: number | null | undefined,\n  options?: boolean | AddEventListenerOptions\n): Promise<Event> {\n  return new Promise((resolve, reject) => {\n    function eventCallback(e: Event) {\n      target.removeEventListener(event, eventCallback, options);\n      resolve(e);\n    }\n\n    target.addEventListener(event, eventCallback, options);\n    if (typeof timeout === 'number' && timeout >= 0) {\n      setTimeout(() => reject(new Error('Rejected by timeout')), timeout);\n    }\n  });\n}\n\n/**\n * Short helper to make Promise from element state marker\n * @returns Promise that will be resolved if the target `marker` property is truthful or `event` is dispatched\n * @example\n * `const imgReady = promisifyMarker(eslImage, 'ready');`\n */\nexport function promisifyMarker(target: HTMLElement, marker: string, event: string = marker): Promise<HTMLElement> {\n  if ((target as any)[marker]) return Promise.resolve(target);\n  return promisifyEvent(target, event).then(() => target);\n}\n\n/**\n * Call `callback` limited by `tryCount` amount of times with interval in `timeout` ms\n * @returns Promise that will be resolved as soon as callback returns truthy value, or reject it by limit.\n */\nexport function tryUntil<T>(callback: () => T, tryCount = 2, timeout = 100): Promise<T> {\n  return new Promise((resolve, reject) => {\n    (function check() {\n      let result: T | undefined;\n      try {\n        result = callback();\n      } catch {\n        result = undefined;\n      }\n\n      if (result || (tryCount--) < 0) {\n        result ? resolve(result) : reject(new Error('Rejected by limit of tries'));\n      } else {\n        setTimeout(check, timeout);\n      }\n    })();\n  });\n}\n\n/** Deferred object represents promise with it's resolve/reject methods */\nexport type Deferred<T> = {\n  /** Wrapped promise */\n  promise: Promise<T>;\n  /** Function that resolves wrapped promise */\n  resolve: (arg: T) => void;\n  /** Function that rejects wrapped promise */\n  reject: (arg?: any) => void;\n};\n\n/**\n * Create Deferred Object that wraps promise and its resolve and reject callbacks\n */\nexport function createDeferred<T>(): Deferred<T> {\n  let reject: any;\n  let resolve: any;\n  // Both reject and resolve will be assigned anyway while the Promise constructing.\n  const promise = new Promise<T>((res, rej) => {\n    resolve = res;\n    reject = rej;\n  });\n  return {promise, resolve, reject};\n}\n\n/** Creates function type with the same signature but with the result type wrapped into promise */\nexport type PromisifyResultFn<F extends AnyToAnyFnSignature> =\n  ((...args: Parameters<F>) => Promise<ReturnType<F> | void>);\n\n/**\n * Safe wrap for Promise.resolve to use in Promise chain\n * @example\n * `const resolvedPromise = rejectedPromise.catch(resolvePromise);`\n */\nexport function resolvePromise<T>(arg: T | PromiseLike<T>): Promise<T> {\n  return Promise.resolve(arg);\n}\n\n/**\n * Safe wrap for Promise.reject to use in Promise chain\n * @example\n * `const rejectedPromise = resolvedPromise.then(rejectPromise);`\n */\nexport function rejectPromise<T = never>(arg?: T | PromiseLike<T>): Promise<T> {\n  return Promise.reject(arg);\n}\n\n/**\n * Promise utils helper class\n * Note: use individual methods in case you need correct \"tree shaking\"\n */\nexport abstract class PromiseUtils {\n  static fromTimeout = promisifyTimeout;\n  static fromEvent = promisifyEvent;\n  static fromMarker = promisifyMarker;\n\n  static tryUntil = tryUntil;\n\n  static deferred = createDeferred;\n  static resolve = resolvePromise;\n  static reject = rejectPromise;\n}\n","import {createDeferred} from './promise';\n\nimport type {AnyToAnyFnSignature} from '../misc/functions';\nimport type {Deferred, PromisifyResultFn} from './promise';\n\n/** Debounced<F> is a function wrapper type for a function decorated via debounce */\nexport interface Debounced<F extends AnyToAnyFnSignature> extends PromisifyResultFn<F> {\n  /** Promise of deferred function call */\n  promise: Promise<ReturnType<F> | void>;\n  /** Cancel debounced call */\n  cancel(): void;\n}\n\n/**\n * Creates a debounced function that implements {@link Debounced}.\n * Debounced function delays invoking func until after wait milliseconds have elapsed\n * since the last time the debounced function was invoked.\n * The func is invoked with the last arguments provided to the debounced function.\n * @param fn - function to decorate\n * @param wait - time to debounce\n */\nexport function debounce<F extends AnyToAnyFnSignature>(fn: F, wait = 10): Debounced<F> {\n  let timeout: number | null = null;\n  let deferred: Deferred<ReturnType<F>> | null = null;\n\n  function debouncedSubject(...args: any[]) {\n    deferred = deferred || createDeferred();\n    (typeof timeout === 'number') && clearTimeout(timeout);\n    timeout = window.setTimeout(() => {\n      timeout = null;\n      // fn.apply to save call context\n      deferred!.resolve(fn.apply(this, args));\n      deferred = null;\n    }, wait);\n  }\n  function cancel() {\n    (typeof timeout === 'number') && clearTimeout(timeout);\n    timeout = null;\n    deferred?.reject();\n    deferred = null;\n  }\n\n  Object.defineProperty(debouncedSubject, 'promise', {\n    get: () => deferred ? deferred.promise : Promise.resolve()\n  });\n  Object.defineProperty(debouncedSubject, 'cancel', {\n    writable: false,\n    enumerable: false,\n    value: cancel\n  });\n\n  return debouncedSubject as Debounced<F>;\n}\n","// Shim for modern browsers with ES6 class syntax support\n// Shim based on https://github.com/webcomponents/polyfills/blob/master/packages/custom-elements/ts_src/custom-elements.ts\nexport function shimES5ElementConstructor(BuiltInHTMLElement: typeof HTMLElement) {\n  if (\n    // No Reflect, no classes, no need for shim because native custom elements require ES2015 classes or Reflect.\n    window.Reflect === undefined || window.customElements === undefined ||\n    // The webcomponentsjs custom elements polyfill doesn't require ES2015-compatible construction (`super()` or `Reflect.construct`).\n    (window.customElements as any).polyfillWrapFlushCallback) {\n    return;\n  }\n\n  Object.defineProperty(window, BuiltInHTMLElement.name, {\n    value: function HTMLElement() {\n      return Reflect.construct(BuiltInHTMLElement, [], this.constructor);\n    }\n  });\n  const Element = (window as any)[BuiltInHTMLElement.name] as typeof HTMLElement;\n  Element.prototype = BuiltInHTMLElement.prototype;\n  Element.prototype.constructor = Element;\n  Object.setPrototypeOf(Element, BuiltInHTMLElement);\n}\n\nshimES5ElementConstructor(HTMLElement);\n","import {debounce} from '../../../src/modules/esl-utils/async/debounce';\n\nclass TestMediaSource extends HTMLElement {\n  get target() {\n    const targetSel = this.getAttribute('target');\n    return document.querySelector(targetSel || '');\n  }\n\n  private render() {\n    const form = document.createElement('form');\n    form.innerHTML = `\n      <fieldset>\n        <legend>Video Settings:</legend>\n          <div class=\"input-group mb-2 mr-sm-2\">\n          <select class=\"form-control\" name=\"media-type\">\n            <option value=\"auto\">- Auto -</option>\n            <option value=\"audio\">HTML Audio</option>\n            <option value=\"video\">HTML Video</option>\n            <option value=\"youtube\">Youtube</option>\n            <option value=\"brightcove\">Brightcove</option>\n            <option value=\"iframe\">Iframe</option>\n          </select>\n        </div>\n        <div class=\"input-group mb-2 mr-sm-2\">\n          <input type=\"text\" class=\"form-control\" placeholder=\"Media src\" name=\"media-src\" autocomplete=\"on\"/>\n        </div>\n        <div class=\"input-group mb-2 mr-sm-2\">\n          <input type=\"text\" class=\"form-control\" placeholder=\"Media id\" name=\"media-id\" autocomplete=\"on\"/>\n        </div>\n        <div class=\"input-group mb-2 mr-sm-2\">\n          <input type=\"text\" class=\"form-control\" placeholder=\"Player id\" name=\"player-id\" autocomplete=\"on\"/>\n        </div>\n        <div class=\"input-group mb-2 mr-sm-2\">\n          <input type=\"text\" class=\"form-control\" placeholder=\"Player account\" name=\"player-account\" autocomplete=\"on\"/>\n        </div>\n\n        <div class=\"form-group\">\n          <div class=\"form-check form-check-inline\">\n            <label class=\"form-check-label\"><input type=\"checkbox\" name=\"muted\" class=\"form-check-input\"/> Muted</label>\n          </div>\n          <div class=\"form-check form-check-inline\">\n            <label class=\"form-check-label\"><input type=\"checkbox\" name=\"autoplay\" class=\"form-check-input\"/> Autoplay</label>\n          </div>\n          <div class=\"form-check form-check-inline\">\n            <label class=\"form-check-label\"><input type=\"checkbox\" name=\"disabled\" class=\"form-check-input\"/> Disabled</label>\n          </div>\n        </div>\n      </fieldset>\n    `;\n    form.action = 'javascript: void 0;';\n    this.innerHTML = '';\n    this.appendChild(form);\n  }\n\n  private onChange() {\n    const target = this.target;\n    const inputs = this.querySelectorAll('input[name], select[name]');\n    Array.from(inputs).forEach((input: HTMLInputElement | HTMLSelectElement) => {\n      if (!target) return;\n      if (input instanceof HTMLInputElement && input.type === 'checkbox') {\n        target.toggleAttribute(input.name, input.checked);\n      } else {\n        target.setAttribute(input.name, input.value);\n      }\n    });\n  }\n\n  protected connectedCallback() {\n    this.render();\n    this.addEventListener('change', debounce(() => this.onChange(), 750));\n    this.onChange();\n  }\n}\n\ncustomElements.define('test-media-source', TestMediaSource);\n","const NS_NAME = 'ESL';\n\n/**\n * Nested declaration helper\n */\nfunction define(root: any, name: string, value: any) {\n  return name.split('.').reduce((obj: any, key, index, parts) => {\n    if (parts.length === index + 1) {\n      return (obj[key] = obj[key] || value);\n    }\n    const type = typeof obj[key];\n    if (type !== 'undefined' && type !== 'object' && type !== 'function') {\n      throw new Error(`Can not define ${value} on ${name}`);\n    }\n    return (obj[key] = obj[key] || {});\n  }, root);\n}\n\n/**\n * Method to manually declare key in library namespace\n * See {@link ExportNs} decorator for details\n */\nexport const exportNs = (name: string, module: any) => {\n  if (!(NS_NAME in window)) return;\n  define((window as any)[NS_NAME], name, module);\n};\n\n/**\n * Decorator to declare function or class in a global ns\n * @param name - key path to declare in ESL global ns\n * NOTE: path parts should be separated by dots\n * @example\n * ```ts\n * @Export('Package.Component')\n * ```\n * NOTE: in case declaration contains components-packages, their origins will be mixed with declaration in a Runtime\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function ExportNs<T extends Function>(name?: string) {\n  return (module: T) => exportNs(name || module.name, module);\n}\n\n/** Declare ESL global */\nExportNs.declare = () => {\n  if ('ESL' in window) return;\n  Object.defineProperty(window, 'ESL', {value: {}});\n};\n","const BINDINGS_STORE_KEY = '__fnBindings__';\n/** Decorator \"bind\" allows to bind prototype method context to class instance */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function bind<T extends Function>(target: object,\n                                         propertyKey: string,\n                                         descriptor: TypedPropertyDescriptor<T>): TypedPropertyDescriptor<T> {\n  // Validation check\n  if (!descriptor || (typeof descriptor.value !== 'function')) {\n    throw new TypeError('Only class methods can be decorated via @bind');\n  }\n  // Original function\n  const fn = descriptor.value;\n\n  return {\n    enumerable: descriptor.enumerable,\n    configurable: descriptor.configurable,\n\n    get() {\n      // Accessing via prototype returns original function\n      // If the constructor property is in the context then it's not an instance\n      if (!this || this === target || Object.hasOwnProperty.call(this, 'constructor')) {\n        return fn;\n      }\n\n      // Bounded functions store\n      let bindings = this[BINDINGS_STORE_KEY];\n      if (!bindings) {\n        bindings = this[BINDINGS_STORE_KEY] = new WeakMap<T, T>();\n      }\n\n      // Store binding if it does not exist\n      if (!bindings.has(fn)) {\n        bindings.set(fn, fn.bind(this));\n      }\n\n      // Return binding\n      return bindings.get(fn);\n    },\n    set(value: T) {\n      Object.defineProperty(this, propertyKey, {\n        writable: true,\n        enumerable: false,\n        configurable: true,\n        value\n      });\n    }\n  };\n}\n","import {ExportNs} from './esl-utils/environment/export-ns';\n\ndeclare global {\n  const ESL: ESLLibrary;\n  export interface Window {\n    ESl: ESLLibrary;\n  }\n}\n\nExportNs.declare();\n","type Tuple<T> = [T?, T?];\n\n/** Split array into tuples */\nexport const tuple = <T>(arr: T[]): Tuple<T>[] => arr.reduce((acc: Tuple<T>[], el) => {\n  if (acc.length === 0 || acc[acc.length - 1].length >= 2) acc.push([]);\n  acc[acc.length - 1].push(el);\n  return acc;\n}, []);\n\n/** Flat array */\nexport const flat = <T>(arr: (null | T | T[])[]): T[] =>\n  arr.reduce((acc: T[], el) => el ? acc.concat(el) : acc, []) as T[];\n\n/** Wrap to array */\nexport const wrap = <T>(arr: undefined | null | T | T[]): T[] => {\n  if (arr === undefined || arr === null) return [];\n  if (Array.isArray(arr)) return arr;\n  return [arr];\n};\n\n/** Make array values unique */\nexport const uniq = <T> (arr: T[]): T[] => {\n  const result: T[] = [];\n  const set = new Set<T>();\n  arr.forEach((item) => set.add(item));\n  set.forEach((item) => result.push(item));\n  return result;\n};\n","import {wrap} from '../misc/array';\n\n/** Describe locker elements collection per class name */\ntype Locks = Map<string, Set<HTMLElement>>;\n/** Store locks for key element classes*/\nconst lockStore = new WeakMap<HTMLElement, Locks>();\n\n/** Mange className lock for the element */\nconst lock = (el: HTMLElement, className: string, locker: HTMLElement) => {\n  const elLocks: Locks = lockStore.get(el) || new Map();\n  const classLocks: Set<HTMLElement> = elLocks.get(className) || new Set();\n  classLocks.add(locker);\n  elLocks.set(className, classLocks);\n  lockStore.set(el, elLocks);\n};\n/**\n * Manage className unlock for the element\n * @returns true if className have no lockes\n */\nconst unlock = (el: HTMLElement, className: string, locker: HTMLElement) => {\n  const elLocks = lockStore.get(el);\n  if (!elLocks) return true;\n  const classLocks = elLocks.get(className);\n  if (!classLocks) return true;\n  classLocks.delete(locker);\n  return !classLocks.size;\n};\n\n/**\n * Add single class to the element.\n * Supports inversion and locker management.\n */\nconst add = (el: HTMLElement, className: string, locker?: HTMLElement): void => {\n  if (className[0] === '!') return CSSClassUtils.remove(el, className.substr(1), locker);\n  if (locker) lock(el, className, locker);\n  el.classList.add(className);\n};\n\n/**\n * Remove single class from the element.\n * Supports inversion and locker management.\n */\nconst remove = (el: HTMLElement, className: string, locker?: HTMLElement): void => {\n  if (className[0] === '!') return CSSClassUtils.add(el, className.substr(1), locker);\n  if (locker && !unlock(el, className, locker)) return;\n  if (!locker) CSSClassUtils.unlock(el, className);\n  el.classList.remove(className);\n};\n\n/**\n * CSS class manipulation utilities.\n *\n * Allows to manipulate with CSS classes with the following set of sub-features:\n * - JQuery-like enumeration - you can pass multiple tokens separated by space\n * - safe checks - empty or falsy token sting will be ignored without throwing an error\n * - inversion syntax - tokens that start from '!' will be processed with inverted action\n * (e.g. addCls(el, '!class') - will remove 'class' from the element, while removeCls(el, '!class') adds 'class' to the element)\n * - class locks - you can manipulate with classes using `locker` option that takes into account the modification initiator.\n * That means the class added in 'locker' mode will not be removed until all initiators that requested add class have requested its removal.\n * */\nexport abstract class CSSClassUtils {\n  /** Splitting passed token string into CSS class names array. */\n  public static splitTokens(tokenString: string | null | undefined): string[] {\n    return (tokenString || '').split(' ').filter((str) => !!str);\n  }\n\n  /**\n   * Add all classes from the class token string to the element.\n   * @see CSSClassUtils\n   * */\n  public static add(els: HTMLElement | HTMLElement[], cls: string | null | undefined, locker?: HTMLElement) {\n    const tokens = CSSClassUtils.splitTokens(cls);\n    wrap(els).forEach((el) => tokens.forEach((className) => add(el, className, locker)));\n  }\n\n  /**\n   * Remove all classes from the class token string to the element.\n   * @see CSSClassUtils\n   * */\n  public static remove(els: HTMLElement | HTMLElement[], cls: string | null | undefined, locker?: HTMLElement) {\n    const tokens = CSSClassUtils.splitTokens(cls);\n    wrap(els).forEach((el) => tokens.forEach((className) => remove(el, className, locker)));\n  }\n\n  /**\n   * Toggle all classes from the class token string on the element to the passed state.\n   * @see CSSClassUtils\n   * */\n  public static toggle(els: HTMLElement | HTMLElement[], cls: string | null | undefined, state: boolean, locker?: HTMLElement) {\n    (state ? CSSClassUtils.add : CSSClassUtils.remove)(els, cls, locker);\n  }\n\n  /** Remove all lockers for the element or passed element className */\n  public static unlock(els: HTMLElement | HTMLElement[], className?: string) {\n    if (className) {\n      wrap(els).forEach((el) => lockStore.get(el)?.delete(className));\n    } else {\n      wrap(els).forEach((el) => lockStore.delete(el));\n    }\n  }\n}\n","export const isObject = (obj: any): obj is Record<string, any> => obj && typeof obj === 'object';\nexport const isObjectLike = (obj: any) => isObject(obj) || typeof obj === 'function';\nexport const isPrimitive = (obj: any): obj is string | number | boolean =>\n  typeof obj === 'string' || typeof obj === 'number' || typeof obj === 'boolean';\n\nexport const isPrototype = (obj: any) => Object.hasOwnProperty.call(obj, 'constructor');\n\nexport type CopyPredicate = (key: string, value: any) => boolean;\n\n/** Deep object compare */\nexport function deepCompare(obj1: any, obj2: any): boolean {\n  if (Object.is(obj1, obj2)) return true;\n  if (typeof obj1 !== typeof obj2) return false;\n  if (isObject(obj1) && isObject(obj2)) {\n    const keys1 = Object.keys(obj1);\n    const keys2 = Object.keys(obj2);\n    if (keys1.length !== keys2.length) return false;\n    return !keys1.some((key) => !deepCompare(obj1[key], obj2[key]));\n  }\n  return false;\n}\n\n/** Find the closest property descriptor */\nexport function getPropertyDescriptor(o: any, prop: PropertyKey) {\n  let proto = o;\n  while (proto) {\n    const desc = Object.getOwnPropertyDescriptor(proto, prop);\n    if (desc) return desc;\n    proto = Object.getPrototypeOf(proto);\n  }\n}\n\n/** @returns first defined param */\nexport function defined<T>(...params: T[]) {\n  for (const param of params) {\n    if (param !== undefined) return param;\n  }\n}\n\n/** Makes a plain copy of obj with properties satisfying the predicate\n * If no predicate provided copies all own properties */\nexport function copy<T>(obj: T, predicate: CopyPredicate = () => true): Partial<T> {\n  const result: any = Object.assign({}, obj || {});\n  Object.keys(result).forEach((key) => {\n    (!predicate(key, result[key])) && delete result[key];\n  });\n  return result;\n}\n\n/** Makes a flat copy without undefined keys */\nexport function copyDefinedKeys<T>(obj?: T): Partial<T> {\n  return copy(obj || {}, (key, value) => value !== void 0);\n}\n\n/** Omit copying provided properties from object */\nexport function omit<T>(obj: T, keys: string[]) {\n  return copy(obj, key => !keys.includes(key));\n}\n\n/**\n * Set object property using \"path\" key\n *\n * @param target - object\n * @param path - key path, use '.' as delimiter\n * @param value - value of property\n */\nexport const set = (target: any, path: string, value: any) => {\n  const parts = (path || '').split('.');\n  const depth = parts.length - 1;\n  parts.reduce((cur: any, key: string, index: number) => {\n    if (index === depth) return cur[key] = value;\n    return cur[key] = isObjectLike(cur[key]) ? cur[key] : {};\n  }, target);\n};\n\n/**\n * Gets object property using \"path\" key\n * Creates empty object if sub-key value is not presented.\n *\n * @param data - object\n * @param path - key path, use '.' as delimiter\n * @param defaultValue - default\n */\nexport const get = (data: any, path: string, defaultValue?: any): any => {\n  const parts = (path || '').split('.');\n  const result = parts.reduce((curr: any, key: string) => {\n    if (isObjectLike(curr)) return curr[key];\n    return undefined;\n  }, data);\n  return typeof result === 'undefined' ? defaultValue : result;\n};\n\n/**\n * Performs a deep copy of object.\n * @returns deep copy of the object\n */\nexport function deepMerge<T>(obj: T): T;\n/**\n * Performs a deep merge of two objects. Does not modify objects (immutable)\n * @returns new object with merged key/values\n */\nexport function deepMerge<T, U>(obj1: T, obj2: U): T & U;\n/**\n * Performs a deep merge of three objects. Does not modify objects (immutable)\n * @returns new object with merged key/values\n */\nexport function deepMerge<T, U, V>(obj1: T, obj2: U, obj3: V): T & U & V;\n/**\n * Performs a deep merge of four objects. Does not modify objects (immutable)\n * @returns new object with merged key/values\n */\nexport function deepMerge<T, U, V, W>(obj1: T, obj2: U, obj3: V, obj4: W): T & U & V & W;\n/**\n * Performs a deep merge of objects and returns new object. Does not modify objects (immutable)\n * @returns new object with merged key/values\n */\nexport function deepMerge(...objects: any[]): any;\nexport function deepMerge(...objects: any[]): any {\n  return objects.reduce((res: any, obj: any, index: number) => {\n    if (index === 0 && Array.isArray(obj)) res = [];\n\n    isObject(obj) && Object.keys(obj).forEach((key) => {\n      const resultVal = res[key];\n      const objectVal = obj[key];\n\n      let mergeResult = objectVal;\n      if (isObject(objectVal)) {\n        if (typeof resultVal === 'undefined') mergeResult = deepMerge(objectVal);\n        else if (isObject(resultVal)) mergeResult = deepMerge(resultVal, objectVal);\n      }\n      res[key] = mergeResult;\n    });\n\n    return res;\n  }, {});\n}\n","import {get} from './object';\n\n/** Convert string to kebab-case notation */\nexport const toKebabCase = (str: string) => {\n  return str.replace(/([a-z])([A-Z])/g, '$1-$2').replace(/[\\s_]+/g, '-').toLowerCase();\n};\n\n/** Convert string to camelCase notation */\nexport const toCamelCase = (str: string) => {\n  return str.trim().replace(/[\\s-,_]+([a-zA-Z0-9]?)/g, (match: string, word: string) => word.toUpperCase());\n};\n\n/** Unwrap string from parenthesis */\nexport const unwrapParenthesis = (str: string) => {\n  return str.trim().replace(/^\\((.*)\\)$/, '$1').trim();\n};\n\n/**\n * Parse number with the ability to pass an alternative fallback for NaN.\n * Note: falsy values except 0 are treated as NaN\n */\nexport const parseNumber = (str: string | number, nanValue?: number | undefined) => {\n  if (str === 0) return 0;\n  const value = +(str || NaN);\n  return isNaN(value) ? nanValue : value;\n};\n\n/**\n * Common function that returns coefficient aspect ratio\n * Supported formats: w:h, w/h, coefficient\n * @example\n * `16:9`, `16/9`, `1.77`\n * @param str - string to parse\n * @returns aspect ratio coefficient\n */\nexport function parseAspectRatio(str: string): number {\n  const [w, h] = str.split(/[:/]/);\n  if (typeof h !== 'undefined') return +w / +h;\n  return +w || 0;\n}\n\n/** Evaluate passed string or returns `defaultValue` */\nexport function evaluate(str: string, defaultValue?: any): any {\n  try {\n    // eslint-disable-next-line @typescript-eslint/no-implied-eval\n    return str ? (new Function(`return ${str}`))() : defaultValue;\n  } catch (e) {\n    console.warn('Cannot parse value ', str, e);\n    return defaultValue;\n  }\n}\n\n\n/** Default RegExp to match replacements in the string for the {@link format} function */\nexport const DEF_FORMAT_MATCHER = /{[{%]?([\\w.]+)[%}]?}/g;\n\n/** Replace `{key}` patterns in the string from the source object */\nexport function format(str: string, source: Record<string, any>, matcher: RegExp = DEF_FORMAT_MATCHER) {\n  return str.replace(matcher, (match, key) => {\n    const val = get(source, key);\n    return val === undefined ? match : val;\n  });\n}\n","import {toKebabCase} from '../../esl-utils/misc/format';\nimport type {ESLBaseElement} from '../core/esl-base-element';\n\n/** HTML attribute mapping configuration */\ntype AttrDescriptor = {\n  /** HTML attribute name. Uses kebab-cased variable name by default */\n  name?: string;\n  /** Create getter only */\n  readonly?: boolean;\n  /** Use data-* attribute */\n  dataAttr?: boolean;\n  /** Default property value. Used if no attribute is present on the element. Empty string by default. */\n  defaultValue?: string | boolean | null;\n};\n\nfunction buildSimpleDescriptor(attrName: string, readOnly: boolean, defaultValue: string | boolean | null | undefined) {\n  function get() {\n    const value = this.getAttribute(attrName);\n    return typeof value === 'string' ? value : defaultValue;\n  }\n\n  function set(value: string | boolean | null | undefined) {\n    if (value === undefined || value === null || value === false) {\n      this.removeAttribute(attrName);\n    } else {\n      this.setAttribute(attrName, value === true ? '' : value);\n    }\n  }\n\n  return readOnly ? {get} : {get, set};\n}\n\nconst buildAttrName =\n  (propName: string, dataAttr: boolean) => dataAttr ? `data-${toKebabCase(propName)}` : toKebabCase(propName);\n\n/**\n * Decorator to map current property to element attribute value.\n * Maps string type property.\n * @param config - mapping configuration. See {@link AttrDescriptor}\n */\nexport const attr = (config: AttrDescriptor = {}) => {\n  config = Object.assign({defaultValue: ''}, config);\n  return (target: ESLBaseElement, propName: string) => {\n    const attrName = buildAttrName(config.name || propName, !!config.dataAttr);\n    Object.defineProperty(target, propName, buildSimpleDescriptor(attrName, !!config.readonly, config.defaultValue));\n  };\n};\n","import {toKebabCase} from '../../esl-utils/misc/format';\nimport type {ESLBaseElement} from '../core/esl-base-element';\n\n/** HTML boolean (marker) attribute mapping configuration */\ntype BoolAttrDescriptor = {\n  /** HTML attribute name. Uses kebab-cased variable name by default */\n  name?: string;\n  /** Create getter only */\n  readonly?: boolean;\n  /** Use data-* attribute */\n  dataAttr?: boolean;\n};\n\nfunction buildConditionalDescriptor(attrName: string, readOnly: boolean) {\n  function get() {\n    return this.hasAttribute(attrName);\n  }\n\n  function set(value: boolean) {\n    this.toggleAttribute(attrName, value);\n  }\n\n  return readOnly ? {get} : {get, set};\n}\n\nconst buildAttrName =\n  (propName: string, dataAttr: boolean) => dataAttr ? `data-${toKebabCase(propName)}` : toKebabCase(propName);\n\n/**\n * Decorator to map current property to element boolean (marker) attribute state.\n * Maps boolean type property.\n * @param config - mapping configuration. See {@link BoolAttrDescriptor}\n */\nexport const boolAttr = (config: BoolAttrDescriptor = {}) => {\n  return (target: ESLBaseElement, propName: string) => {\n    const attrName = buildAttrName(config.name || propName, !!config.dataAttr);\n    Object.defineProperty(target, propName, buildConditionalDescriptor(attrName, !!config.readonly));\n  };\n};\n","export interface Point {\n  x: number;\n  y: number;\n}\n\nexport abstract class EventUtils {\n  /**\n   * Dispatch custom event.\n   * Event bubbles and is cancelable by default, use `eventInit` to override that.\n   * @param el - element target\n   * @param eventName - event name\n   * @param eventInit - custom event init. See {@link CustomEventInit}\n   */\n  public static dispatch(el: HTMLElement, eventName: string, eventInit?: CustomEventInit) {\n    const init = Object.assign({\n      bubbles: true,\n      composed: true,\n      cancelable: true\n    }, eventInit || {});\n    return el.dispatchEvent(new CustomEvent(eventName, init));\n  }\n\n  /** Get original CustomEvent source */\n  public static source(e: CustomEvent) {\n    const targets = (e.composedPath && e.composedPath());\n    return targets ? targets[0] : e.target;\n  }\n\n  /** Normalize TouchEvent or PointerEvent */\n  public static normalizeTouchPoint(event: TouchEvent | PointerEvent): Point {\n    const source = (event instanceof TouchEvent) ? event.changedTouches[0] : event;\n    return {\n      x: source.pageX,\n      y: source.pageY\n    };\n  }\n\n  /** Normalize MouseEvent */\n  public static normalizeCoordinates(event: MouseEvent, elem: HTMLElement): Point {\n    const props = elem.getBoundingClientRect();\n    const top = props.top + window.pageYOffset;\n    const left = props.left + window.pageXOffset;\n    return {\n      x: event.pageX - left,\n      y: event.pageY - top\n    };\n  }\n\n  /** Stub method to prevent event from bubbling out of target */\n  public static stopPropagation(e?: Event) {\n    e?.stopPropagation();\n  }\n\n  /** Stub method to prevent default event behaviour */\n  public static preventDefault(e?: Event) {\n    e?.preventDefault();\n  }\n}\n","import {EventUtils} from '../../esl-utils/dom/events';\n\n/**\n * Base class for ESL custom elements.\n * Allows to define custom element with the optional custom tag name.\n */\nexport abstract class ESLBaseElement extends HTMLElement {\n  /** Custom element tag name */\n  public static is = '';\n\n  protected _connected: boolean = false;\n\n  protected connectedCallback() {\n    this._connected = true;\n    this.classList.add((this.constructor as typeof ESLBaseElement).is);\n  }\n  protected disconnectedCallback() {\n    this._connected = false;\n  }\n\n  /** Check that the element is connected and `connectedCallback` has been executed */\n  public get connected() {\n    return this._connected;\n  }\n\n  /**\n   * Dispatch component custom event.\n   * Uses 'esl:' prefix for event name, overridable to customize event namespaces.\n   * @param eventName - event name\n   * @param eventInit - custom event init. See {@link CustomEventInit}\n   */\n  public $$fire(eventName: string, eventInit?: CustomEventInit): boolean {\n    return EventUtils.dispatch(this, 'esl:' + eventName, eventInit);\n  }\n\n  /**\n   * Register component in the {@link customElements} registry\n   * @param tagName - custom tag name to register custom element\n   */\n  public static register(this: typeof ESLBaseElement, tagName?: string) {\n    tagName = tagName || this.is;\n    if (!tagName) throw new Error('Can not define custom element');\n    const constructor: any = customElements.get(tagName);\n    if (constructor) {\n      if (constructor.is !== tagName) throw new Error('Element declaration tag inconsistency');\n      return;\n    }\n    if (this.is !== tagName) {\n      this.is = tagName;\n    }\n    customElements.define(tagName, this as any as CustomElementConstructor);\n  }\n\n  public static get registered() {\n    return customElements.whenDefined(this.is);\n  }\n}\n","import type {AnyToVoidFnSignature} from '../misc/functions';\n\n/**\n * Abstract Observable implementation\n * @author Yuliya Adamskaya\n */\nexport abstract class Observable <Callback extends AnyToVoidFnSignature = AnyToVoidFnSignature> {\n  protected _listeners = new Set<Callback>();\n\n  public addListener(listener: Callback) {\n    this._listeners.add(listener);\n  }\n  public removeListener(listener: Callback) {\n    this._listeners.delete(listener);\n  }\n\n  protected fire(...args: Parameters<Callback>) {\n    this._listeners.forEach((listener) => {\n      try {\n        listener.apply(this, args);\n      } catch (e) {\n        console.error(e);\n      }\n    });\n  }\n}\n","import type {AnyToAnyFnSignature} from './functions';\n\n/** Memoized function type */\nexport type MemoizedFn<T extends AnyToAnyFnSignature> = T & {\n  /** Cache instance */\n  cache: Map<null | string, ReturnType<T>>;\n  /** Clear memoization cache */\n  clear: () => void;\n  /** Check existence of cache for passed params */\n  has: (...params: Parameters<T>) => boolean;\n};\n\n/**\n * Memoization decorator function. Caches the original function result according to hash generated from arguments.\n * In case the hash function returns `undefined` value will not be memoized.\n * @see MemoHashFn Hash function signature.\n */\nexport function memoizeFn<F extends AnyToAnyFnSignature>(fn: F, hashFn: MemoHashFn<F> = defaultArgsHashFn): MemoizedFn<F> {\n  function memo(...args: Parameters<F>): any {\n    const key = hashFn(...args);\n    if (key !== null && typeof key !== 'string') {\n      console.warn(`Can't cache value for ${fn.name} call.`);\n      return fn.apply(this, args);\n    }\n    if (!memo.cache.has(key)) {\n      memo.cache.set(key, fn.apply(this, args));\n    }\n    return memo.cache.get(key);\n  }\n\n  memo.cache = new Map<null | string, ReturnType<F>>();\n  memo.clear = () => memo.cache.clear();\n  memo.has = (...args: Parameters<F>) => {\n    const key = hashFn(...args);\n    return key === undefined ? false : memo.cache.has(key);\n  };\n  return memo as MemoizedFn<F>;\n}\n\n/**\n * Describe abstract memoization hash function. Memoization should have the same or compatible signature as the decorated function.\n * Hash function can return string or null as a hash result. Note: null is correct hash for arguments!\n * If the result is `undefined` - it means that the hash can not be generated.\n */\nexport type MemoHashFn<F extends AnyToAnyFnSignature = AnyToAnyFnSignature> = (...args: Parameters<F>) => undefined | null | string;\n\n/**\n * Default arguments hash function.\n * Supports only 0-1 arguments with a primitive type.\n */\nexport function defaultArgsHashFn(...args: any[]) {\n  if (args.length === 0) return null;\n  if (args.length > 1) return;\n  if (typeof args[0] !== 'string' && typeof args[0] !== 'number' && typeof args[0] !== 'boolean') return;\n  return String(args[0]);\n}\n","import {defaultArgsHashFn, memoizeFn} from '../misc/memoize';\nimport {isPrototype, getPropertyDescriptor} from '../misc/object';\n\nimport type {MemoHashFn} from '../misc/memoize';\nimport type {MethodTypedDecorator} from '../misc/functions';\n\nexport function memoize(): MethodDecorator;\nexport function memoize<H extends MemoHashFn>(hashFn: H): MethodTypedDecorator<(...args: Parameters<H>) => any>;\n/**\n * Memoization decorator helper.\n * @see memoizeFn Original memoizeFn function decorator.\n */\nexport function memoize(hashFn: MemoHashFn = defaultArgsHashFn) {\n  return function (target: any, prop: string, descriptor: TypedPropertyDescriptor<any>) {\n    if (!descriptor || typeof (descriptor.value || descriptor.get) !== 'function') {\n      throw new TypeError('Only get accessors or class methods can be decorated via @memoize');\n    }\n\n    if (isPrototype(target)) {\n      // Object members\n      (typeof descriptor.get === 'function') && (descriptor.get = memoizeGetter(descriptor.get, prop));\n      (typeof descriptor.value === 'function') && (descriptor.value = memoizeMethod(descriptor.value, prop, hashFn));\n    } else {\n      // Static members\n      (typeof descriptor.get === 'function') && (descriptor.get = memoizeFn(descriptor.get));\n      (typeof descriptor.value === 'function') && (descriptor.value = memoizeFn(descriptor.value, hashFn));\n    }\n  };\n}\n\n// Lock storage to prevent cache logic for some key\nconst locks = new WeakMap();\nconst defineOwnKeySafe = (obj: any, prop: string, value: any) => {\n  locks.set(obj, prop); // IE try to get key with the prototype instance call, so we lock it\n  Object.defineProperty(obj, prop, {value, writable: true, configurable: true});\n  locks.delete(obj); // Free property key\n};\n\n/** Cache getter result as an object own property */\nfunction memoizeGetter(originalMethod: any, prop: string) {\n  return function (this: any, ...args: any[]): any {\n    if (locks.get(this) === prop) return originalMethod;\n    const value = originalMethod.call(this);\n    defineOwnKeySafe(this, prop, value);\n    return value;\n  };\n}\n\n/** Cache method memo function in the current context on call */\nfunction memoizeMethod(originalMethod: any, prop: string, hashFn: MemoHashFn) {\n  return function (this: any, ...args: any[]): any {\n    if (locks.get(this) === prop) return originalMethod;\n    const memo = memoizeFn(originalMethod, hashFn);\n    defineOwnKeySafe(this, prop, memo);\n    return memo.apply(this, args);\n  };\n}\n\n/**\n * Clear memoization cache for passed target and property.\n * Accepts not own properties.\n * Note: be sure that you targeting memoized property or function.\n * Clear utility has no 100% check to prevent modifying incorrect (not memoized) property keys\n */\nmemoize.clear = function (target: any, property: string) {\n  const desc = getPropertyDescriptor(target, property);\n  if (!desc) return;\n  if (typeof desc.get === 'function' && typeof (desc.get as any).clear === 'function') return (desc.get as any).clear();\n  if (typeof desc.value === 'function' && typeof desc.value.clear === 'function') return desc.value.clear();\n  if (Object.hasOwnProperty.call(target, property)) delete target[property];\n};\n\n/** Check if property has cache for the passed params */\nmemoize.has = function (target: any, property: string, ...params: any[]) {\n  const desc = getPropertyDescriptor(target, property);\n  if (!desc) return false;\n  if (typeof desc.get === 'function' && typeof (desc.get as any).has === 'function') return (desc.get as any).has(...params);\n  if (typeof desc.value === 'function' && typeof desc.value.has === 'function') return desc.value.has(...params);\n  return Object.hasOwnProperty.call(target, property);\n};\n","import {ExportNs} from './export-ns';\n\nconst {userAgent, vendor, platform} = window.navigator;\n\n/**\n * Device detection utility\n * @readonly\n */\n@ExportNs('DeviceDetector')\nexport abstract class DeviceDetector {\n  // IE Detection\n  public static readonly isTrident = /trident/i.test(userAgent);\n  public static readonly isIE = DeviceDetector.isTrident;\n\n  // Edge Detection\n  public static readonly isEdgeHTML = /edg([ea]|ios)/i.test(userAgent);\n  public static readonly isBlinkEdge = /\\sedg\\//i.test(userAgent);\n  public static readonly isEdge = DeviceDetector.isEdgeHTML || DeviceDetector.isBlinkEdge;\n\n  // Gecko\n  public static readonly isGecko = /gecko/i.test(userAgent) && !/like gecko/i.test(userAgent);\n  public static readonly isFirefox = /firefox|iceweasel|fxios/i.test(userAgent);\n\n  // Opera / Chrome\n  public static readonly isOpera = /(?:^opera.+?version|opr)/.test(userAgent);\n  public static readonly isChrome = !DeviceDetector.isOpera && /google inc/.test(vendor);\n\n  // Webkit\n  public static readonly isWebkit = /(apple)?webkit/i.test(userAgent);\n\n  // Safari\n  public static readonly isSafari = DeviceDetector.isWebkit && /^((?!chrome|android).)*safari/i.test(userAgent);\n\n  // Blink\n  public static readonly isBlink = DeviceDetector.isWebkit && !DeviceDetector.isSafari;\n\n  // Bot detection\n  public static readonly isBot = /Chrome-Lighthouse|Google Page Speed Insights/i.test(userAgent);\n\n  // Mobile\n  public static readonly isAndroid = /Android/i.test(userAgent);\n  public static readonly isMobileIOS13 = /* iOS 13+ detection */ (platform === 'MacIntel' && window.navigator.maxTouchPoints > 1);\n  public static readonly isMobileIOS = /iPad|iPhone|iPod/.test(platform) || DeviceDetector.isMobileIOS13;\n  public static readonly isLegacyMobile = /webOS|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n\n  public static readonly isMobile = DeviceDetector.isMobileIOS || DeviceDetector.isAndroid || DeviceDetector.isLegacyMobile;\n  public static readonly isMobileSafari = DeviceDetector.isMobileIOS && DeviceDetector.isWebkit && /CriOS/i.test(userAgent);\n\n  // Touch Detection\n  public static get isTouchDevice() {\n    const navApi: any = window.navigator;\n    if (navApi.maxTouchPoints || navApi.msMaxTouchPoints) return true;\n    return ('ontouchstart' in window) || ('DocumentTouch' in window && document instanceof Touch);\n  }\n\n  // Hover check\n  // Note: always true for IE\n  public static get hasHover() {\n    return !matchMedia('(hover: none)').matches;\n  }\n\n  static get TOUCH_EVENTS() {\n    const isTouch = DeviceDetector.isTouchDevice;\n    return {\n      START: isTouch ? 'touchstart' : 'pointerdown',\n      MOVE: isTouch ? 'touchmove' : 'pointermove',\n      END: isTouch ? 'touchend' : 'pointerup'\n    };\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    DeviceDetector: typeof DeviceDetector;\n  }\n}\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {DeviceDetector} from '../../../esl-utils/environment/device-detector';\n\n/**\n * DPR preprocessor. Used to replace DPR shortcuts.\n * @author Alexey Stsefanovich (ala'n)\n *\n * @implements IMediaQueryPreprocessor statically\n */\n@ExportNs('ScreenDPR')\nexport class ESLScreenDPR {\n  protected static readonly VALUE_REGEXP = /(\\d(\\.\\d)?)x/;\n\n  /** Option to exclude dpr greater then 2 for bots */\n  public static ignoreBotsDpr = false;\n\n  public static toDPI(dpr: number) {\n    return (96 * dpr).toFixed(1);\n  }\n\n  public static process(match: string) {\n    if (!ESLScreenDPR.VALUE_REGEXP.test(match)) return;\n    const dpr = parseFloat(match);\n    if (dpr < 0 || isNaN(dpr)) return;\n    if (ESLScreenDPR.ignoreBotsDpr && DeviceDetector.isBot && dpr > 1) return 'not all';\n    if (DeviceDetector.isSafari) return `(-webkit-min-device-pixel-ratio: ${dpr})`;\n    return `(min-resolution: ${ESLScreenDPR.toDPI(dpr)}dpi)`;\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    ScreenDPR: typeof ESLScreenDPR;\n  }\n}\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\n\nconst registry = new Map<string, ESLScreenBreakpoint>();\n\n/**\n * ESL Screen Breakpoints registry\n * @author Yuliya Adamskaya, Alexey Stsefanovich (ala'n)\n *\n * Screen Breakpoint registry is used to provide custom breakpoints for {@link ESLMediaQuery}\n *\n * @implements IMediaQueryPreprocessor statically\n */\n@ExportNs('ScreenBreakpoints')\nexport abstract class ESLScreenBreakpoints {\n  protected static readonly BP_REGEXP = /^([+-]?)([a-z]+)/i;\n  protected static readonly BP_NAME_REGEXP = /^[a-z]+/i;\n\n  /**\n   * Add or replace breakpoint shortcut that can be used inside ESLMediaQuery\n   * @param name - name of shortcut\n   * @param minWidth - min width for breakpoint\n   * @param maxWidth - max width for breakpoint\n   */\n  public static add(name: string, minWidth: number, maxWidth: number): ESLScreenBreakpoint | undefined {\n    name = name.toLowerCase();\n    if (ESLScreenBreakpoints.BP_NAME_REGEXP.test(name)) {\n      const current = registry.get(name);\n      registry.set(name, new ESLScreenBreakpoint(name, minWidth, maxWidth));\n      return current;\n    }\n    throw new Error('The shortcut should consist only of Latin characters and be at least one character long.');\n  }\n\n  /** Removes screen breakpoint */\n  public static remove(name: string): boolean {\n    return registry.delete(name.toLowerCase());\n  }\n\n  /** @returns known breakpoint shortcut instance */\n  public static get(name: string) {\n    return registry.get((name || '').toLowerCase());\n  }\n\n  /** All available breakpoints names */\n  public static get names() {\n    const keys: string[] = [];\n    registry.forEach((value, key) => keys.push(key));\n    return keys;\n  }\n\n  /** @returns breakpoints shortcut replacement */\n  public static process(term: string) {\n    const [, sign, bp] = term.match(ESLScreenBreakpoints.BP_REGEXP) || [];\n    const shortcut = ESLScreenBreakpoints.get(bp);\n    if (!shortcut) return;\n    if (sign === '+') return shortcut.mediaQueryGE;\n    if (sign === '-') return shortcut.mediaQueryLE;\n    return shortcut.mediaQuery;\n  }\n}\n\n/** ESL Screen Breakpoint description */\nexport class ESLScreenBreakpoint {\n  constructor(\n    public readonly name: string,\n    public readonly min: number,\n    public readonly max: number\n  ) {}\n\n  public get mediaQuery(): string {\n    return `(min-width: ${this.min}px) and (max-width: ${this.max}px)`;\n  }\n\n  public get mediaQueryGE(): string {\n    return `(min-width: ${this.min}px)`;\n  }\n\n  public get mediaQueryLE(): string {\n    return `(max-width: ${this.max}px)`;\n  }\n\n  public toString() {\n    return `[${this.name}]: ${this.min} to ${this.max}`;\n  }\n}\n\n// Defaults\nESLScreenBreakpoints.add('xs', 1, 767);\nESLScreenBreakpoints.add('sm', 768, 991);\nESLScreenBreakpoints.add('md', 992, 1199);\nESLScreenBreakpoints.add('lg', 1200, 1599);\nESLScreenBreakpoints.add('xl', 1600, 999999);\n\ndeclare global {\n  export interface ESLLibrary {\n    ScreenBreakpoints: typeof ESLScreenBreakpoints;\n  }\n}\n","import {DeviceDetector} from '../../../esl-utils/environment/device-detector';\nimport {ExportNs} from '../../../esl-utils/environment/export-ns';\n\nconst shortcuts = new Map<string, string | boolean>();\n\n/**\n * Static shortcuts preprocessor. Used to store device related shortcuts.\n * @author Alexey Stsefanovich (ala'n)\n *\n * @implements IMediaQueryPreprocessor statically\n */\n@ExportNs('EnvShortcuts')\nexport class ESLEnvShortcuts {\n  // For debug purposes\n  private static readonly _shortcuts = shortcuts;\n\n  /**\n   * Add mapping\n   * @param shortcut - term to find in query\n   * @param value - media query string or boolean result (that represents `all` or `not all` conditions)\n   */\n  public static add(shortcut: string, value: string | boolean) {\n    if (!['boolean', 'string'].includes(typeof value)) value = false;\n    return shortcuts.set(shortcut.toLowerCase(), value);\n  }\n\n  /** Remove mapping for passed shortcut term */\n  public static remove(shortcut: string) {\n    return shortcuts.delete(shortcut.toLowerCase());\n  }\n\n  /** Replaces shortcut to registered result */\n  public static process(match: string) {\n    if (shortcuts.has(match)) return shortcuts.get(match);\n  }\n}\n\n// Touch check\nESLEnvShortcuts.add('touch', DeviceDetector.isTouchDevice);\n\n// Basic device type shortcuts\nESLEnvShortcuts.add('bot', DeviceDetector.isBot);\nESLEnvShortcuts.add('mobile', DeviceDetector.isMobile);\nESLEnvShortcuts.add('desktop', !DeviceDetector.isMobile);\nESLEnvShortcuts.add('android', DeviceDetector.isAndroid);\nESLEnvShortcuts.add('ios', DeviceDetector.isMobileIOS);\n\n// Basic browser shortcuts\nESLEnvShortcuts.add('ie', DeviceDetector.isIE);\nESLEnvShortcuts.add('edge', DeviceDetector.isEdgeHTML);\nESLEnvShortcuts.add('gecko', DeviceDetector.isGecko);\nESLEnvShortcuts.add('blink', DeviceDetector.isBlink);\nESLEnvShortcuts.add('safari', DeviceDetector.isSafari);\nESLEnvShortcuts.add('safari-ios', DeviceDetector.isMobileSafari);\n\ndeclare global {\n  export interface ESLLibrary {\n    EnvShortcuts: typeof ESLEnvShortcuts;\n  }\n}\n","export interface IMediaQueryCondition {\n  /** @returns true if current environment satisfies query */\n  matches: boolean;\n  /** Attach listener to wrapped media query list */\n  addListener(cb: VoidFunction): void;\n  /** Detach listener from wrapped media query list */\n  removeListener(cb: VoidFunction): void;\n  /** Optimize condition with nested hierarchy */\n  optimize(): IMediaQueryCondition;\n  /** Stringify condition */\n  toString(): string;\n}\n\n/**\n * Const media condition implementation\n * @author Alexey Stsefanovich (ala'n)\n *\n * Ignores listeners always return the same result.\n * Have only two instances: {@link ALL} and {@link NOT_ALL}\n */\nclass MediaQueryConstCondition implements IMediaQueryCondition {\n  constructor(private readonly _matches: boolean) {}\n\n  public get matches() {\n    return this._matches;\n  }\n\n  public addListener(cb: VoidFunction) {}\n  public removeListener(cb: VoidFunction) {}\n\n  public optimize() {\n    return this;\n  }\n\n  public toString() {\n    return this._matches ? 'all' : 'not all';\n  }\n\n  /** Compare const media condition with the passed query instance or string */\n  public eq(val: IMediaQueryCondition | string): boolean {\n    return val.toString().trim() === this.toString();\n  }\n}\n\nexport const ALL = new MediaQueryConstCondition(true);\nexport const NOT_ALL = new MediaQueryConstCondition(false);\n","import {ALL, NOT_ALL} from './media-query-base';\nimport type {IMediaQueryCondition} from './media-query-base';\n\n/**\n * Simple media condition implementation\n * @author Alexey Stsefanovich (ala'n)\n *\n * Wraps matchMedia instance\n */\nexport class MediaQueryCondition implements IMediaQueryCondition {\n  protected readonly _inverted: boolean;\n  protected readonly _mq: MediaQueryList;\n\n  constructor(query: string, inverted = false) {\n    this._inverted = inverted;\n    this._mq = matchMedia(query.trim() || 'all');\n  }\n\n  public get matches() {\n    return this._inverted ? !this._mq.matches : this._mq.matches;\n  }\n\n  public addListener(listener: VoidFunction) {\n    if (typeof this._mq.addEventListener === 'function') {\n      this._mq.addEventListener('change', listener);\n    } else {\n      this._mq.addListener(listener);\n    }\n  }\n  public removeListener(listener: VoidFunction) {\n    if (typeof this._mq.removeEventListener === 'function') {\n      this._mq.removeEventListener('change', listener);\n    } else {\n      this._mq.removeListener(listener);\n    }\n  }\n\n  /** Optimize query. Can simplify query to {@link MediaQueryConstCondition} */\n  public optimize(): IMediaQueryCondition {\n    if (ALL.eq(this)) return this._inverted ? NOT_ALL : ALL;\n    if (NOT_ALL.eq(this)) return this._inverted ? ALL : NOT_ALL;\n    return this;\n  }\n\n  public toString() {\n    const query = this._mq.media;\n    const inverted = this._inverted;\n    const complex = inverted && /\\)[\\s\\w]+\\(/.test(query);\n    return (inverted ? 'not ' : '') + (complex ? `(${query})` : query);\n  }\n}\n","import {Observable} from '../../../esl-utils/abstract/observable';\nimport {ALL, NOT_ALL} from './media-query-base';\n\nimport type {IMediaQueryCondition} from './media-query-base';\n\n/**\n * Abstract multiple media conditions container\n * @author Alexey Stsefanovich (ala'n)\n *\n * Observe all child items. Dispatch changes when the whole condition result is changed\n */\nclass MediaQueryContainer extends Observable<(matches: boolean) => void> implements IMediaQueryCondition {\n  private _matches: boolean;\n\n  constructor(protected readonly items: IMediaQueryCondition[] = []) {\n    super();\n    this._matches = this.matches;\n    this._onChildChange = this._onChildChange.bind(this);\n  }\n\n  public addListener(listener: (matches: boolean) => void) {\n    super.addListener(listener);\n    if (this._listeners.size > 1) return;\n    this.items.forEach((item) => item.addListener(this._onChildChange));\n  }\n  public removeListener(listener: (matches: boolean) => void) {\n    super.removeListener(listener);\n    if (this._listeners.size) return;\n    this.items.forEach((item) => item.removeListener(this._onChildChange));\n  }\n\n  public get matches() {\n    return false;\n  }\n\n  /** Exclude const conditions. Unwrap empty or trivial (with one item) containers */\n  public optimize(): IMediaQueryCondition {\n    return this;\n  }\n\n  /** Handle query change and dispatch it on top level in case result value is changed */\n  protected _onChildChange() {\n    const {matches} = this;\n    if (this._matches ===  matches) return;\n    this.fire(this._matches = matches);\n  }\n}\n\n/** Conjunction (AND) group of media conditions */\nexport class MediaQueryConjunction extends MediaQueryContainer {\n  public get matches() {\n    return this.items.every((item) => item.matches);\n  }\n\n  public optimize(): IMediaQueryCondition {\n    const optimizedItems = this.items.map((item) => item.optimize());\n    if (optimizedItems.some((item) => NOT_ALL.eq(item))) return NOT_ALL;\n    const items = optimizedItems.filter((item) => !ALL.eq(item));\n    if (items.length === 0) return ALL;\n    if (items.length === 1) return items[0];\n    return new MediaQueryConjunction(items);\n  }\n\n  public toString() {\n    return this.items.join(' and ');\n  }\n}\n\n/** Disjunction (OR) group of media conditions */\nexport class MediaQueryDisjunction extends MediaQueryContainer {\n  public get matches() {\n    return this.items.some((item) => item.matches);\n  }\n\n  public optimize(): IMediaQueryCondition {\n    const optimizedItems = this.items.map((item) => item.optimize());\n    if (optimizedItems.some((item) => ALL.eq(item))) return ALL;\n    const items = optimizedItems.filter((item) => !NOT_ALL.eq(item));\n    if (items.length === 0) return NOT_ALL;\n    if (items.length === 1) return items[0];\n    return new MediaQueryDisjunction(items);\n  }\n\n  public toString(pretty = false) {\n    return this.items.join(pretty ? ' or ' : ', ');\n  }\n}\n","import {memoize} from '../../esl-utils/decorators/memoize';\nimport {ExportNs} from '../../esl-utils/environment/export-ns';\n\nimport {ESLScreenDPR} from './common/screen-dpr';\nimport {ESLScreenBreakpoints} from './common/screen-breakpoint';\nimport {ESLEnvShortcuts} from './common/env-shortcuts';\n\nimport {ALL, NOT_ALL} from './conditions/media-query-base';\nimport {MediaQueryCondition} from './conditions/media-query-condition';\nimport {MediaQueryConjunction, MediaQueryDisjunction} from './conditions/media-query-containers';\n\nimport type {IMediaQueryCondition} from './conditions/media-query-base';\n\nexport interface IMediaQueryPreprocessor {\n  process: (match: string) => string | boolean | undefined;\n}\n\n/**\n * ESL Media Query\n * Provides special media condition syntax - ESLMediaQuery\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya, Natallia Harshunova\n *\n * Utility to support extended MediaQuery features\n * Supports\n * - CSS MediaQuery matching check\n * - DPR display queries (`@x1|@x2|@x3`)\n * - Registered screen default sizes (breakpoints) shortcuts (`@[-|+](XS|SM|MD|LG|XL)`)\n * - Device and browser shortcuts (`@MOBILE|@DESKTOP|@IE`)\n * - Custom static shortcuts and custom query preprocessors\n * - `not` logic operation (can have multiple not operators before any term of the query)\n * - `or` or `,` logical operator (have a lowest priority)\n * - Query matching change listeners\n *\n * Building query process:\n *\n * [Building query logical tree] - [preprocess nodes queries] - [building native MediaQueryList nodes] - [query tree optimization]\n */\n@ExportNs('MediaQuery')\nexport abstract class ESLMediaQuery implements IMediaQueryCondition {\n  /** Always true condition */\n  public static readonly ALL: IMediaQueryCondition = ALL;\n  /** Always false condition */\n  public static readonly NOT_ALL: IMediaQueryCondition = NOT_ALL;\n\n  protected static readonly SHORTCUT_PATTERN = /@([a-z0-9.+-]+)/i;\n  protected static readonly _preprocessors: IMediaQueryPreprocessor[] = [];\n\n  /** Add {@link IMediaQueryPreprocessor} instance for query preprocessing step */\n  public static use(preprocessor: IMediaQueryPreprocessor): typeof ESLMediaQuery {\n    this._preprocessors.unshift(preprocessor);\n    return this;\n  }\n\n  /** Cached method to create {@link ESLMediaQuery} condition instance from query string */\n  @memoize()\n  public static for(query: string): IMediaQueryCondition {\n    return ESLMediaQuery.from(query);\n  }\n\n  /** Creates {@link ESLMediaQuery} condition instance from query string */\n  public static from(query: string): IMediaQueryCondition {\n    const conjunctions = query.split(/\\sor\\s|,/).map((term) => {\n      const conditions = term.split(/\\sand\\s/).map(ESLMediaQuery.parseSimpleQuery);\n      return new MediaQueryConjunction(conditions);\n    });\n    return new MediaQueryDisjunction(conjunctions).optimize();\n  }\n\n  /** Preprocess simple query term by applying replacers and shortcuts rules */\n  protected static preprocess(term: string) {\n    if (!this.SHORTCUT_PATTERN.test(term)) return term;\n    const shortcut = term.trim().substr(1).toLowerCase();\n    for (const replacer of this._preprocessors) {\n      const result = replacer.process(shortcut);\n      if (typeof result === 'string') return result;\n      if (typeof result === 'boolean') return result ? 'all' : 'not all';\n    }\n    return term;\n  }\n\n  /** Creates simple {@link ESLMediaQuery} condition */\n  protected static parseSimpleQuery(term: string): IMediaQueryCondition {\n    const query = term.replace(/^\\s*not\\s+/, '');\n    const queryInverted = query !== term;\n    const processedQuery = ESLMediaQuery.preprocess(query);\n    const sanitizedQuery = processedQuery.replace(/^\\s*not\\s+/, '');\n    const resultInverted = processedQuery !== sanitizedQuery;\n    const invert = queryInverted !== resultInverted;\n\n    if (ALL.eq(sanitizedQuery)) return invert ? NOT_ALL : ALL;\n    if (NOT_ALL.eq(sanitizedQuery)) return invert ? ALL : NOT_ALL;\n    return new MediaQueryCondition(sanitizedQuery, invert);\n  }\n\n  // Implements IESLMQCondition to allow use ESLMediaQuery as IESLMQCondition type alias\n  public abstract matches: boolean;\n  public abstract optimize(): IMediaQueryCondition;\n  public abstract addListener(cb: () => void): void;\n  public abstract removeListener(cb: () => void): void;\n  public abstract toString(): string;\n}\n\n// Register otb preprocessors\nESLMediaQuery.use(ESLScreenDPR);\nESLMediaQuery.use(ESLScreenBreakpoints);\nESLMediaQuery.use(ESLEnvShortcuts);\n\ndeclare global {\n  export interface ESLLibrary {\n    MediaQuery: typeof ESLMediaQuery;\n  }\n}\n","import {ESLMediaQuery} from './esl-media-query';\n\ntype PayloadParser<T> = (val: string) => T | undefined;\n\n/**\n * ESL Media Rule\n * @author Yuliya Adamskaya\n *\n * Helper class to wrap {@link ESLMediaQuery} with the payload value\n * @see ESLMediaQuery\n * @see ESLMediaRuleList\n */\nexport class ESLMediaRule<T> {\n  private readonly _query: ESLMediaQuery;\n  private readonly _payload: T;\n  private readonly _default: boolean;\n\n  constructor(payload: T, query: string = '') {\n    this._query = ESLMediaQuery.for(query);\n    this._default = !query;\n    this._payload = payload;\n  }\n\n  public toString() {\n    return `${this._query} => ${this._payload}`;\n  }\n\n  /** Subscribes on inner {@link ESLMediaQuery} changes */\n  public addListener(listener: () => void) {\n    this._query.addListener(listener);\n  }\n  /** Unsubscribes from inner {@link ESLMediaQuery} changes */\n  public removeListener(listener: () => void) {\n    this._query.removeListener(listener);\n  }\n\n  /** Check if the inner {@link ESLMediaQuery} is matching current device configuration */\n  public get matches(): boolean {\n    return this._query.matches;\n  }\n  /** @returns wrapped payload value */\n  public get payload(): T {\n    return this._payload;\n  }\n  /**\n   * Check if the rule was created with an empty query\n   * @see ESLMediaRuleList\n   */\n  public get default(): boolean {\n    return this._default;\n  }\n\n  /** Parse the rule string to the {@link ESLMediaRule} instance */\n  public static parse<U>(lex: string, parser: PayloadParser<U>) {\n    const parts = lex.split('=>');\n    const query = parts.length === 2 ? parts[0] : '';\n    const payload = parts.length === 2 ? parts[1] : parts[0];\n    const payloadValue = parser(payload.trim());\n    if (typeof payloadValue === 'undefined') return undefined;\n    return new ESLMediaRule<U>(payloadValue, query.trim());\n  }\n\n  /** Shortcut to create always active {@link ESLMediaRule} with passed value */\n  public static all<U>(payload: U) {\n    return new ESLMediaRule<U>(payload, 'all');\n  }\n  /** Shortcut to create condition-less {@link ESLMediaRule} */\n  public static default<U>(payload: U) {\n    return new ESLMediaRule<U>(payload);\n  }\n  /** Shortcut to create always inactive {@link ESLMediaRule} */\n  public static empty(): ESLMediaRule<undefined> {\n    return new ESLMediaRule(undefined, 'all');\n  }\n}\n","import {DeviceDetector} from '../../esl-utils/environment/device-detector';\nimport {ESLImage} from './esl-image';\n\nlet iObserver: IntersectionObserver;\n\n/** ESL Image lazy loading IntersectionObserver instance */\nexport function getIObserver() {\n  if (!iObserver) {\n    iObserver = new IntersectionObserver(function (entries) {\n      entries.forEach(handleViewport);\n    }, {\n      threshold: [0.01], // 0 + 1 are not correctly handled by all browsers\n      rootMargin: DeviceDetector.isMobile ? '250px' : '500px' // rootMargin value for IntersectionObserver\n    });\n  }\n  return iObserver;\n}\n\nfunction handleViewport(entry: IntersectionObserverEntry) {\n  const {target: image} = entry;\n  if (!(image instanceof ESLImage)) return;\n\n  // Check that entry is going to appear in the viewport area\n  if (entry.isIntersecting || entry.intersectionRatio > 0) {\n    image.triggerLoad();\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {Observable} from '../../esl-utils/abstract/observable';\nimport {evaluate} from '../../esl-utils/misc/format';\nimport {isPrimitive} from '../../esl-utils/misc/object';\nimport {ESLMediaRule} from './esl-media-rule';\n\nexport type RulePayloadParser<T> = (val: string) => T | undefined;\nexport type RuleChangedCallback<T> = (rule: ESLMediaRule<T | undefined>, list: ESLMediaRuleList<T>) => void;\n\n/**\n * ESLMediaRuleList - {@link ESLMediaRule} observable collection\n * @author Yuliya Adamskaya\n *\n * Represents observable object that wraps environment to value mapping\n */\n@ExportNs('MediaRuleList')\nexport class ESLMediaRuleList<T = any> extends Observable<RuleChangedCallback<T>> {\n  /**\n   * String value parser (used as a default)\n   * @returns value string as it is\n   */\n  public static STRING_PARSER: RulePayloadParser<string> = (val: string): string => val;\n  /**\n   * Object value parser. Uses {@link evaluate} to parse value\n   * @returns value - parsed JS Object\n   */\n  public static OBJECT_PARSER = <U>(val: string): U | undefined => evaluate(val);\n\n  /**\n   * Creates `ESLMediaRuleList` from string query representation\n   * Uses exact strings as rule list values\n   * @param query - query string\n   */\n  public static parse(query: string): ESLMediaRuleList<string>;\n  /**\n   * Creates `ESLMediaRuleList` from string query representation\n   * @param query - query string\n   * @param parser - value parser function. See built in {@link ESLMediaRuleList.OBJECT_PARSER} or {@link ESLMediaRuleList.STRING_PARSER} (default)\n   */\n  public static parse<U>(query: string, parser: RulePayloadParser<U>): ESLMediaRuleList<U>;\n  public static parse(query: string, parser: RulePayloadParser<any> = ESLMediaRuleList.STRING_PARSER): ESLMediaRuleList {\n    const rules: ESLMediaRule<any>[] = [];\n    query.split('|').forEach((part: string) => {\n      const lex = part.trim();\n      const rule = ESLMediaRule.parse(lex, parser);\n      if (!rule) return;\n      rule.default ? rules.unshift(rule) : rules.push(rule);\n    });\n    return new ESLMediaRuleList(rules);\n  }\n\n  /**\n   * Creates `ESLMediaRuleList` from two strings with a value  and conditions tuple\n   *\n   * @param values - values tuple string (uses '|' as separator)\n   * @param mask - media conditions tuple string (uses '|' as separator)\n   *\n   * @example\n   * ```ts\n   * ESLMediaRuleList.fromTuple('1|2|3|4|5', '@XS|@SM|@MD|@LG|@XL')\n   * ```\n   */\n  public static parseTuple(values: string, mask: string) {\n    const valueList = values.split('|');\n    const conditions = mask.split('|');\n    if (valueList.length !== conditions.length) throw new Error('Value doesn\\'t correspond to mask');\n    const rules = conditions.map((query, i) => new ESLMediaRule(valueList[i], query));\n    return new ESLMediaRuleList(rules);\n  }\n\n  private readonly _rules: ESLMediaRule<T>[];\n  private readonly _default: ESLMediaRule<T | undefined>;\n  private _active: ESLMediaRule<T | undefined>;\n\n  private constructor(rules: ESLMediaRule<T>[]) {\n    super();\n    this._rules = rules;\n    this._default = rules.filter((rule) => rule.default)[0];\n    this._onMatchChanged = this._onMatchChanged.bind(this);\n  }\n\n  /** Subscribes to the instance active rule change */\n  public addListener(listener: RuleChangedCallback<T>) {\n    super.addListener(listener);\n    if (this._listeners.size > 1) return;\n    this._rules.forEach((rule) => rule.addListener(this._onMatchChanged));\n  }\n\n  /** Unsubscribes from the instance active rule change */\n  public removeListener(listener: RuleChangedCallback<T>) {\n    super.removeListener(listener);\n    if (this._listeners.size) return;\n    this._rules.forEach((rule) => rule.removeListener(this._onMatchChanged));\n  }\n\n  /** List of inner {@link ESLMediaRule}s */\n  public get rules() {\n    return this._rules;\n  }\n\n  /** Cached active {@link ESLMediaRule} */\n  public get active() {\n    if (!this._active || !this._listeners.size) {\n      this._active = this.activeRule;\n    }\n    return this._active;\n  }\n\n  /** Returns last active rule in the list */\n  public get activeRule(): ESLMediaRule<T | undefined> {\n    const satisfiedRules = this.rules.filter((rule) => rule.matches);\n    return satisfiedRules.length > 0 ? satisfiedRules[satisfiedRules.length - 1] : ESLMediaRule.empty();\n  }\n\n  /** Active rule payload value */\n  public get activeValue(): T | undefined {\n    const value = this.active.payload;\n    if (isPrimitive(value) || !this.default || isPrimitive(this.default.payload)) return value;\n    return Object.assign({}, this._default.payload || {}, value);\n  }\n\n  /** {@link ESLMediaRule} that is used as a default */\n  public get default() {\n    return this._default;\n  }\n\n  /** Handle inner rules state change */\n  private _onMatchChanged() {\n    const rule = this.activeRule;\n    if (this._active === rule) return;\n    this.fire(this._active = rule, this);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    MediaRuleList: typeof ESLMediaRuleList;\n  }\n}\n","export abstract class TraversingUtils {\n  /**\n   * Check that `nodeA` and `nodeB` is from the same tree path.\n   */\n  static isRelative(nodeA: Node | null, nodeB: Node | null) {\n    return nodeA && nodeB && (nodeA.contains(nodeB) || nodeB.contains(nodeA));\n  }\n\n  /**\n   * Find closest parent node of `node` by `predicate`.\n   * Optional `skipSelf` to skip initial node\n   */\n  static closestBy(node: Node | null, predicate: (node: Node) => boolean, skipSelf = false): Node | null {\n    let current = skipSelf && node ? node.parentNode : node;\n    while (current) {\n      if (predicate(current)) return current;\n      current = current.parentNode;\n    }\n    return null;\n  }\n\n  /**\n   * Create function that find next dom element, that matches selector, in the sequence declared by `next` function\n   */\n  static createSequenceFinder(next: (el: Element) => Element | null) {\n    return function (base: Element, sel: string): Element | null {\n      for (let target: Element | null = next(base); target; target = next(target)) {\n        if (!sel || target.matches(sel)) return target;\n      }\n      return null;\n    };\n  }\n\n  /** @returns first matching next sibling or null*/\n  static findNext = TraversingUtils.createSequenceFinder((el) => el.nextElementSibling);\n  /** @returns first matching previous sibling or null*/\n  static findPrev = TraversingUtils.createSequenceFinder((el) => el.previousElementSibling);\n  /** @returns first matching parent or null*/\n  static findParent = TraversingUtils.createSequenceFinder((el) => el.parentElement);\n\n  /** @returns Array of all matching elements in subtree or empty array*/\n  static findAll(base: Element, sel: string): Element[] {\n    return sel ? Array.from(base.querySelectorAll(sel)) : [base];\n  }\n  /** @returns Array of all matching children or empty array*/\n  static findChildren(base: Element, sel: string): Element[] {\n    return Array.from(base.children).filter((el: Element) => !sel || el.matches(sel));\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {tuple, wrap, uniq} from '../../esl-utils/misc/array';\nimport {unwrapParenthesis} from '../../esl-utils/misc/format';\nimport {TraversingUtils} from '../../esl-utils/dom/traversing';\n\ntype ProcessorDescriptor = [string?, string?];\ntype ElementProcessor = (base: Element, sel: string) => Element | Element[] | null;\ntype CollectionProcessor = (els: Element[], sel: string) => Element[];\n\n/**\n * Traversing Query utility to find element via extended selector query\n * Extended query supports\n * - plain CSS selectors\n * - relative selectors (selectors that don't start from a plain selector will use passed base Element as a root)\n * - ::next and ::prev sibling pseudo-selectors\n * - ::parent and ::child pseudo-selectors\n * - ::find pseudo-selector\n * - ::first, ::last and :nth(#) limitation pseudo-selectors\n * - ::filter, ::not filtration pseudo-selectors\n *\n * @example\n * - `#id .class [attr]` - find by CSS selector in a current document\n * - ` ` - get current base element\n * - `::next` - get next sibling element\n * - `::prev` - get previous sibling element\n * - `::parent` - get base element parent\n * - `::parent(#id .class [attr])` - find the closest parent matching passed selector\n * - `::child(#id .class [attr])` - find direct child element(s) that match passed selector\n * - `::find(#id .class [attr])` - find child element(s) that match passed selector\n * - `::find(buttons, a)::not([hidden])` - find all buttons and anchors that are not have hidden attribute\n * - `::find(buttons, a)::filter(:first-child)` - find all buttons and anchors that are first child in container\n * - `::parent::child(some-tag)` - find direct child element(s) that match tag 'some-tag' in the parent\n * - `#id .class [attr]::parent` - find parent of element matching selector '#id .class [attr]' in document\n * - `::find(.row)::last::parent` - find parent of the last element matching selector '.row' from the base element subtree\n */\n@ExportNs('TraversingQuery')\nexport class TraversingQuery {\n  private static ELEMENT_PROCESSORS: Record<string, ElementProcessor> = {\n    '::find': TraversingUtils.findAll,\n    '::next': TraversingUtils.findNext,\n    '::prev': TraversingUtils.findPrev,\n    '::child': TraversingUtils.findChildren,\n    '::parent': TraversingUtils.findParent\n  };\n  private static COLLECTION_PROCESSORS: Record<string, CollectionProcessor> = {\n    '::first': (list: Element[]) => list.slice(0, 1),\n    '::last': (list: Element[]) => list.slice(-1),\n    '::nth': (list: Element[], sel?: string) => {\n      const index = sel ? +sel : NaN;\n      return wrap(list[index - 1]);\n    },\n    '::not': (list: Element[], sel?: string) => list.filter((el) => !el.matches(sel || '')),\n    '::filter': (list: Element[], sel?: string) => list.filter((el) => el.matches(sel || ''))\n  };\n\n  /**\n   * @returns RegExp that selects all known processors in query string\n   * e.g. /(::parent|::child|::next|::prev)/\n   */\n  private static get PROCESSORS_REGEX() {\n    const keys = Object.keys(this.ELEMENT_PROCESSORS).concat(Object.keys(this.COLLECTION_PROCESSORS));\n    return new RegExp(`(${keys.join('|')})`, 'g');\n  }\n\n  private static isCollectionProcessor([name]: ProcessorDescriptor) {\n    return name && (name in this.COLLECTION_PROCESSORS);\n  }\n  private static processElement(el: Element, [name, selString]: ProcessorDescriptor): Element[] {\n    const sel = unwrapParenthesis(selString || '');\n    if (!name || !(name in this.ELEMENT_PROCESSORS)) return [];\n    return wrap(this.ELEMENT_PROCESSORS[name](el, sel));\n  }\n  private static processCollection(els: Element[], [name, selString]: ProcessorDescriptor): Element[] {\n    const sel = unwrapParenthesis(selString || '');\n    if (!name || !(name in this.COLLECTION_PROCESSORS)) return [];\n    return wrap(this.COLLECTION_PROCESSORS[name](els, sel));\n  }\n\n  private static traverseChain(collection: Element[], processors: ProcessorDescriptor[], findFirst: boolean): Element[] {\n    if (!processors.length || !collection.length) return collection;\n    const [processor, ...rest] = processors;\n    if (this.isCollectionProcessor(processor)) {\n      const processedItem = this.processCollection(collection, processor);\n      return this.traverseChain(processedItem, rest, findFirst);\n    }\n    const result: Element[] = [];\n    for (const target of collection) {\n      const processedItem = this.processElement(target, processor);\n      const resultCollection: Element[] = this.traverseChain(processedItem, rest, findFirst);\n      if (!resultCollection.length) continue;\n      if (findFirst) return resultCollection.slice(0, 1);\n      result.push(...resultCollection);\n    }\n    return uniq(result);\n  }\n\n  static traverse(query: string, findFirst: boolean, base?: Element) {\n    const parts = query.split(this.PROCESSORS_REGEX).map((term) => term.trim());\n    const rootSel = parts.shift();\n    const baseCollection = base ? [base] : [];\n    const initial: Element[] = rootSel ? Array.from(document.querySelectorAll(rootSel)) : baseCollection;\n    return this.traverseChain(initial, tuple(parts), findFirst);\n  }\n\n  /** @returns first matching element reached via {@link TraversingQuery} rules */\n  static first(query: string, base?: Element): Element | null {\n    return TraversingQuery.traverse(query, true, base)[0] || null;\n  }\n  /** @returns Array of all matching elements reached via {@link TraversingQuery} rules */\n  static all(query: string, base?: Element): Element[] {\n    return TraversingQuery.traverse(query, false, base);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    TraversingQuery: typeof TraversingQuery;\n  }\n}\n","import {ESLImage} from './esl-image';\n\n/**\n * Describe mods configurations\n */\nexport interface ESLImageRenderStrategy {\n  /** Apply image from shadow loader */\n  apply: (img: ESLImage, shadowImg: HTMLImageElement) => void;\n  /** Clean strategy specific changes from ESLImage */\n  clear: (img: ESLImage) => void;\n}\n\n/**\n * Describes object that contains strategies mapping\n */\nexport interface ESLImageStrategyMap {\n  [mode: string]: ESLImageRenderStrategy;\n}\n\nexport const STRATEGIES: ESLImageStrategyMap = {\n  'cover': {\n    apply(img, shadowImg) {\n      const src = shadowImg.src;\n      const isEmpty = !src || ESLImage.isEmptyImage(src);\n      img.style.backgroundImage = isEmpty ? '' : `url(\"${src}\")`;\n    },\n    clear(img) {\n      img.style.backgroundImage = '';\n    }\n  },\n  'save-ratio': {\n    apply(img, shadowImg) {\n      const src = shadowImg.src;\n      const isEmpty = !src || ESLImage.isEmptyImage(src);\n      img.style.backgroundImage = isEmpty ? '' : `url(\"${src}\")`;\n      if (shadowImg.width === 0) return;\n      img.style.paddingTop = isEmpty ? '' : `${(shadowImg.height * 100 / shadowImg.width)}%`;\n    },\n    clear(img) {\n      img.style.paddingTop = '';\n      img.style.backgroundImage = '';\n    }\n  },\n  'fit': {\n    apply(img, shadowImg) {\n      const innerImg = img.attachInnerImage();\n      innerImg.src = shadowImg.src;\n      innerImg.removeAttribute('width');\n    },\n    clear(img) {\n      img.removeInnerImage();\n    }\n  },\n  'origin': {\n    apply(img, shadowImg) {\n      const innerImg = img.attachInnerImage();\n      innerImg.src = shadowImg.src;\n      innerImg.width = shadowImg.width / window.devicePixelRatio;\n    },\n    clear(img) {\n      img.removeInnerImage();\n    }\n  },\n  'inner-svg': {\n    apply(img, shadowImg) {\n      const request = new XMLHttpRequest();\n      request.open('GET', shadowImg.src, true);\n      request.onreadystatechange = () => {\n        if (request.readyState !== 4 || request.status !== 200) return;\n        const tmp = document.createElement('div');\n        tmp.innerHTML = request.responseText;\n        Array.from(tmp.querySelectorAll('script') || [])\n          .forEach((node: Element) => node.remove());\n        img.innerHTML = tmp.innerHTML;\n      };\n      request.send();\n    },\n    clear(img) {\n      img.innerHTML = '';\n    }\n  }\n};\n","import {ESLMedia} from './esl-media';\n\nconst RATIO_TO_ACTIVATE = 0.75; // TODO: customizable, at least global\nconst RATIO_TO_DEACTIVATE = 0.20; // TODO: customizable, at least global\n\nlet iObserver: IntersectionObserver;\n\n/** ESL Media Play-In-Viewport IntersectionObserver instance */\nexport function getIObserver(lazy: boolean = false) {\n  if (!iObserver && !lazy) {\n    iObserver = new IntersectionObserver(function (entries) {\n      entries.forEach(handleViewport);\n    }, {\n      threshold: [RATIO_TO_DEACTIVATE, RATIO_TO_ACTIVATE]\n    });\n  }\n  return iObserver;\n}\n\nfunction handleViewport(entry: IntersectionObserverEntry) {\n  const {target: video} = entry;\n  if (!(video instanceof ESLMedia)) return;\n\n  // Videos that playing and out of min ratio RATIO_TO_DEACTIVATE should be stopped\n  if (video.active && entry.intersectionRatio <= RATIO_TO_DEACTIVATE) {\n    video.pause();\n  }\n  // Play should starts only for inactive and background(muted) videos that are visible more then on RATIO_TO_ACTIVATE\n  if (!video.active && video.autoplay && entry.intersectionRatio >= RATIO_TO_ACTIVATE) {\n    video.play();\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {ESLBaseElement, attr, boolAttr} from '../../esl-base-element/core';\nimport {EventUtils} from '../../esl-utils/dom/events';\nimport {ESLMediaRuleList} from '../../esl-media-query/core';\nimport {TraversingQuery} from '../../esl-traversing-query/core/esl-traversing-query';\n\nimport {getIObserver} from './esl-image-iobserver';\nimport {STRATEGIES} from './esl-image-strategies';\n\nimport type {ESLImageRenderStrategy} from './esl-image-strategies';\n\ntype LoadState = 'error' | 'loaded' | 'ready';\nconst isLoadState = (state: string): state is LoadState => ['error', 'loaded', 'ready'].includes(state);\n\n/**\n * ESL Image\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya\n */\n@ExportNs('Image')\nexport class ESLImage extends ESLBaseElement {\n  public static is = 'esl-image';\n\n  // Default container class value\n  public static DEFAULT_CONTAINER_CLS = 'img-container-loaded';\n\n  public static get STRATEGIES() {\n    return STRATEGIES;\n  }\n\n  static get EMPTY_IMAGE() {\n    return 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';\n  }\n\n  static get observedAttributes() {\n    return ['alt', 'role', 'mode', 'aria-label', 'data-src', 'data-src-base', 'lazy-triggered'];\n  }\n\n  @attr() public alt: string;\n  @attr({defaultValue: 'save-ratio'}) public mode: string;\n  @attr({dataAttr: true}) public src: string;\n  @attr({dataAttr: true}) public srcBase: string;\n\n  @attr({defaultValue: 'none'}) public lazy: 'auto' | 'manual' | 'none' | '';\n  @boolAttr() public lazyTriggered: boolean;\n\n  @boolAttr() public refreshOnUpdate: boolean;\n  @attr({defaultValue: 'inner-image'}) public innerImageClass: string;\n\n  @attr({defaultValue: null}) public containerClass: string | null;\n  @attr({defaultValue: '::parent'}) public containerClassTarget: string;\n  @attr({defaultValue: 'ready'}) public containerClassState: string;\n\n  @boolAttr({readonly: true}) public readonly ready: boolean;\n  @boolAttr({readonly: true}) public readonly loaded: boolean;\n  @boolAttr({readonly: true}) public readonly error: boolean;\n\n  private _strategy: ESLImageRenderStrategy | null;\n  private _innerImg: HTMLImageElement | null;\n  private _srcRules: ESLMediaRuleList<string>;\n  private _currentSrc: string;\n  private _detachLazyTrigger: () => void;\n  private _shadowImageElement: HTMLImageElement;\n\n  protected connectedCallback() {\n    super.connectedCallback();\n    this.alt =\n      this.alt || this.getAttribute('aria-label') || this.getAttribute('data-alt') || '';\n    this.updateA11y();\n    this.srcRules.addListener(this._onMediaMatchChange);\n    if (this.lazyObservable) {\n      this.removeAttribute('lazy-triggered');\n      getIObserver().observe(this);\n      this._detachLazyTrigger = function () {\n        getIObserver().unobserve(this);\n        this._detachLazyTrigger = null;\n      };\n    }\n    this.refresh();\n  }\n\n  protected disconnectedCallback() {\n    super.disconnectedCallback();\n    this._detachLazyTrigger && this._detachLazyTrigger();\n    if (this._srcRules) {\n      this._srcRules.removeListener(this._onMediaMatchChange);\n    }\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string) {\n    if (!this.connected || oldVal === newVal) return;\n    switch (attrName) {\n      case 'aria-label':\n        this.alt = newVal || '';\n        break;\n      case 'alt':\n      case 'role':\n        this.updateA11y();\n        break;\n      case 'data-src':\n        this.srcRules = ESLMediaRuleList.parse(newVal);\n        this.refresh();\n        break;\n      case 'data-src-base':\n        this.refresh();\n        break;\n      case 'mode':\n        this.changeMode(oldVal, newVal);\n        break;\n      case 'lazy-triggered':\n        this.lazyTriggered && this.update();\n        break;\n    }\n  }\n\n  public get srcRules() {\n    if (!this._srcRules) {\n      this.srcRules = ESLMediaRuleList.parse(this.src);\n    }\n    return this._srcRules;\n  }\n\n  public set srcRules(rules: ESLMediaRuleList<string>) {\n    if (this._srcRules) {\n      this._srcRules.removeListener(this._onMediaMatchChange);\n    }\n    this._srcRules = rules;\n    this._srcRules.addListener(this._onMediaMatchChange);\n  }\n\n  public get currentSrc() {\n    return this._currentSrc;\n  }\n\n  public get empty() {\n    return !this._currentSrc || ESLImage.isEmptyImage(this._currentSrc);\n  }\n\n  public get canUpdate() {\n    return this.lazyTriggered || this.lazy === 'none';\n  }\n\n  public get lazyObservable() {\n    return this.lazy !== 'none' && this.lazy !== 'manual';\n  }\n\n  public get originalWidth() {\n    return this._shadowImageElement ? this._shadowImageElement.width : 0;\n  }\n\n  public get originalHeight() {\n    return this._shadowImageElement ? this._shadowImageElement.height : 0;\n  }\n\n  public triggerLoad() {\n    this.setAttribute('lazy-triggered', '');\n  }\n\n  protected changeMode(oldVal: string, newVal: string) {\n    oldVal = oldVal || 'save-ratio';\n    newVal = newVal || 'save-ratio';\n    if (oldVal === newVal) return;\n    if (!STRATEGIES[newVal]) {\n      this.mode = oldVal;\n      throw new Error('ESL Image: Unsupported mode: ' + newVal);\n    }\n    this.clearImage();\n    if (this.loaded) this.syncImage();\n  }\n\n  protected update(force: boolean = false) {\n    if (!this.canUpdate) return;\n\n    const src = this.getPath(this.srcRules.activeValue);\n\n    if (this._currentSrc !== src || !this.ready || force) {\n      this._currentSrc = src;\n      this._shadowImg.src = src;\n\n      if (this.refreshOnUpdate || !this.ready) {\n        this.syncImage();\n      }\n\n      if (this._shadowImg.complete) {\n        this._shadowImgError ? this._onError() : this._onLoad();\n      }\n    }\n\n    this._detachLazyTrigger && this._detachLazyTrigger();\n  }\n\n  protected updateA11y() {\n    const role = this.getAttribute('role') || 'img';\n    this.setAttribute('role', role);\n    this.innerImage && (this.innerImage.alt = this.alt);\n    if (role === 'img') this.setAttribute('aria-label', this.alt);\n  }\n\n  protected getPath(src: string | undefined) {\n    if (!src || src === '0' || src === 'none') {\n      return ESLImage.EMPTY_IMAGE;\n    }\n    return this.srcBase + src;\n  }\n\n  public refresh() {\n    this.removeAttribute('loaded');\n    this.removeAttribute('ready');\n    this.updateContainerClasses();\n    this.clearImage();\n    this.update(true);\n  }\n\n  private syncImage() {\n    const strategy = STRATEGIES[this.mode];\n    this._strategy = strategy;\n    strategy && strategy.apply(this, this._shadowImg);\n  }\n\n  private clearImage() {\n    this._strategy && this._strategy.clear(this);\n    this._strategy = null;\n  }\n\n  public get innerImage() {\n    return this._innerImg;\n  }\n\n  public attachInnerImage(): HTMLImageElement {\n    if (!this._innerImg) {\n      this._innerImg = this.querySelector(`img.${this.innerImageClass}`) ||\n        this._shadowImg.cloneNode() as HTMLImageElement;\n      this._innerImg.className = this.innerImageClass;\n    }\n    if (!this._innerImg.parentNode) {\n      this.appendChild(this._innerImg);\n    }\n    this._innerImg.alt = this.alt;\n    return this._innerImg;\n  }\n\n  public removeInnerImage() {\n    if (!this.innerImage) return;\n    this.removeChild(this.innerImage);\n    setTimeout(() => {\n      if (this._innerImg && !this._innerImg.parentNode) {\n        this._innerImg = null;\n      }\n    });\n  }\n\n  protected get _shadowImg() {\n    if (!this._shadowImageElement) {\n      this._shadowImageElement = new Image();\n      this._shadowImageElement.onload = this._onLoad;\n      this._shadowImageElement.onerror = this._onError;\n    }\n    return this._shadowImageElement;\n  }\n\n  protected get _shadowImgError() {\n    if (!this._shadowImg.complete) return false;\n    if (this._shadowImg.src.substr(-4) === '.svg') return false;\n    return this._shadowImg.naturalHeight <= 0;\n  }\n\n  @bind\n  private _onLoad() {\n    this.syncImage();\n    this._onReadyState(true);\n    this.updateContainerClasses();\n  }\n\n  @bind\n  private _onError() {\n    this._onReadyState(false);\n    this.updateContainerClasses();\n  }\n\n  @bind\n  private _onMediaMatchChange() {\n    this.update();\n  }\n\n  private _onReadyState(successful: boolean) {\n    if (this.ready) return;\n    this.toggleAttribute('loaded', successful);\n    this.toggleAttribute('error', !successful);\n    this.toggleAttribute('ready', true);\n    this.$$fire(successful ? 'load' : 'error');\n    this.$$fire('ready');\n  }\n\n  public updateContainerClasses() {\n    if (this.containerClass === null) return;\n    const cls = this.containerClass || (this.constructor as typeof ESLImage).DEFAULT_CONTAINER_CLS;\n    const state = isLoadState(this.containerClassState) && this[this.containerClassState];\n\n    const targetEl = TraversingQuery.first(this.containerClassTarget, this) as HTMLElement;\n    targetEl && CSSClassUtils.toggle(targetEl, cls, state);\n  }\n\n  public $$fire(eventName: string, eventInit: CustomEventInit = {bubbles: false}): boolean {\n    return EventUtils.dispatch(this, eventName, eventInit);\n  }\n\n  public static isEmptyImage(src: string) {\n    return src === ESLImage.EMPTY_IMAGE;\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Image: typeof ESLImage;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-image': ESLImage;\n  }\n}\n","import type {AnyToVoidFnSignature} from '../misc/functions';\n\n/**\n * Postpone action after next render\n */\nexport const afterNextRender = (callback: () => void) => requestAnimationFrame(() => requestAnimationFrame(callback));\n\n/**\n * Decorate function to schedule execution after next render\n * @returns decorated function\n */\nexport const rafDecorator = <T extends AnyToVoidFnSignature>(fn: T): T => {\n  let lastArgs: any[] | null = null; // null if no calls requested\n  return function (...args: any[]) {\n    if (lastArgs === null) {\n      requestAnimationFrame(() => {\n        lastArgs && fn.call(this, ...lastArgs);\n        lastArgs = null;\n      });\n    }\n    lastArgs = args;\n  } as T;\n};\n","export const TAB = 'Tab';\nexport const ENTER = 'Enter';\nexport const ESC = 'Escape';\nexport const SPACE = ' ';\nexport const BACKSPACE = 'Backspace';\n\nexport const ALT = 'Alt';\nexport const SHIFT = 'Shift';\nexport const CONTROL = 'Control';\n\nexport const PAUSE = 'Pause';\nexport const END = 'End';\nexport const HOME = 'Home';\nexport const DELETE = 'Delete';\n\nexport const PAGE_UP = 'PageUp';\nexport const PAGE_DOWN = 'PageDown';\n\nexport const ARROW_LEFT = 'ArrowLeft';\nexport const ARROW_UP = 'ArrowUp';\nexport const ARROW_RIGHT = 'ArrowRight';\nexport const ARROW_DOWN = 'ArrowDown';\n","import {ESLMediaProviderRegistry} from './esl-media-registry';\n\nimport type {ESLMedia} from './esl-media';\n\nexport enum PlayerStates {\n  BUFFERING = 3,\n  ENDED = 0,\n  PAUSED = 2,\n  PLAYING = 1,\n  UNSTARTED = -1,\n  VIDEO_CUED = 5,\n  UNINITIALIZED = -2\n}\n\nexport interface MediaProviderConfig {\n  mediaSrc?: string;\n  mediaId?: string;\n  loop: boolean;\n  muted: boolean;\n  controls: boolean;\n  autoplay: boolean;\n  title: string;\n  preload?: string;\n  playsinline?: boolean;\n}\n\nexport type ProviderType = (new(component: ESLMedia, config: MediaProviderConfig) => BaseProvider) & typeof BaseProvider;\n\nexport type ProviderObservedParams = 'loop' | 'muted' | 'controls';\n\n/**\n * BaseProvider class for media API providers\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya, Natallia Harshunova\n */\nexport abstract class BaseProvider {\n  static readonly providerName: string;\n\n  static parseUrl(url: string): Partial<MediaProviderConfig> | null {\n    return null;\n  }\n  static parseConfig(component: ESLMedia): MediaProviderConfig {\n    const {loop, muted, controls, autoplay, title, preload, playsinline, mediaId, mediaSrc} = component;\n    const config = {loop, muted, controls, autoplay, title, preload, playsinline};\n    if (mediaId) Object.assign(config, {mediaId});\n    if (mediaSrc) Object.assign(config, {mediaSrc});\n    return config;\n  }\n\n  protected config: MediaProviderConfig;\n  protected component: ESLMedia;\n  protected _el: HTMLElement;\n  protected _ready: Promise<any>;\n\n  public constructor(component: ESLMedia, config: MediaProviderConfig) {\n    this.config = config;\n    this.component = component;\n  }\n\n  /** Wraps _ready promise */\n  get ready() {\n    if (!this._ready) {\n      const res = Promise.reject('Not Initialized');\n      res.catch((e) => console.log('Rejected Media Operation: ', e));\n      return res;\n    }\n    return this._ready;\n  }\n\n  /** Bind the provider instance to the component */\n  public abstract bind(): void;\n\n  /** Unbind the provider instance from the component */\n  public unbind(): void {\n    Array.from(this.component.querySelectorAll('.esl-media-inner'))\n      .forEach((el: Node) => el.parentNode && el.parentNode.removeChild(el));\n  }\n\n  /** Provider name */\n  public get name(): string {\n    return (this.constructor as typeof BaseProvider).providerName;\n  }\n\n  /** @returns current state of the player */\n  public abstract get state(): PlayerStates;\n\n  /** @returns recommended aspect ratio */\n  public abstract get defaultAspectRatio(): number;\n\n  /** @returns resource duration */\n  public abstract get duration(): number;\n\n  /** @returns resource current time */\n  public abstract get currentTime(): number;\n\n  /** Low-level provider 'seek to' method implementation */\n  protected abstract seekTo(pos?: number): void | Promise<any>;\n\n  /** Low-level provider 'play' method implementation */\n  protected abstract play(): void | Promise<any>;\n\n  /** Low-level provider 'pause' method implementation */\n  protected abstract pause(): void | Promise<any>;\n\n  /** Low-level provider 'stop' method implementation */\n  protected abstract stop(): void | Promise<any>;\n\n  /** Set focus to the inner content */\n  public focus() {\n    this._el?.focus();\n  }\n\n  protected onConfigChange(param: ProviderObservedParams, value: boolean) {\n    this.config[param] = value;\n  }\n\n  /** Set size for inner content */\n  public setSize(width: number | 'auto', height: number | 'auto'): void {\n    if (!this._el) return;\n    this._el.style.setProperty('width', width === 'auto' ? null : `${width}px`);\n    this._el.style.setProperty('height', height === 'auto' ? null : `${height}px`);\n  }\n\n  /**\n   * Executes toggle action:\n   * If the player is PAUSED then it starts playing otherwise it pause playing\n   */\n  protected toggle() {\n    if ([PlayerStates.PAUSED, PlayerStates.UNSTARTED, PlayerStates.VIDEO_CUED].includes(this.state)) {\n      return this.play();\n    } else {\n      return this.pause();\n    }\n  }\n\n  /**\n   * Executes onConfigChange action when api is ready\n   * @returns Promise\n   */\n  public onSafeConfigChange(param: ProviderObservedParams, value: boolean) {\n    this.ready.then(() => this.onConfigChange(param, value));\n  }\n\n  /**\n   * Executes seekTo action when api is ready\n   * @returns Promise\n   */\n  public safeSeekTo(pos: number): Promise<void> {\n    return this.ready.then(() => this.seekTo(pos));\n  }\n\n  /**\n   * Executes play when api is ready\n   * @returns Promise\n   */\n  public safePlay(): Promise<void> {\n    return this.ready.then(() => this.play());\n  }\n\n  /**\n   * Executes pause when api is ready\n   * @returns Promise\n   */\n  public safePause(): Promise<void> {\n    return this.ready.then(() => this.pause());\n  }\n\n  /**\n   * Executes stop when api is ready\n   * @returns Promise\n   */\n  public safeStop(): Promise<void> {\n    return this.ready.then(() => this.stop());\n  }\n\n  /**\n   * Executes toggle when api is ready\n   * @returns Promise\n   */\n  public safeToggle(): Promise<void> {\n    return this.ready.then(() => this.toggle());\n  }\n\n  /**\n   * Register current provider.\n   * Can be used as a decorator.\n   */\n  public static register(this: ProviderType): void;\n  public static register(this: unknown, provider?: ProviderType): void;\n  public static register(this: any, provider?: ProviderType): void {\n    provider = provider || this;\n    if (provider === BaseProvider) throw new Error('`BaseProvider` can\\'t be registered.');\n    if (!(provider?.prototype instanceof BaseProvider)) throw new Error('Provider should be instanceof `BaseProvider`');\n    ESLMediaProviderRegistry.instance.register(provider);\n  }\n}\n","import {Observable} from '../../esl-utils/abstract/observable';\nimport type {BaseProvider, ProviderType} from './esl-media-provider';\n\nimport type {ESLMedia} from './esl-media';\n\nlet evRegistryInstance: ESLMediaProviderRegistry | null = null;\n/**\n * ESLMediaProviderRegistry class to store media API providers\n * @author Yuliya Adamskaya, Natallia Harshunova\n */\nexport class ESLMediaProviderRegistry extends Observable<(name: string, provider: ProviderType) => void> {\n  private providersMap: Map<string, ProviderType> = new Map();\n\n  public static get instance() {\n    if (!evRegistryInstance) {\n      evRegistryInstance = new ESLMediaProviderRegistry();\n    }\n    return evRegistryInstance;\n  }\n\n  /** List of registered providers */\n  public get providers(): ProviderType[] {\n    const list: ProviderType[] = [];\n    this.providersMap.forEach((provider) => list.push(provider));\n    return list;\n  }\n\n  /** Register provider */\n  public register(provider: ProviderType) {\n    if (!provider.providerName) throw new Error('Provider should have a name');\n    this.providersMap.set(provider.providerName, provider);\n    this.fire(provider.providerName, provider);\n  }\n\n  /** Check that provider is registered for passed name */\n  public has(name: string) {\n    return this.providersMap.has(name);\n  }\n\n  /** Find provider by name */\n  public findByName(name: string) {\n    if (!name || name === 'auto') return null;\n    return this.providersMap.get(name.toLowerCase()) || null;\n  }\n\n  /** Create provider instance for passed ESLMedia instance */\n  public createFor(media: ESLMedia): BaseProvider | null {\n    return this.createByType(media) || this.createBySrc(media);\n  }\n\n  /** Create provider instance for passed ESLMedia instance via provider name */\n  private createByType(media: ESLMedia): BaseProvider | null {\n    const provider = this.findByName(media.mediaType);\n    return provider ? ESLMediaProviderRegistry._create(provider, media) : null;\n  }\n\n  /** Create provider instance for passed ESLMedia instance via url */\n  private createBySrc(media: ESLMedia): BaseProvider | null {\n    for (const provider of this.providers.reverse()) {\n      const cfg = provider.parseUrl(media.mediaSrc);\n      if (cfg) return ESLMediaProviderRegistry._create(provider, media, cfg);\n    }\n    return null;\n  }\n\n  /** Create provider instance for passed configuration */\n  private static _create(provider: ProviderType, media: ESLMedia, cfg = provider.parseUrl(media.mediaSrc)) {\n    const config = Object.assign({}, cfg || {}, provider.parseConfig(media));\n    return new provider(media, config);\n  }\n}\n","import type {ESLMedia} from './esl-media';\n\nconst managerMap = new Map<string, ESLMedia>();\n\n/**\n * Group restriction manager for {@link ESLMedia}\n * Only one media in group can be played\n * Empty group is ignored\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya\n */\nexport class MediaGroupRestrictionManager {\n  /** @internal */\n  static get managerMap() {\n    return managerMap;\n  }\n\n  /** Register instance play state in group */\n  public static registerPlay(instance: ESLMedia) {\n    if (instance.group) {\n      const current = managerMap.get(instance.group);\n      managerMap.set(instance.group, instance);\n      if (!current || current === instance || !current.active) return;\n      if (current.$$fire('mangedpause')) {\n        current.pause();\n      }\n    }\n  }\n\n  /** Unregister instance */\n  public static unregister(instance: ESLMedia) {\n    if (instance.group) {\n      const reg = managerMap.get(instance.group);\n      if (reg === instance) managerMap.delete(instance.group);\n    }\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement, attr, boolAttr} from '../../esl-base-element/core';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {rafDecorator} from '../../esl-utils/async/raf';\nimport {debounce} from '../../esl-utils/async/debounce';\nimport {EventUtils} from '../../esl-utils/dom/events';\nimport {parseAspectRatio} from '../../esl-utils/misc/format';\n\nimport {ESLMediaQuery} from '../../esl-media-query/core';\nimport {TraversingQuery} from '../../esl-traversing-query/core';\n\nimport {SPACE, PAUSE} from '../../esl-utils/dom/keys';\nimport {getIObserver} from './esl-media-iobserver';\nimport {PlayerStates} from './esl-media-provider';\nimport {ESLMediaProviderRegistry} from './esl-media-registry';\nimport {MediaGroupRestrictionManager} from './esl-media-manager';\n\nimport type {BaseProvider} from './esl-media-provider';\n\nexport type ESLMediaFillMode = 'cover' | 'inscribe' | '';\n\n/**\n * ESL Media\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya\n */\n@ExportNs('Media')\nexport class ESLMedia extends ESLBaseElement {\n  public static is = 'esl-media';\n  public static eventNs = 'esl:media:';\n\n  /** Media resource identifier */\n  @attr() public mediaId: string;\n  /** Media resource src/url path */\n  @attr() public mediaSrc: string;\n  /** Media resource type. 'auto' (auto detection from src) by default */\n  @attr() public mediaType: string;\n\n  /** Media elements group name */\n  @attr() public group: string;\n  /** Media resource rendering strategy relative to the element area: 'cover', 'inscribe' or not defined */\n  @attr() public fillMode: ESLMediaFillMode;\n  /** Strict aspect ratio definition */\n  @attr() public aspectRatio: string;\n\n\n  /** Disabled marker to prevent rendering */\n  @boolAttr() public disabled: boolean;\n  /** Autoplay resource marker */\n  @boolAttr() public autoplay: boolean;\n  /** Autofocus on play marker */\n  @boolAttr() public autofocus: boolean;\n  /** Mute resource marker */\n  @boolAttr() public muted: boolean;\n  /** Loop resource play */\n  @boolAttr() public loop: boolean;\n  /** Marker to show controls for resource player */\n  @boolAttr() public controls: boolean;\n  /** Allow media to play inline (see HTML video/audio spec) */\n  @boolAttr() public playsinline: boolean;\n  /** Allows play resource only in viewport area */\n  @boolAttr() public playInViewport: boolean;\n\n  /** Preload resource */\n  @attr({defaultValue: 'auto'}) public preload: string;\n\n  /** Ready state class/classes */\n  @attr() public readyClass: string;\n  /** Ready state class/classes target */\n  @attr() public readyClassTarget: string;\n\n  /** Class / classes to add when media is accepted */\n  @attr() public loadClsAccepted: string;\n  /** Class / classes to add when media is declined */\n  @attr() public loadClsDeclined: string;\n  /** Target element {@link TraversingQuery} select to add accepted/declined classes */\n  @attr({defaultValue: '::parent'}) public loadClsTarget: string;\n\n  /** @readonly Ready state marker */\n  @boolAttr({readonly: true}) public ready: boolean;\n  /** @readonly Active state marker */\n  @boolAttr({readonly: true}) public active: boolean;\n  /** @readonly Resource played marker */\n  @boolAttr({readonly: true}) public played: boolean;\n  /** @readonly Error state marker */\n  @boolAttr({readonly: true}) public error: boolean;\n\n  private _provider: BaseProvider | null;\n  private _conditionQuery: ESLMediaQuery | null;\n\n  private deferredResize = rafDecorator(() => this._onResize());\n  private deferredReinitialize = debounce(() => this.reinitInstance());\n\n  /**\n   * Map object with possible Player States, values:\n   * BUFFERING, ENDED, PAUSED, PLAYING, UNSTARTED, VIDEO_CUED, UNINITIALIZED\n   */\n  static get PLAYER_STATES() {\n    return PlayerStates;\n  }\n\n  static get observedAttributes() {\n    return [\n      'disabled',\n      'media-type',\n      'media-id',\n      'media-src',\n      'fill-mode',\n      'aspect-ratio',\n      'play-in-viewport',\n      'muted',\n      'loop',\n      'controls'\n    ];\n  }\n\n  static supports(name: string): boolean {\n    return ESLMediaProviderRegistry.instance.has(name);\n  }\n\n  protected connectedCallback() {\n    super.connectedCallback();\n    if (!this.hasAttribute('role')) {\n      this.setAttribute('role', 'application');\n    }\n    this.innerHTML += '<!-- Inner Content, do not modify it manually -->';\n    this.bindEvents();\n    this.attachViewportConstraint();\n    this.deferredReinitialize();\n  }\n\n  protected disconnectedCallback() {\n    super.disconnectedCallback();\n    this.unbindEvents();\n    this.detachViewportConstraint();\n    this._provider && this._provider.unbind();\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string) {\n    if (!this.connected || oldVal === newVal) return;\n    switch (attrName) {\n      case 'disabled':\n      case 'media-id':\n      case 'media-src':\n      case 'media-type':\n        this.deferredReinitialize();\n        break;\n      case 'loop':\n      case 'muted':\n      case 'controls':\n        this._provider && this._provider.onSafeConfigChange(attrName, newVal !== null);\n        break;\n      case 'fill-mode':\n      case 'aspect-ratio':\n        this.deferredResize();\n        break;\n      case 'play-in-viewport':\n        this.playInViewport ?\n          this.attachViewportConstraint() :\n          this.detachViewportConstraint();\n        break;\n    }\n  }\n\n  protected bindEvents() {\n    ESLMediaProviderRegistry.instance.addListener(this._onRegistryStateChange);\n    if (this.conditionQuery) {\n      this.conditionQuery.addListener(this.deferredReinitialize);\n    }\n    if (this.fillModeEnabled) {\n      window.addEventListener('resize', this.deferredResize);\n    }\n    window.addEventListener('esl:refresh', this._onRefresh);\n    this.addEventListener('keydown', this._onKeydown);\n  }\n  protected unbindEvents() {\n    ESLMediaProviderRegistry.instance.removeListener(this._onRegistryStateChange);\n    if (this.conditionQuery) {\n      this.conditionQuery.removeListener(this.deferredReinitialize);\n    }\n    if (this.fillModeEnabled) {\n      window.removeEventListener('resize', this.deferredResize);\n    }\n    window.removeEventListener('esl:refresh', this._onRefresh);\n    this.removeEventListener('keydown', this._onKeydown);\n  }\n\n  public canActivate() {\n    if (this.disabled) return false;\n    if (this.conditionQuery) return this.conditionQuery.matches;\n    return true;\n  }\n\n  private reinitInstance() {\n    console.debug('[ESL] Media reinitialize ', this);\n    this._provider && this._provider.unbind();\n    this._provider = null;\n\n    if (this.canActivate()) {\n      this._provider = ESLMediaProviderRegistry.instance.createFor(this);\n      if (this._provider) {\n        this._provider.bind();\n        console.debug('[ESL] Media provider bound', this._provider);\n      } else {\n        this._onError();\n      }\n    }\n\n    this.updateContainerMarkers();\n  }\n\n  public updateContainerMarkers() {\n    const targetEl = TraversingQuery.first(this.loadClsTarget, this) as HTMLElement;\n    if (!targetEl) return;\n\n    const active = this.canActivate();\n    CSSClassUtils.toggle(targetEl, this.loadClsAccepted, active);\n    CSSClassUtils.toggle(targetEl, this.loadClsDeclined, !active);\n  }\n\n  /** Seek to given position of media */\n  public seekTo(pos: number) {\n    return this._provider && this._provider.safeSeekTo(pos);\n  }\n\n  /**\n   * Start playing media\n   * @param allowActivate - allows to remove disabled marker\n   */\n  public play(allowActivate: boolean = false): Promise<void> | null {\n    if (this.disabled && allowActivate) {\n      this.disabled = false;\n      this.deferredReinitialize.cancel();\n      this.reinitInstance();\n    }\n    if (!this.canActivate()) return null;\n    return this._provider && this._provider.safePlay();\n  }\n\n  /** Pause playing media */\n  public pause(): Promise<void> | null {\n    return this._provider && this._provider.safePause();\n  }\n\n  /** Stop playing media */\n  public stop(): Promise<void> | null {\n    return this._provider && this._provider.safeStop();\n  }\n\n  /** Toggle play/pause state of the media */\n  public toggle(): Promise<void> | null {\n    return this._provider && this._provider.safeToggle();\n  }\n\n  /** Focus inner player **/\n  public focusPlayer(): void {\n    this._provider && this._provider.focus();\n  }\n\n  // media live-cycle handlers\n  public _onReady() {\n    this.toggleAttribute('ready', true);\n    this.toggleAttribute('error', false);\n    this.updateReadyClass();\n    this.deferredResize();\n    this.$$fire('ready');\n  }\n\n  public _onError(detail?: any, setReadyState = true) {\n    this.toggleAttribute('ready', true);\n    this.toggleAttribute('error', true);\n    this.$$fire('error', {detail});\n    setReadyState && this.$$fire('ready');\n  }\n\n  public _onDetach() {\n    this.removeAttribute('active');\n    this.removeAttribute('ready');\n    this.removeAttribute('played');\n    this.updateReadyClass();\n    this.$$fire('detach');\n  }\n\n  public _onPlay() {\n    if (this.autofocus) this.focus();\n    this.deferredResize();\n    this.setAttribute('active', '');\n    this.setAttribute('played', '');\n    this.$$fire('play');\n    MediaGroupRestrictionManager.registerPlay(this);\n  }\n\n  public _onPaused() {\n    this.removeAttribute('active');\n    this.$$fire('paused');\n    MediaGroupRestrictionManager.unregister(this);\n  }\n\n  public _onEnded() {\n    this.removeAttribute('active');\n    this.$$fire('ended');\n    MediaGroupRestrictionManager.unregister(this);\n  }\n\n  public _onResize() {\n    if (!this._provider) return;\n    if (this.fillModeEnabled && this.actualAspectRatio > 0) {\n      let stretchVertically = this.offsetWidth / this.offsetHeight < this.actualAspectRatio;\n      if (this.fillMode === 'inscribe') stretchVertically = !stretchVertically; // Inscribe behaves inversely\n      stretchVertically ?\n        this._provider.setSize(this.actualAspectRatio * this.offsetHeight, this.offsetHeight) : // h\n        this._provider.setSize(this.offsetWidth, this.offsetWidth / this.actualAspectRatio);   // w\n    } else {\n      this._provider.setSize('auto', 'auto');\n    }\n  }\n\n  @bind\n  protected _onRefresh(e: Event) {\n    const {target} = e;\n    if (target instanceof HTMLElement && target.contains(this)) {\n      this._onResize();\n    }\n  }\n\n  @bind\n  protected _onRegistryStateChange(name: string) {\n    const type = this.mediaType.toLowerCase() || 'auto';\n    if (name === type || (!this.providerType && type === 'auto')) {\n      this.reinitInstance();\n    }\n  }\n\n  @bind\n  protected _onKeydown(e: KeyboardEvent) {\n    if (e.target !== this) return;\n    if ([SPACE, PAUSE].includes(e.key)) {\n      e.preventDefault();\n      e.stopPropagation();\n      this.toggle();\n    }\n  }\n\n  /** Update ready class state */\n  protected updateReadyClass() {\n    const target = TraversingQuery.first(this.readyClassTarget, this) as HTMLElement;\n    target && CSSClassUtils.toggle(target, this.readyClass, this.ready);\n  }\n\n  /** Applied provider */\n  public get providerType() {\n    return this._provider ? this._provider.name : '';\n  }\n\n  /** Current player state, see {@link ESLMedia.PLAYER_STATES} values */\n  public get state() {\n    return this._provider ? this._provider.state : PlayerStates.UNINITIALIZED;\n  }\n\n  /** Duration of the media resource */\n  public get duration() {\n    return this._provider ? this._provider.duration : 0;\n  }\n\n  /** Current time of media resource */\n  public get currentTime() {\n    return this._provider ? this._provider.currentTime : 0;\n  }\n\n  /** Set current time of media resource */\n  public set currentTime(time: number) {\n    (this._provider) && this._provider.safeSeekTo(time);\n  }\n\n  /** ESLMediaQuery to limit ESLMedia loading */\n  public get conditionQuery() {\n    if (!this._conditionQuery && this._conditionQuery !== null) {\n      const query = this.getAttribute('load-condition');\n      this._conditionQuery = query ? ESLMediaQuery.for(query) : null;\n    }\n    return this._conditionQuery;\n  }\n\n  /** Fill mode should be handled for element */\n  public get fillModeEnabled() {\n    return this.fillMode === 'cover' || this.fillMode === 'inscribe';\n  }\n\n  /** Used resource aspect ratio forced by attribute or returned by provider */\n  public get actualAspectRatio() {\n    if (this.aspectRatio && this.aspectRatio !== 'auto') return parseAspectRatio(this.aspectRatio);\n    return this._provider ? this._provider.defaultAspectRatio : 0;\n  }\n\n  protected attachViewportConstraint() {\n    if (this.playInViewport) {\n      getIObserver().observe(this);\n    }\n  }\n  protected detachViewportConstraint() {\n    const observer = getIObserver(true);\n    observer && observer.unobserve(this);\n  }\n\n  public $$fire(eventName: string, eventInit?: CustomEventInit): boolean {\n    const ns = (this.constructor as typeof ESLMedia).eventNs;\n    return EventUtils.dispatch(this, ns + eventName, eventInit);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Media: typeof ESLMedia;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-media': ESLMedia;\n  }\n}\n","import type {AnyToVoidFnSignature} from '../misc/functions';\n\n/**\n * Task placeholder with a single place for executing deferred task.\n * Only one task can be planed per DelayedTask instance.\n * @see put DelayedTask.put behaviour description.\n */\nexport class DelayedTask {\n  protected _fn: AnyToVoidFnSignature | null = null;\n  protected _timeout: number | null = null;\n\n  /** Execute deferred task immediately */\n  protected run = () => {\n    this._timeout = null;\n    this._fn && this._fn();\n  };\n\n  /** @returns Function of currently deferred (planned) task */\n  public get fn() {\n    return this._fn;\n  }\n\n  /**\n   * Cancel deferred task and planning passed\n   * @param task - task function\n   * @param delay - time to delay task execution\n   *  - pass negative or false to execute task immediately\n   *  - pass 0 to plan task to the macrotask\n   *  - pass positive number x to delay task on x ms.\n   * */\n  public put(task: AnyToVoidFnSignature, delay: number | string | boolean = false) {\n    const prev = this.cancel();\n    if (typeof task === 'function') {\n      if (delay && typeof delay === 'string') delay = +delay;\n      if (typeof delay === 'number' && delay >= 0) {\n        this._fn = task;\n        this._timeout = window.setTimeout(this.run, delay);\n      } else {\n        task();\n      }\n    }\n    return prev;\n  }\n\n  /** Cancel deferred (planned) task */\n  public cancel() {\n    const prev = this._fn;\n    (typeof this._timeout === 'number') && clearTimeout(this._timeout);\n    this._fn = this._timeout = null;\n    return prev;\n  }\n}\n","import {toKebabCase, evaluate} from '../../esl-utils/misc/format';\nimport type {ESLBaseElement} from '../core/esl-base-element';\n\n/** HTML attribute to object property mapping configuration */\ninterface JsonAttrDescriptor<T> {\n  /** HTML attribute name. Uses kebab-cased variable name by default */\n  name?: string;\n  /** Create getter only */\n  readonly?: boolean;\n  /** Use data-* attribute */\n  dataAttr?: boolean;\n  /** Default property value. Used if no attribute is present on the element. Empty string by default. */\n  defaultValue?: T;\n}\n\nfunction buildJsonAttrDescriptor<T>(attrName: string, readOnly: boolean, defaultValue: T | null) {\n  function get() {\n    const attrContent = (this.getAttribute(attrName) || '').trim();\n    return evaluate(attrContent, defaultValue);\n  }\n\n  function set(value: any) {\n    if (typeof value !== 'object') {\n      console.error('Can not set json value: value should be object');\n    }\n    try {\n      if (value) {\n        const serializedValue = JSON.stringify(value);\n        this.setAttribute(attrName, serializedValue);\n      } else {\n        this.removeAttribute(attrName);\n      }\n    } catch (e) {\n      console.error('[ESL] jsonAttr: Can not set json value ', e);\n    }\n  }\n\n  return readOnly ? {get} : {get, set};\n}\n\nconst buildAttrName =\n  (propName: string, dataAttr: boolean) => dataAttr ? `data-${toKebabCase(propName)}` : toKebabCase(propName);\n\n/**\n * Decorator to map current property to element attribute value using JSON (de-)serialization rules.\n * Maps object type property.\n * @param config - mapping configuration. See {@link JsonAttrDescriptor}\n */\nexport const jsonAttr = <T>(config: JsonAttrDescriptor<T> = {}) => {\n  config = Object.assign({defaultValue: {}}, config);\n  return (target: ESLBaseElement, propName: string) => {\n    const attrName = buildAttrName(config.name || propName, !!config.dataAttr);\n    Object.defineProperty(target, propName, buildJsonAttrDescriptor(attrName, !!config.readonly, config.defaultValue));\n  };\n};\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESC} from '../../esl-utils/dom/keys';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {defined, copyDefinedKeys} from '../../esl-utils/misc/object';\nimport {DeviceDetector} from '../../esl-utils/environment/device-detector';\nimport {DelayedTask} from '../../esl-utils/async/delayed-task';\nimport {ESLBaseElement, attr, jsonAttr, boolAttr} from '../../esl-base-element/core';\n\n/** Default Toggleable action params type definition */\nexport interface ToggleableActionParams {\n  /** Initiator string identifier */\n  initiator?: string;\n  /** Delay timeout for both show and hide actions */\n  delay?: number;\n  /** Show delay timeout */\n  showDelay?: number;\n  /** Hide delay timeout */\n  hideDelay?: number;\n  /** Force action independently of current state of the Toggleable */\n  force?: boolean;\n  /** Do not throw events on action */\n  silent?: boolean;\n  /** Activate hover tracking to hide Toggleable */\n  trackHover?: boolean;\n  /** Element activator of the action */\n  activator?: HTMLElement | null;\n  /** Event that initiates the action */\n  event?: Event;\n\n  /** Custom user data */\n  [key: string]: any;\n}\n\nconst activators: WeakMap<ESLToggleable, HTMLElement | undefined> = new WeakMap();\n\n/**\n * ESLToggleable component\n * @author Julia Murashko, Alexey Stsefanovich (ala'n)\n *\n * ESLToggleable - a custom element, that is used as a base for \"Popup-like\" components creation\n */\n@ExportNs('Toggleable')\nexport class ESLToggleable extends ESLBaseElement {\n  static is = 'esl-toggleable';\n  static get observedAttributes() {\n    return ['open', 'group'];\n  }\n\n  /** CSS class to add on the body element */\n  @attr() public bodyClass: string;\n  /** CSS class to add when the Toggleable is active */\n  @attr({defaultValue: 'open'}) public activeClass: string;\n\n  /** Toggleable group meta information to organize groups */\n  @attr({name: 'group'}) public groupName: string;\n  /** Selector to mark inner close triggers */\n  @attr({name: 'close-on'}) public closeTrigger: string;\n\n  /** Close the Toggleable on ESC keyboard event */\n  @boolAttr() public closeOnEsc: boolean;\n  /** Close the Toggleable on a click/tap outside */\n  @boolAttr() public closeOnOutsideAction: boolean;\n\n  /** Initial params to pass to show/hide action on the start */\n  @jsonAttr<ToggleableActionParams>({defaultValue: {force: true, initiator: 'init'}})\n  public initialParams: ToggleableActionParams;\n  /** Default params to merge into passed action params */\n  @jsonAttr<ToggleableActionParams>({defaultValue: {}})\n  public defaultParams: ToggleableActionParams;\n  /** Hover params to pass from track hover listener */\n  @jsonAttr<ToggleableActionParams>({defaultValue: {}})\n  public trackHoverParams: ToggleableActionParams;\n\n  /** Marker of initially opened toggleable instance */\n  public initiallyOpened: boolean;\n\n  /** Inner state */\n  private _open: boolean = false;\n\n  /** Inner show/hide task manager instance */\n  protected _task: DelayedTask = new DelayedTask();\n  /** Marker for current hover listener state */\n  protected _trackHover: boolean = false;\n  /** Delay for track hover listeners actions */\n  protected _trackHoverDelay: number | undefined;\n\n  protected connectedCallback() {\n    super.connectedCallback();\n    this.initiallyOpened = this.hasAttribute('open');\n    this.bindEvents();\n    this.setInitialState();\n  }\n\n  protected disconnectedCallback() {\n    super.disconnectedCallback();\n    this.unbindEvents();\n    activators.delete(this);\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string) {\n    if (!this.connected || newVal === oldVal) return;\n    switch (attrName) {\n      case 'open':\n        if (this.open === this.hasAttribute('open')) return;\n        this.toggle(this.open, {initiator: 'attribute', showDelay: 0, hideDelay: 0});\n        break;\n      case 'group':\n        this.$$fire('change:group',  {\n          detail: {oldGroupName: oldVal, newGroupName: newVal}\n        });\n        break;\n    }\n  }\n\n  /** Set initial state of the Toggleable */\n  protected setInitialState() {\n    if (this.initialParams) {\n      this.toggle(this.initiallyOpened, this.initialParams);\n    }\n  }\n\n  protected bindEvents() {\n    this.addEventListener('click', this._onClick);\n    this.addEventListener('keydown', this._onKeyboardEvent);\n  }\n\n  protected unbindEvents() {\n    this.removeEventListener('click', this._onClick);\n    this.removeEventListener('keydown', this._onKeyboardEvent);\n    this.bindOutsideEventTracking(false);\n    this.bindHoverStateTracking(false);\n  }\n\n  /** Bind outside action event listeners */\n  protected bindOutsideEventTracking(track: boolean) {\n    document.body.removeEventListener('mouseup', this._onOutsideAction);\n    document.body.removeEventListener('touchend', this._onOutsideAction);\n    if (track) {\n      document.body.addEventListener('mouseup', this._onOutsideAction, true);\n      document.body.addEventListener('touchend', this._onOutsideAction, true);\n    }\n  }\n  /** Bind hover events listeners for the Toggleable itself */\n  protected bindHoverStateTracking(track: boolean, hideDelay?: number | string) {\n    if (!DeviceDetector.hasHover) return;\n    this._trackHoverDelay = track && hideDelay !== undefined ? +hideDelay : undefined;\n    if (this._trackHover === track) return;\n    this._trackHover = track;\n\n    this.removeEventListener('mouseenter', this._onMouseEnter);\n    this.removeEventListener('mouseleave', this._onMouseLeave);\n    if (this._trackHover) {\n      this.addEventListener('mouseenter', this._onMouseEnter);\n      this.addEventListener('mouseleave', this._onMouseLeave);\n    }\n  }\n\n  /** Function to merge the result action params */\n  protected mergeDefaultParams(params?: ToggleableActionParams): ToggleableActionParams {\n    return Object.assign({}, this.defaultParams, copyDefinedKeys(params));\n  }\n\n  /** Toggle the element state */\n  public toggle(state: boolean = !this.open, params?: ToggleableActionParams) {\n    return state ? this.show(params) : this.hide(params);\n  }\n\n  /** Change the element state to active */\n  public show(params?: ToggleableActionParams) {\n    params = this.mergeDefaultParams(params);\n    this._task.put(this.showTask.bind(this, params), defined(params.showDelay, params.delay));\n    this.bindOutsideEventTracking(this.closeOnOutsideAction);\n    this.bindHoverStateTracking(!!params.trackHover, defined(params.hideDelay, params.delay));\n    return this;\n  }\n  /** Change the element state to inactive */\n  public hide(params?: ToggleableActionParams) {\n    params = this.mergeDefaultParams(params);\n    this._task.put(this.hideTask.bind(this, params), defined(params.hideDelay, params.delay));\n    this.bindOutsideEventTracking(false);\n    this.bindHoverStateTracking(!!params.trackHover, defined(params.hideDelay, params.delay));\n    return this;\n  }\n\n  /** Actual show task to execute by toggleable task manger ({@link DelayedTask} out of the box) */\n  protected showTask(params: ToggleableActionParams) {\n    if (!params.force && this.open) return;\n    if (!params.silent && !this.$$fire('before:show', {detail: {params}})) return;\n    this.activator = params.activator;\n    this.open = true;\n    this.onShow(params);\n    if (!params.silent) this.$$fire('show', {detail: {params}, cancelable: false});\n  }\n  /** Actual hide task to execute by toggleable task manger ({@link DelayedTask} out of the box) */\n  protected hideTask(params: ToggleableActionParams) {\n    if (!params.force && !this.open) return;\n    if (!params.silent && !this.$$fire('before:hide', {detail: {params}})) return;\n    this.open = false;\n    this.onHide(params);\n    if (!params.silent) this.$$fire('hide', {detail: {params}, cancelable: false});\n  }\n\n  /**\n   * Actions to execute on show toggleable.\n   * Inner state and 'open' attribute are not affected and updated before `onShow` execution.\n   * Adds CSS classes, update a11y and fire esl:refresh event by default.\n   */\n  protected onShow(params: ToggleableActionParams) {\n    CSSClassUtils.add(this, this.activeClass);\n    CSSClassUtils.add(document.body, this.bodyClass, this);\n    this.updateA11y();\n    this.$$fire('esl:refresh'); // To notify other components about content change\n  }\n\n  /**\n   * Actions to execute on hide toggleable.\n   * Inner state and 'open' attribute are not affected and updated before `onShow` execution.\n   * Removes CSS classes and update a11y by default.\n   */\n  protected onHide(params: ToggleableActionParams) {\n    CSSClassUtils.remove(this, this.activeClass);\n    CSSClassUtils.remove(document.body, this.bodyClass, this);\n    this.updateA11y();\n  }\n\n  /** Active state marker */\n  public get open() {\n    return this._open;\n  }\n  public set open(value: boolean) {\n    this.toggleAttribute('open', this._open = value);\n  }\n\n  /** Last component that has activated the element. Uses {@link ToggleableActionParams.activator}*/\n  public get activator(): HTMLElement | null | undefined {\n    return activators.get(this);\n  }\n  public set activator(el: HTMLElement | null | undefined) {\n    el ? activators.set(this, el) : activators.delete(this);\n  }\n\n  /** Returns the element to apply a11y attributes */\n  protected get $a11yTarget(): HTMLElement | null {\n    const target = this.getAttribute('a11y-target');\n    if (target === 'none') return null;\n    return target ? this.querySelector(target) : this;\n  }\n\n  /** Called on show and on hide actions to update a11y state accordingly */\n  protected updateA11y() {\n    const targetEl = this.$a11yTarget;\n    if (!targetEl) return;\n    targetEl.setAttribute('aria-hidden', String(!this._open));\n  }\n\n  // \"Private\" Handlers\n  @bind\n  protected _onClick(e: MouseEvent) {\n    const target = e.target as HTMLElement;\n    if (this.closeTrigger && target.closest(this.closeTrigger)) {\n      this.hide({initiator: 'close', activator: target, event: e});\n    }\n  }\n  @bind\n  protected _onOutsideAction(e: MouseEvent) {\n    const target = e.target as HTMLElement;\n    if (this.contains(target)) return;\n    if (this.activator && this.activator.contains(target)) return;\n    // Used 0 delay to decrease priority of the request\n    this.hide({initiator: 'outsideaction', activator: target, hideDelay: 0, event: e});\n  }\n\n  @bind\n  protected _onKeyboardEvent(e: KeyboardEvent) {\n    if (this.closeOnEsc && e.key === ESC) {\n      this.hide({initiator: 'keyboard', event: e});\n    }\n  }\n\n  @bind\n  protected _onMouseEnter(e: MouseEvent) {\n    const hideDelay = this._trackHoverDelay;\n    const baseParams: ToggleableActionParams = {initiator: 'mouseenter', trackHover: true, activator: this.activator, event: e, hideDelay};\n    this.show(Object.assign(baseParams, this.trackHoverParams));\n  }\n  @bind\n  protected _onMouseLeave(e: MouseEvent) {\n    const hideDelay = this._trackHoverDelay;\n    const baseParams: ToggleableActionParams = {initiator: 'mouseleave', trackHover: true, activator: this.activator, event: e, hideDelay};\n    this.hide(Object.assign(baseParams, this.trackHoverParams));\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Toggleable: typeof ESLToggleable;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-toggleable': ESLToggleable;\n  }\n}\n","import {ESLBaseElement} from '../../esl-base-element/core';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {EventUtils} from '../../esl-utils/dom/events';\nimport {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLToggleable} from './esl-toggleable';\n\n/**\n * ESLToggleableDispatcher\n * @author Julia Murashko, Alexey Stsefanovich (ala'n)\n *\n * ESLToggleableDispatcher - plugin component, that prevents activation of multiple ESLToggleable instances in bounds of managed container.\n */\n@ExportNs('ToggleableDispatcher')\nexport class ESLToggleableDispatcher extends ESLBaseElement {\n  public static readonly is = 'esl-toggleable-dispatcher';\n\n  /**\n   * Initialize ToggleableGroupDispatcher\n   * Uses esl-toggleable-dispatcher tag and document body root by default\n   */\n  public static init(root: HTMLElement = document.body, tagName: string = this.is) {\n    if (!root) throw new Error('Root element should be specified');\n    const instances = root.getElementsByTagName(tagName);\n    if (instances.length) return;\n    this.register(tagName);\n    root.insertAdjacentElement('afterbegin', document.createElement(tagName));\n  }\n\n  protected _root: HTMLElement | null;\n  protected _popups: Map<string, ESLToggleable> = new Map<string, ESLToggleable>();\n\n  protected connectedCallback() {\n    super.connectedCallback();\n    this.root = this.parentElement;\n  }\n  protected disconnectedCallback() {\n    super.disconnectedCallback();\n    this.root = null;\n  }\n\n  protected bindEvents() {\n    if (!this.root) return;\n    this.root.addEventListener('esl:before:show', this._onBeforeShow);\n    this.root.addEventListener('esl:show', this._onShow);\n    this.root.addEventListener('esl:hide', this._onHide);\n    this.root.addEventListener('esl:change:group', this._onChangeGroup);\n  }\n  protected unbindEvents() {\n    if (!this.root) return;\n    this.root.removeEventListener('esl:before:show', this._onBeforeShow);\n    this.root.removeEventListener('esl:show', this._onShow);\n    this.root.removeEventListener('esl:hide', this._onHide);\n    this.root.removeEventListener('esl:change:group', this._onChangeGroup);\n  }\n\n  /** Observed element */\n  public get root(): HTMLElement | null {\n    return this._root;\n  }\n  public set root(root: HTMLElement | null) {\n    this.unbindEvents();\n    this._root = root;\n    this.bindEvents();\n  }\n\n  /** Guard-condition for targets */\n  protected isAcceptable(target: any): target is ESLToggleable {\n    if (!(target instanceof ESLToggleable)) return false;\n    return !!target.groupName && target.groupName !== 'none';\n  }\n\n  /** Hide active element in group */\n  public hideActive(groupName: string, activator?: HTMLElement) {\n    const active = this.getActive(groupName);\n    if (!active || active === activator) return;\n    active.hide({\n      initiator: 'dispatcher',\n      dispatcher: this,\n      activator\n    });\n  }\n\n  /** Set active element in group */\n  public setActive(groupName: string, popup: ESLToggleable) {\n    if (!groupName) return;\n    this.hideActive(groupName, popup);\n    this._popups.set(groupName, popup);\n  }\n\n  /** Get active element in group or undefined if group doesn't exist */\n  public getActive(groupName: string): ESLToggleable | undefined {\n    return this._popups.get(groupName);\n  }\n\n  /** Delete element from the group if passed element is currently active */\n  public deleteActive(groupName: string, popup: ESLToggleable) {\n    if (this.getActive(groupName) !== popup) return;\n    this._popups.delete(groupName);\n  }\n\n  /** Hide active element before e.target will be shown */\n  @bind\n  protected _onBeforeShow(e: CustomEvent) {\n    const target = EventUtils.source(e);\n    if (!this.isAcceptable(target)) return;\n    this.hideActive(target.groupName, target);\n  }\n\n  /** Update active element after a new element is shown */\n  @bind\n  protected _onShow(e: CustomEvent) {\n    const target = EventUtils.source(e);\n    if (!this.isAcceptable(target)) return;\n\n    this.setActive(target.groupName, target);\n  }\n\n  /** Update group state after active element is hidden */\n  @bind\n  protected _onHide(e: CustomEvent) {\n    const target = EventUtils.source(e);\n    if (!this.isAcceptable(target)) return;\n\n    this.deleteActive(target.groupName, target);\n  }\n\n  /** Update active elements */\n  @bind\n  protected _onChangeGroup(e: CustomEvent) {\n    const target = EventUtils.source(e);\n    if (!this.isAcceptable(target)) return;\n\n    const {oldGroupName, newGroupName} = e.detail;\n    this.deleteActive(oldGroupName, target);\n    this.setActive(newGroupName, target);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    ToggleableDispatcher: typeof ESLToggleableDispatcher;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-toggleable-dispatcher': ESLToggleableDispatcher;\n  }\n}\n","/**\n * Execute callback in bounds of the next task with dom ready state precondition\n */\nexport function onDocumentReady(callback: () => void) {\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', function fn() {\n      document.removeEventListener('DOMContentLoaded', fn);\n      setTimeout(() => callback());\n    });\n  } else {\n    setTimeout(() => callback());\n  }\n}\n","import {onDocumentReady} from '../dom/ready';\nimport type {AnyToVoidFnSignature} from '../misc/functions';\n\n/** Defer method execution to the next task with dom ready state precondition */\nexport function ready<T extends AnyToVoidFnSignature>(target: any,\n                                                      propertyKey: string,\n                                                      descriptor: TypedPropertyDescriptor<T>): void {\n  if (!descriptor || typeof descriptor.value !== 'function') {\n    throw new TypeError('Only class methods can be decorated via document ready decorator');\n  }\n  const fn = descriptor.value;\n  descriptor.value = function (...arg: any[]) {\n    onDocumentReady(() => fn.call(this, ...arg));\n  } as T;\n}\n","/** Property configuration */\nexport type OverrideDecoratorConfig = {\n  /** Value to set in the prototype */\n  value?: any;\n  /** To define mutable property */\n  readonly?: false;\n} | {\n  /** Value to set in the prototype */\n  value: any;\n  /** To define readonly property */\n  readonly: true;\n};\n\n/**\n * `@prop` is auxiliary decorator to define a field on the prototype level.\n *` @prop` can be used to override decorated property from the parent level\n *\n * You can also use an @override decorator in combination with ECMA Script class property definition:\n * `@prop() public field: any = initial value;`\n *\n * The class property initial value is a part of object creation, so it goes to the object itself,\n * while the @override value is defined on the prototype level.\n *\n * @param prototypeConfig - prototype property configuration\n */\nexport function prop(prototypeConfig: OverrideDecoratorConfig = {}) {\n  return function (obj: any, name: string): void {\n    if (Object.hasOwnProperty.call(obj, name)) {\n      throw new TypeError('Can\\'t override own property');\n    }\n    Object.defineProperty(obj, name, {\n      value: prototypeConfig.value,\n      writable: !prototypeConfig.readonly,\n      enumerable: true,\n      configurable: true\n    });\n  };\n}\n","/**\n * A Rect describes the size and position of a rectangle.\n * */\nexport class Rect {\n  /** The X coordinate of the Rect's origin (top-left corner of the rectangle). */\n  public x = 0;\n  /** The Y coordinate of the Rect's origin (top-left corner of the rectangle). */\n  public y = 0;\n  /** The width of the Rect. */\n  public width = 0;\n  /** The height of the Rect. */\n  public height = 0;\n\n  /**\n   * The static method creates a new Rect instance from a rect-like object.\n   * @param rect - rect-like object\n   * */\n  public static from(rect: {x?: number, left?: number, y?: number, top?: number, width?: number, height?: number} = {}): Rect {\n    return new this(rect.x || rect.left, rect.y || rect.top, rect.width, rect.height);\n  }\n\n  public constructor(x?: number, y?: number, width?: number, height?: number) {\n    this.x = x || 0;\n    this.y = y || 0;\n    this.width = width || 0;\n    this.height = height || 0;\n  }\n\n  /**\n   * Get the top coordinate value of the Rect (has the same value as y).\n   * */\n  public get top(): number {\n    return this.y;\n  }\n\n  /**\n   * Get the left coordinate value of the Rect (has the same value as x).\n   * */\n  public get left(): number {\n    return this.x;\n  }\n\n  /**\n   * Get the right coordinate value of the DOMRect.\n   * */\n  public get right(): number {\n    return this.x + this.width;\n  }\n\n  /**\n   * Get the bottom coordinate value of the Rect.\n   * */\n  public get bottom(): number {\n    return this.y + this.height;\n  }\n\n  /**\n   * Get the center X coordinate value of the Rect.\n   * */\n  public get cx(): number {\n    return this.x + this.width / 2;\n  }\n\n  /**\n   * Get the center Y coordinate value of the Rect.\n   * */\n  public get cy(): number {\n    return this.y + this.height / 2;\n  }\n\n  /**\n   * Grow the Rect by the specified increment in pixels.\n   * It increases the size of the Rect by moving each point on the edge of the Rect to a certain distance further away from the center of the Rect.\n   * @param increment - distance to grow in pixels\n   * */\n  public grow(increment: number): Rect {\n    this.y -= increment;\n    this.x -= increment;\n    this.height += 2 * increment;\n    this.width += 2 * increment;\n    return this;\n  }\n\n  /**\n   * Shrink the Rect by the specified decrement in pixels.\n   * It reduces the size of the Rect by moving each point on the edge of the Rect to a certain distance closer to the center of the Rect.\n   * @param decrement - distance to shrink in pixels\n   * */\n  public shrink(decrement: number): Rect {\n    return this.grow(-decrement);\n  }\n}\n","/**\n * Get the Element that is the root element of the document.\n * @param element - element for which to get the document element\n * */\nexport function getDocumentElement(element: Element | Window): Element {\n  return ((element instanceof Window\n    ? element.document\n    : element.ownerDocument) || window.document).documentElement;\n}\n\n/**\n * Get the name of node.\n * @param element - element for which to get the name\n */\nexport function getNodeName(element?: Node | Window): string {\n  return element && !(element instanceof Window) ? (element.nodeName).toLowerCase() : '';\n}\n\n/**\n * Get the parent of the specified element in the DOM tree.\n * @param element - element for which to get the parent\n */\nexport function getParentNode(element: Element | ShadowRoot): Node {\n  if (getNodeName(element) === 'html') {\n    return element;\n  }\n\n  return (window.ShadowRoot\n    ? element instanceof ShadowRoot\n      ? element.host\n      : element.assignedSlot || element.parentNode\n    : element.parentNode) || getDocumentElement(element as Element);\n}\n","import {getNodeName, getParentNode} from './element';\n\nexport type ScrollStrategy = 'none' | 'native' | 'pseudo';\n\nconst $html = document.documentElement;\nconst initiatorSet = new Set();\n\nexport abstract class ScrollUtils {\n  /** Check vertical scroll based on content height */\n  static hasVerticalScroll(target = $html) {\n    return target.scrollHeight > target.clientHeight;\n  }\n\n  /**\n   * Disable scroll on the page.\n   * @param strategy - to make scroll visually disabled\n   * */\n  public static lock(strategy?: ScrollStrategy) {\n    const hasScroll = ScrollUtils.hasVerticalScroll();\n    if (strategy && strategy !== 'none' && hasScroll) {\n      $html.classList.add(`esl-${strategy}-scroll`);\n    }\n    $html.classList.add('esl-disable-scroll');\n  }\n\n  /**\n   * Enable scroll on the page.\n   * */\n  public static unlock() {\n    $html.classList.remove('esl-disable-scroll', 'esl-pseudo-scroll', 'esl-native-scroll');\n  }\n\n  /**\n   * Disable scroll on the page.\n   * @param initiator - object to associate request with\n   * @param strategy - to make scroll visually disabled\n   *\n   * TODO: currently requests with different strategy is not taken into account\n   * */\n  public static requestLock(initiator: any, strategy?: ScrollStrategy) {\n    initiator && initiatorSet.add(initiator);\n    (initiatorSet.size > 0) && ScrollUtils.lock(strategy);\n  }\n\n  /**\n   * Enable scroll on the page in case it was requested with given initiator.\n   * @param initiator - object to associate request with\n   * @param strategy - to make scroll visually disabled\n   */\n  public static requestUnlock(initiator: any, strategy?: ScrollStrategy) {\n    initiator && initiatorSet.delete(initiator);\n    (initiatorSet.size === 0) && ScrollUtils.unlock();\n  }\n}\n\n/**\n * Get the list of all scroll parents, up the list of ancestors until we get to the top window object.\n * @param element - element for which you want to get the list of all scroll parents\n * @param list - array of elements to concatenate with the list of all scroll parents of element (optional)\n */\nexport function getListScrollParents(element: Node, list: Element[] = []): Element[] {\n  const scrollParent = getScrollParent(element);\n  const isBody = scrollParent === element.ownerDocument?.body;\n  const target = isBody\n    ? isScrollParent(scrollParent) ? scrollParent : []\n    : scrollParent;\n\n  const updatedList = list.concat(target);\n  return isBody\n    ? updatedList\n    : updatedList.concat(getListScrollParents(getParentNode(scrollParent)));\n}\n\n/**\n * Get the scroll parent of the specified element in the DOM tree.\n * @param node - element for which to get the scroll parent\n */\nexport function getScrollParent(node: Node): Element {\n  if (['html', 'body', '#document'].indexOf(getNodeName(node)) >= 0) {\n    return node.ownerDocument?.body as Element;\n  }\n\n  if (node instanceof HTMLElement && isScrollParent(node as Element)) {\n    return node as Element;\n  }\n\n  return getScrollParent(getParentNode(node as Element));\n}\n\n/**\n * Check that element is scroll parent.\n * @param element - element for checking\n * */\nexport function isScrollParent(element: Element): boolean {\n  // Firefox wants us to check `-x` and `-y` variations as well\n  const {overflow, overflowX, overflowY} = getComputedStyle(element);\n  return /auto|scroll|overlay|hidden/.test(overflow + overflowY + overflowX);\n}\n\n/**\n * This is a promise-based version of scrollIntoView().\n * Method scrolls the element's parent container such that the element on which\n * scrollIntoView() is called is visible to the user. The promise is resolved when\n * the element became visible to the user.\n * @param element - element to be made visible to the user\n * @param options - scrollIntoView options\n */\nexport function scrollIntoViewAsync(element: Element, options: ScrollIntoViewOptions): Promise<void> {\n  element.scrollIntoView(options);\n\n  return new Promise((resolve, reject) => {\n    const intersectionObserver = new IntersectionObserver((entries) => {\n      const [entry] = entries;\n\n      if (entry.isIntersecting) {\n        intersectionObserver.unobserve(element);\n        resolve();\n      }\n    });\n    intersectionObserver.observe(element);\n  });\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {attr, jsonAttr} from '../../esl-base-element/core';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {ready} from '../../esl-utils/decorators/ready';\nimport {prop} from '../../esl-utils/decorators/prop';\nimport {rafDecorator} from '../../esl-utils/async/raf';\nimport {ESLToggleable} from '../../esl-toggleable/core';\nimport {Rect} from '../../esl-utils/dom/rect';\nimport {getListScrollParents} from '../../esl-utils/dom/scroll';\nimport {getWindowRect} from '../../esl-utils/dom/window';\nimport {calcPopupPosition} from './esl-popup-position';\n\nimport type {ToggleableActionParams} from '../../esl-toggleable/core';\nimport type {PositionType, IntersectionRatioRect} from './esl-popup-position';\n\nconst INTERSECTION_LIMIT_FOR_ADJACENT_AXIS = 0.7;\n\nexport interface PopupActionParams extends ToggleableActionParams {\n  /** popup position relative to trigger */\n  position?: PositionType;\n  /** popup behavior if it does not fit in the window */\n  behavior?: string;\n  /** offset in pixels from trigger element */\n  offsetTrigger?: number;\n  /** offset in pixels from the edges of the window */\n  offsetWindow?: number;\n}\n\nexport interface ActivatorObserver {\n  unsubscribers?: (() => void)[];\n  observer?: IntersectionObserver;\n}\n\n@ExportNs('Popup')\nexport class ESLPopup extends ESLToggleable {\n  public static is = 'esl-popup';\n\n  public $arrow: HTMLElement | null;\n\n  protected _offsetTrigger: number;\n  protected _offsetWindow: number;\n  protected _deferredUpdatePosition = rafDecorator(() => this._updatePosition());\n  protected _activatorObserver: ActivatorObserver;\n  protected _intersectionRatio: IntersectionRatioRect = {};\n\n  @attr({defaultValue: 'top'}) public position: PositionType;\n  @attr({defaultValue: 'fit'}) public behavior: string;\n\n  /** Default params to merge into passed action params */\n  @jsonAttr<PopupActionParams>({defaultValue: {\n    offsetTrigger: 3,\n    offsetWindow: 15\n  }})\n  public defaultParams: PopupActionParams;\n\n  @prop() public closeOnEsc = true;\n  @prop() public closeOnOutsideAction = true;\n\n  @ready\n  public connectedCallback() {\n    super.connectedCallback();\n    this.$arrow = this.querySelector('span.esl-popup-arrow');\n  }\n\n  protected get _isPositioningAlongHorizontal() {\n    return ['left', 'right'].includes(this.position);\n  }\n\n  protected get _isPositioningAlongVertical() {\n    return ['top', 'bottom'].includes(this.position);\n  }\n\n  public onShow(params: PopupActionParams) {\n    super.onShow(params);\n\n    if (params.position) {\n      this.position = params.position;\n    }\n    if (params.behavior) {\n      this.behavior = params.behavior;\n    }\n    this._offsetTrigger = params.offsetTrigger || 0;\n    this._offsetWindow = params.offsetWindow || 0;\n\n    this.style.visibility = 'hidden'; // eliminates the blinking of the popup at the previous position\n    setTimeout(() => {\n      // running as a separate task solves the problem with incorrect positioning on the first showing\n      this._updatePosition();\n      this.style.visibility = 'visible';\n      this.activator && this._addActivatorObserver(this.activator);\n    });\n  }\n\n  public onHide(params: PopupActionParams) {\n    super.onHide(params);\n\n    this.activator && this._removeActivatorObserver(this.activator);\n  }\n\n  protected _checkIntersectionForAdjacentAxis(isAdjacentAxis: boolean, intersectionRatio: number) {\n    if (isAdjacentAxis && intersectionRatio < INTERSECTION_LIMIT_FOR_ADJACENT_AXIS) {\n      this.hide();\n    }\n  }\n\n  @bind\n  protected onActivatorIntersection(entries: IntersectionObserverEntry[], observer: IntersectionObserver) {\n    const entry = entries[0];\n    this._intersectionRatio = {};\n    if (!entry.isIntersecting) {\n      this.hide();\n      return;\n    }\n\n    if (entry.intersectionRect.y !== entry.boundingClientRect.y) {\n      this._intersectionRatio.top = entry.intersectionRect.height / entry.boundingClientRect.height;\n      this._checkIntersectionForAdjacentAxis(this._isPositioningAlongHorizontal, this._intersectionRatio.top);\n    }\n    if (entry.intersectionRect.bottom !== entry.boundingClientRect.bottom) {\n      this._intersectionRatio.bottom = entry.intersectionRect.height / entry.boundingClientRect.height;\n      this._checkIntersectionForAdjacentAxis(this._isPositioningAlongHorizontal, this._intersectionRatio.bottom);\n    }\n    if (entry.intersectionRect.x !== entry.boundingClientRect.x) {\n      this._intersectionRatio.left = entry.intersectionRect.width / entry.boundingClientRect.width;\n      this._checkIntersectionForAdjacentAxis(this._isPositioningAlongVertical, this._intersectionRatio.left);\n    }\n    if (entry.intersectionRect.right !== entry.boundingClientRect.right) {\n      this._intersectionRatio.right = entry.intersectionRect.width / entry.boundingClientRect.width;\n      this._checkIntersectionForAdjacentAxis(this._isPositioningAlongVertical, this._intersectionRatio.right);\n    }\n  }\n\n  @bind\n  protected onActivatorScroll(e: Event) {\n    this._updatePosition();\n  }\n\n  protected _addActivatorObserver(target: HTMLElement) {\n    const scrollParents = getListScrollParents(target);\n\n    const unsubscribers = scrollParents.map(($root) => {\n      const options = {passive: true} as EventListenerOptions;\n      $root.addEventListener('scroll', this.onActivatorScroll, options);\n      return () => {\n        $root && $root.removeEventListener('scroll', this.onActivatorScroll, options);\n      };\n    });\n\n    const options = {\n      rootMargin: '0px',\n      threshold: [...Array(9).keys()].map((x) => x / 8)\n    } as IntersectionObserverInit;\n\n    const observer = new IntersectionObserver(this.onActivatorIntersection, options);\n    observer.observe(target);\n\n    window.addEventListener('resize', this._deferredUpdatePosition);\n    window.addEventListener('scroll', this._deferredUpdatePosition);\n\n    this._activatorObserver = {\n      unsubscribers,\n      observer\n    };\n  }\n\n  protected _removeActivatorObserver(target: HTMLElement) {\n    window.removeEventListener('resize', this._deferredUpdatePosition);\n    window.removeEventListener('scroll', this._deferredUpdatePosition);\n    this._activatorObserver.observer?.disconnect();\n    this._activatorObserver.observer = undefined;\n    this._activatorObserver.unsubscribers?.forEach((cb) => cb());\n    this._activatorObserver.unsubscribers = [];\n  }\n\n  protected _updatePosition() {\n    if (!this.activator) return;\n\n    const triggerRect = this.activator.getBoundingClientRect();\n    const popupRect = this.getBoundingClientRect();\n    const arrowRect = this.$arrow ? this.$arrow.getBoundingClientRect() : new DOMRect();\n    const trigger = new Rect(triggerRect.left, triggerRect.top + window.pageYOffset, triggerRect.width, triggerRect.height);\n    const innerMargin = this._offsetTrigger + arrowRect.width / 2;\n\n    const config = {\n      position: this.position,\n      behavior: this.behavior,\n      intersectionRatio: this._intersectionRatio,\n      element: popupRect,\n      trigger,\n      inner: Rect.from(trigger).grow(innerMargin),\n      outer: getWindowRect().shrink(this._offsetWindow)\n    };\n\n    const {placedAt, popup, arrow} = calcPopupPosition(config);\n\n    this.setAttribute('placed-at', placedAt);\n    // set popup position\n    this.style.left = `${popup.x}px`;\n    this.style.top = `${popup.y}px`;\n    // set arrow position\n    if (this.$arrow) {\n      this.$arrow.style.left = ['top', 'bottom'].includes(placedAt) ? `${arrow.x}px` : 'none';\n      this.$arrow.style.top = ['left', 'right'].includes(placedAt) ? `${arrow.y}px` : 'none';\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Popup: typeof ESLPopup;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-popup': ESLPopup;\n  }\n}\n","import {Rect} from '../../esl-utils/dom/rect';\n\nexport type PositionType = 'top' | 'bottom' | 'left' | 'right';\n\nexport interface Point {\n  x: number;\n  y: number;\n}\n\nexport interface PopupPositionValue {\n  placedAt: PositionType;\n  popup: Rect;\n  arrow: Point;\n}\n\nexport interface IntersectionRatioRect {\n  top?: number;\n  left?: number;\n  right?: number;\n  bottom?: number;\n}\n\nexport interface PopupPositionConfig {\n  position: PositionType;\n  behavior: string;\n  intersectionRatio: IntersectionRatioRect;\n  element: DOMRect;\n  inner: Rect;\n  outer: Rect;\n  trigger: Rect;\n}\n\n/**\n * Calculate Rect for given popup position config.\n * @param cfg - popup position config\n * */\nfunction calcPopupBasicRect(cfg: PopupPositionConfig): Rect {\n  let x = cfg.inner.cx - cfg.element.width / 2;\n  let y = cfg.inner.y - cfg.element.height;\n  switch (cfg.position) {\n    case 'left':\n      x = cfg.inner.x - cfg.element.width;\n      y = cfg.inner.cy - cfg.element.height / 2;\n      break;\n    case 'right':\n      x = cfg.inner.right;\n      y = cfg.inner.cy - cfg.element.height / 2;\n      break;\n    case 'bottom':\n      x = cfg.inner.cx - cfg.element.width / 2;\n      y = cfg.inner.bottom;\n      break;\n  }\n\n  return new Rect(x, y, cfg.element.width, cfg.element.height);\n}\n\n/**\n * Get opposite position.\n * @param position - name of position\n * */\nfunction getOppositePosition(position: PositionType): PositionType {\n  return ({\n    top: 'bottom',\n    left: 'right',\n    right: 'left',\n    bottom: 'top'\n  }[position] || position) as PositionType;\n}\n\n/**\n * Update popup and arrow positions to fit by major axis.\n * @param cfg - popup position config\n * @param rect - popup position rect\n * @param arrow - arrow position value\n * */\nfunction fitByMajorAxis(cfg: PopupPositionConfig, rect: Rect, arrow: Point): PositionType {\n  if (cfg.behavior !== 'fit') return cfg.position;\n\n  let isMirrored = false;\n  switch (cfg.position) {\n    case 'bottom':\n      if (cfg.intersectionRatio.bottom || cfg.outer.bottom < rect.bottom) {\n        rect.y = cfg.inner.top - cfg.element.height;\n        isMirrored = true;\n      }\n      break;\n    case 'left':\n      if (cfg.intersectionRatio.left || rect.x < cfg.outer.x) {\n        rect.x = cfg.inner.right;\n        isMirrored = true;\n      }\n      break;\n    case 'right':\n      if (cfg.intersectionRatio.right || cfg.outer.right < rect.right) {\n        rect.x = cfg.inner.x - cfg.element.width;\n        isMirrored = true;\n      }\n      break;\n    default:\n      if (cfg.intersectionRatio.top || rect.y < cfg.outer.y) {\n        rect.y = cfg.inner.bottom;\n        isMirrored = true;\n      }\n      break;\n  }\n\n  return isMirrored ? getOppositePosition(cfg.position) : cfg.position;\n}\n\n/**\n * Update popup and arrow positions to fit by minor horizontal axis.\n * @param cfg - popup position config\n * @param rect - popup position rect\n * @param arrow - arrow position value\n * */\nfunction fitByMinorAxisHorizontal(cfg: PopupPositionConfig, rect: Rect, arrow: Point) {\n  if (cfg.trigger.x < cfg.outer.x || cfg.trigger.right > cfg.outer.right) return; // cancel fit mode if the element is out of window offset bounds\n\n  let arrowAdjust = 0;\n  if (rect.x < cfg.outer.x) {\n    arrowAdjust = rect.x - cfg.outer.x;\n    rect.x = cfg.outer.x;\n  }\n  if (rect.right > cfg.outer.right) {\n    arrowAdjust = rect.right - cfg.outer.right;\n    rect.x -= arrowAdjust;\n  }\n  arrow.x += arrowAdjust;\n}\n\n/**\n * Update popup and arrow positions to fit by minor vertical axis.\n * @param cfg - popup position config\n * @param rect - popup position rect\n * @param arrow - arrow position value\n * */\nfunction fitByMinorAxisVertical(cfg: PopupPositionConfig, rect: Rect, arrow: Point) {\n  if (cfg.trigger.y < cfg.outer.y || cfg.trigger.bottom > cfg.outer.bottom) return; // cancel fit mode if the element is out of window offset bounds\n\n  let arrowAdjust = 0;\n  if (rect.y < cfg.outer.y) {\n    arrowAdjust = rect.y - cfg.outer.y;\n    rect.y = cfg.outer.y;\n  }\n  if (rect.bottom > cfg.outer.bottom) {\n    arrowAdjust = rect.bottom - cfg.outer.bottom;\n    rect.y -= arrowAdjust;\n  }\n  arrow.y += arrowAdjust;\n}\n\n/**\n * Update popup and arrow positions to fit by minor axis.\n * @param cfg - popup position config\n * @param rect - popup position rect\n * @param arrow - arrow position value\n * */\nfunction fitByMinorAxis(cfg: PopupPositionConfig, rect: Rect, arrow: Point) {\n  if (cfg.behavior !== 'fit') return;\n\n  if (['left', 'right'].includes(cfg.position)) {\n    fitByMinorAxisVertical(cfg, rect, arrow);\n  } else {\n    fitByMinorAxisHorizontal(cfg, rect, arrow);\n  }\n}\n\n/**\n * Calculate popup and arrow popup positions.\n * @param cfg - popup position config\n * */\nexport function calcPopupPosition(cfg: PopupPositionConfig): PopupPositionValue {\n  const popup = calcPopupBasicRect(cfg);\n  const arrow = {\n    x: cfg.element.width / 2,\n    y: cfg.element.height / 2,\n    position: cfg.position\n  };\n\n  const placedAt = fitByMajorAxis(cfg, popup, arrow);\n  fitByMinorAxis(cfg, popup, arrow);\n\n  return {\n    popup,\n    placedAt,\n    arrow\n  };\n}\n","import {Rect} from './rect';\n\n/**\n * Get the window object associated with a document of the specified element.\n * @param node - element for which to get window\n * */\nexport function getWindow(node: Node | Window): Window {\n  if (node === null) return window;\n  if (node instanceof Window) return node;\n  const ownerDocument = node.ownerDocument;\n  return ownerDocument ? ownerDocument.defaultView || window : window;\n}\n\n/**\n * Get the bottom coordinate value of the window.\n * */\nexport function getWindowBottom(): number {\n  return window.pageYOffset + getWindowHeight();\n}\n\n/**\n * Get the left coordinate value of the window.\n * */\nexport function getWindowLeft(): number {\n  return window.pageXOffset;\n}\n\n/**\n * Get the right coordinate value of the window.\n * */\nexport function getWindowRight(): number {\n  return window.pageXOffset + getWindowWidth();\n}\n\n/**\n * Get the top coordinate value of the window.\n * */\nexport function getWindowTop(): number {\n  return window.pageYOffset;\n}\n\n/**\n * Get the width of the window.\n * */\nexport function getWindowHeight(): number {\n  return window.innerHeight || window.document.documentElement.clientHeight;\n}\n\n/**\n * Get the height of the window.\n * */\nexport function getWindowWidth(): number {\n  return window.innerWidth || window.document.documentElement.clientWidth;\n}\n\n/**\n * Get the size and position of the window.\n * @returns\n */\nexport function getWindowRect(): Rect {\n  return Rect.from({\n    x: getWindowLeft(),\n    y: getWindowTop(),\n    height: getWindowHeight(),\n    width: getWindowWidth()\n  });\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {afterNextRender} from '../../esl-utils/async/raf';\nimport {attr, boolAttr, jsonAttr} from '../../esl-base-element/core';\nimport {ESLToggleable} from '../../esl-toggleable/core';\nimport {ESLPanelGroup} from '../../esl-panel-group/core';\n\nimport type {ToggleableActionParams} from '../../esl-toggleable/core';\n\n/** {@link ESLPanel} action params interface */\nexport interface PanelActionParams extends ToggleableActionParams {\n  /** Prevents collapsing/expanding animation */\n  noCollapse?: boolean;\n}\n\n/**\n * ESLPanel component\n * @author Julia Murashko\n *\n * ESLPanel is a custom element that is used as a wrapper for content that can be shown or hidden.\n * Can use collapsing/expanding animation (smooth height change).\n * Can be used in conjunction with {@link ESLPanelGroup} to control a group of ESLPopups\n */\n@ExportNs('Panel')\nexport class ESLPanel extends ESLToggleable {\n  public static is = 'esl-panel';\n\n  /** Class(es) to be added for active state ('open' by default) */\n  @attr({defaultValue: 'open'}) public activeClass: string;\n  /** Class(es) to be added during animation ('animate' by default) */\n  @attr({defaultValue: 'animate'}) public animateClass: string;\n  /** Class(es) to be added during animation after next render ('post-animate' by default) */\n  @attr({defaultValue: 'post-animate'}) public postAnimateClass: string;\n  /** Time to clear animation common params (max-height style + classes) (1s by default) */\n  @attr({defaultValue: '1000'}) public fallbackDuration: number | 'auto';\n\n  /** Initial params for current ESLPanel instance */\n  @jsonAttr<PanelActionParams>({defaultValue: {force: true, initiator: 'init'}})\n  public initialParams: PanelActionParams;\n\n  /** Active while animation in progress */\n  @boolAttr({readonly: true}) public animating: boolean;\n\n  /** Inner height state that updates after show/hide actions but before show/hide events triggered */\n  protected _initialHeight: number = 0;\n  /** Inner timer to cleanup animation styles */\n  protected _fallbackTimer: number = 0;\n\n  /** @returns Previous active panel height at the start of the animation */\n  public get initialHeight() {\n    return this._initialHeight;\n  }\n\n  /** @returns Closest panel group or null if not presented */\n  public get $group(): ESLPanelGroup | null {\n    if (this.groupName === 'none' || this.groupName) return null;\n    return this.closest(ESLPanelGroup.is);\n  }\n\n  protected bindEvents() {\n    super.bindEvents();\n    this.addEventListener('transitionend', this._onTransitionEnd);\n  }\n\n  protected unbindEvents() {\n    super.unbindEvents();\n    this.removeEventListener('transitionend', this._onTransitionEnd);\n  }\n\n  /** Process show action */\n  protected onShow(params: PanelActionParams) {\n    super.onShow(params);\n    this._initialHeight = this.offsetHeight;\n\n    this.beforeAnimate();\n    if (params.noCollapse) {\n      afterNextRender(() => this.afterAnimate());\n    } else {\n      this.onAnimate('show');\n    }\n  }\n\n  /** Process hide action */\n  protected onHide(params: PanelActionParams) {\n    this._initialHeight = this.offsetHeight;\n    super.onHide(params);\n\n    this.beforeAnimate();\n    if (params.noCollapse) {\n      afterNextRender(() => this.afterAnimate());\n    } else {\n      this.onAnimate('hide');\n    }\n  }\n\n  /** Pre-processing animation action */\n  protected beforeAnimate() {\n    this.toggleAttribute('animating', true);\n    CSSClassUtils.add(this, this.animateClass);\n    this.postAnimateClass && afterNextRender(() => CSSClassUtils.add(this, this.postAnimateClass));\n  }\n\n  /** Process animation */\n  protected onAnimate(action: string) {\n    // set initial height\n    this.style.setProperty('max-height', `${action === 'hide' ? this._initialHeight : 0}px`);\n    // make sure that browser apply initial height for animation\n    afterNextRender(() => {\n      this.style.setProperty('max-height', `${action === 'hide' ? 0 : this._initialHeight}px`);\n      this.fallbackAnimate();\n    });\n  }\n\n  /** Post-processing animation action */\n  protected afterAnimate() {\n    this.clearAnimation();\n    this.$$fire(this.open ? 'after:show' : 'after:hide');\n  }\n\n  /** Clear animation properties */\n  protected clearAnimation() {\n    this.toggleAttribute('animating', false);\n    this.style.removeProperty('max-height');\n    CSSClassUtils.remove(this, this.animateClass);\n    CSSClassUtils.remove(this, this.postAnimateClass);\n  }\n\n  /** Init a fallback timer to call post-animate action */\n  protected fallbackAnimate() {\n    const time = +this.fallbackDuration;\n    if (isNaN(time) || time < 0) return;\n    if (this._fallbackTimer) clearTimeout(this._fallbackTimer);\n    this._fallbackTimer = window.setTimeout(() => this.afterAnimate(), time);\n  }\n\n  /** Catching CSS transition end event to start post-animate processing */\n  @bind\n  protected _onTransitionEnd(e?: TransitionEvent) {\n    if (!e || e.propertyName === 'max-height') {\n      this.afterAnimate();\n    }\n  }\n\n  /** Merge params that are used by panel group for actions */\n  protected mergeDefaultParams(params?: ToggleableActionParams): ToggleableActionParams {\n    const stackConfig = this.$group?.panelConfig || {};\n    return Object.assign({}, stackConfig, this.defaultParams, params || {});\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Panel: typeof ESLPanel;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-panel': ESLPanel;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {attr, ESLBaseElement} from '../../esl-base-element/core';\nimport {afterNextRender} from '../../esl-utils/async/raf';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {memoize} from '../../esl-utils/decorators/memoize';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {ESLMediaRuleList} from '../../esl-media-query/core';\nimport {TraversingQuery} from '../../esl-traversing-query/core';\nimport {ESLPanel} from '../../esl-panel/core';\n\nimport type {PanelActionParams} from '../../esl-panel/core';\n\n/**\n * ESLPanelGroup component\n * @author Julia Murashko\n *\n * ESLPanelGroup is a custom element that is used as a container for a group of {@link ESLPanel}s\n */\n@ExportNs('PanelGroup')\nexport class ESLPanelGroup extends ESLBaseElement {\n  public static is = 'esl-panel-group';\n  /** List of supported modes */\n  public static supportedModes = ['tabs', 'accordion', 'open'];\n\n  /** Rendering mode of the component (takes values from the list of supported modes; 'accordion' by default) */\n  @attr({defaultValue: 'accordion'}) public mode: string;\n  /** Element {@link TraversingQuery} selector to add class that identifies the rendering mode (ESLPanelGroup itself by default) */\n  @attr({defaultValue: ''}) public modeClsTarget: string;\n  /** Class(es) to be added during animation ('animate' by default) */\n  @attr({defaultValue: 'animate'}) public animationClass: string;\n  /** Time to clear animation common params (max-height style + classes) ('auto' by default) */\n  @attr({defaultValue: 'auto'}) public fallbackDuration: number | 'auto';\n  /** List of comma-separated \"modes\" to disable collapse/expand animation (for both Group and Panel animations) */\n  @attr() public noCollapse: string;\n\n  /** Height of previous active panel */\n  protected _previousHeight: number = 0;\n  /** Fallback setTimeout timer */\n  protected _fallbackTimer: number = 0;\n\n  static get observedAttributes() {\n    return ['mode'];\n  }\n\n  /** ESLMediaRuleList instance of the mode mapping */\n  @memoize()\n  public get modeRules() {\n    return ESLMediaRuleList.parse(this.mode);\n  }\n\n  /** @returns current mode */\n  public get currentMode(): string {\n    return this.modeRules.activeValue || '';\n  }\n\n  protected connectedCallback() {\n    super.connectedCallback();\n    this.bindEvents();\n\n    this.modeRules.addListener(this._onModeChange);\n    this.updateMode();\n  }\n\n  protected disconnectedCallback() {\n    super.disconnectedCallback();\n    this.modeRules.removeListener(this._onModeChange);\n\n    this.unbindEvents();\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string) {\n    if (!this.connected || oldVal === newVal) return;\n    if (attrName === 'mode') {\n      this.modeRules.removeListener(this._onModeChange);\n      memoize.clear(this, 'modeRules');\n      this.modeRules.addListener(this._onModeChange);\n      this.updateMode();\n    }\n  }\n\n  protected bindEvents() {\n    this.addEventListener('esl:before:show', this._onBeforeShow);\n    this.addEventListener('esl:show', this._onShow);\n    this.addEventListener('esl:before:hide', this._onBeforeHide);\n\n    this.addEventListener('transitionend', this._onTransitionEnd);\n  }\n\n  protected unbindEvents() {\n    this.removeEventListener('esl:before:show', this._onBeforeShow);\n    this.removeEventListener('esl:show', this._onShow);\n    this.removeEventListener('esl:before:hide', this._onBeforeHide);\n\n    this.removeEventListener('transitionend', this._onTransitionEnd);\n  }\n\n  /** Update element state according to current mode */\n  protected updateMode() {\n    this.setAttribute('view', this.currentMode);\n    const $target = TraversingQuery.first(this.modeClsTarget, this);\n    if (!$target) return;\n    ESLPanelGroup.supportedModes.forEach((mode) => {\n      $target.classList.toggle(`esl-${mode}-view`, this.currentMode === mode);\n    });\n\n    // TODO: refactor\n    ESLPanel.registered.then(() => {\n      this.$panels.forEach((panel) => {\n        const shouldOpen = this.currentMode === 'open' || panel.initiallyOpened;\n        panel.toggle(shouldOpen, {initiator: 'group', activator: this});\n      });\n    });\n  }\n\n  /** @returns Panels that are processed by the current panel group */\n  public get $panels(): ESLPanel[] {\n    const els = Array.from(this.querySelectorAll(ESLPanel.is));\n    return els.filter((el) => this.includesPanel(el)) as ESLPanel[];\n  }\n\n  /** @returns Panels that are active */\n  public get $activePanels() {\n    return this.$panels.filter((el: ESLPanel) => el.open);\n  }\n\n  /** @returns Whether the collapse/expand animation should be handheld by the group */\n  public get shouldCollapse() {\n    const noCollapseModes = this.noCollapse.split(',').map((mode) => mode.trim());\n    return !noCollapseModes.includes('all') && !noCollapseModes.includes(this.currentMode);\n  }\n\n  /** @returns Action params config that is used by controlled {@link ESLPanel}s */\n  public get panelConfig(): PanelActionParams {\n    return {\n      noCollapse: !this.shouldCollapse || (this.currentMode === 'tabs')\n    };\n  }\n\n  /** Condition-guard to check if the passed target is a Panel that should be controlled by the Group */\n  public includesPanel(target: any): target is ESLPanel {\n    if (!(target instanceof ESLPanel)) return false;\n    return target.$group === this;\n  }\n\n  /** Animate the height of the component */\n  protected onAnimate(from: number, to: number) {\n    const hasCurrent = this.style.height && this.style.height !== 'auto';\n    if (hasCurrent) {\n      this.style.height = `${to}px`;\n      this.fallbackAnimate();\n    } else {\n      // set initial height\n      this.style.height = `${from}px`;\n      // make sure that browser apply initial height to animate\n      afterNextRender(() => {\n        this.style.height = `${to}px`;\n        this.fallbackAnimate();\n      });\n    }\n  }\n\n  /** Pre-processing animation action */\n  protected beforeAnimate() {\n    CSSClassUtils.add(this, this.animationClass);\n  }\n\n  /** Post-processing animation action */\n  protected afterAnimate() {\n    this.style.removeProperty('height');\n    CSSClassUtils.remove(this, this.animationClass);\n  }\n\n  /** Init a fallback timer to call post-animate action */\n  protected fallbackAnimate() {\n    const time = +this.fallbackDuration;\n    if (isNaN(time) || time < 0) return;\n    if (this._fallbackTimer) clearTimeout(this._fallbackTimer);\n    this._fallbackTimer = window.setTimeout(() => this.afterAnimate(), time);\n  }\n\n  /** Process {@link ESLPanel} pre-show event */\n  @bind\n  protected _onBeforeShow(e: CustomEvent) {\n    const panel = e.target;\n    if (!this.includesPanel(panel)) return;\n    this.$activePanels.forEach((el) => (el !== panel) && el.hide());\n  }\n\n  /** Process {@link ESLPanel} show event */\n  @bind\n  protected _onShow(e: CustomEvent) {\n    const panel = e.target;\n    if (!this.includesPanel(panel)) return;\n    if (this.currentMode !== 'tabs') return;\n\n    this.beforeAnimate();\n    if (this.shouldCollapse) {\n      this.onAnimate(this._previousHeight, panel.initialHeight);\n    } else {\n      afterNextRender(() => this.afterAnimate());\n    }\n  }\n\n  /** Process {@link ESLPanel} pre-hide event */\n  @bind\n  protected _onBeforeHide(e: CustomEvent) {\n    // TODO: refactor\n    if (this.currentMode === 'open') {\n      e.preventDefault();\n      return;\n    }\n    const panel = e.target;\n    if (!this.includesPanel(panel)) return;\n    this._previousHeight = this.offsetHeight;\n  }\n\n  /** Catching CSS transition end event to start post-animate processing */\n  @bind\n  protected _onTransitionEnd(e?: TransitionEvent) {\n    if (!e || e.propertyName === 'height') {\n      this.afterAnimate();\n    }\n  }\n\n  /** Handles mode change */\n  @bind\n  protected _onModeChange() {\n    this.updateMode();\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    PanelGroup: typeof ESLPanelGroup;\n  }\n\n  export interface HTMLElementTagNameMap {\n    'esl-panel-group': ESLPanelGroup;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {attr, boolAttr, ESLBaseElement} from '../../esl-base-element/core';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {ready} from '../../esl-utils/decorators/ready';\nimport {parseNumber} from '../../esl-utils/misc/format';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {ENTER, SPACE} from '../../esl-utils/dom/keys';\nimport {TraversingQuery} from '../../esl-traversing-query/core';\nimport {DeviceDetector} from '../../esl-utils/environment/device-detector';\nimport {ESLMediaQuery} from '../../esl-media-query/core';\n\nimport type {ESLToggleable, ToggleableActionParams} from '../../esl-toggleable/core/esl-toggleable';\n\n@ExportNs('Trigger')\nexport class ESLTrigger extends ESLBaseElement {\n  public static is = 'esl-trigger';\n\n  static get observedAttributes() {\n    return ['target'];\n  }\n\n  /** @readonly Observed Toggleable active state marker */\n  @boolAttr({readonly: true}) public active: boolean;\n\n  /** CSS classes to set on active state */\n  @attr({defaultValue: ''}) public activeClass: string;\n  /** Target element {@link TraversingQuery} selector to set `activeClass` */\n  @attr({defaultValue: ''}) public activeClassTarget: string;\n\n  /** Selector for ignored inner elements */\n  @attr({defaultValue: 'a[href]'}) public ignore: string;\n\n  /** Target Toggleable {@link TraversingQuery} selector. `next` by default */\n  @attr({defaultValue: 'next'}) public target: string;\n  /** Action to pass to the Toggleable. Supports `show`, `hide` and `toggle` values. `toggle` by default */\n  @attr({defaultValue: 'toggle'}) public mode: string;\n\n  /** Click event tracking media query. Default: `all` */\n  @attr({defaultValue: 'all'}) public trackClick: string;\n  /** Hover event tracking media query. Default: `none` */\n  @attr({defaultValue: 'not all'}) public trackHover: string;\n\n  /** Selector of inner target element to place aria attributes. Uses trigger itself if blank */\n  @attr({defaultValue: ''}) public a11yTarget: string;\n\n  /** Show delay value */\n  @attr({defaultValue: 'none'}) public showDelay: string;\n  /** Hide delay value */\n  @attr({defaultValue: 'none'}) public hideDelay: string;\n  /** Show delay value override for hover */\n  @attr({defaultValue: 'none'}) public hoverShowDelay: string;\n  /** Hide delay value override for hover */\n  @attr({defaultValue: 'none'}) public hoverHideDelay: string;\n\n  protected _$target: ESLToggleable;\n\n  protected attributeChangedCallback(attrName: string) {\n    if (!this.connected) return;\n    if (attrName === 'target') return this.updateTargetFromSelector();\n  }\n\n  /** Target observable Toggleable */\n  public get $target() {\n    return this._$target;\n  }\n  public set $target(newPopupInstance) {\n    this.unbindEvents();\n    this._$target = newPopupInstance;\n    if (this._$target) {\n      this.bindEvents();\n      this._onTargetStateChange();\n    }\n  }\n\n  /** Element target to setup aria attributes */\n  public get $a11yTarget(): HTMLElement | null {\n    return this.a11yTarget ? this.querySelector(this.a11yTarget) : this;\n  }\n\n  /** Marker to allow track hover */\n  public get allowHover() {\n    return DeviceDetector.hasHover && ESLMediaQuery.for(this.trackHover).matches;\n  }\n  /** Marker to allow track clicks */\n  public get allowClick() {\n    return ESLMediaQuery.for(this.trackClick).matches;\n  }\n\n  @ready\n  protected connectedCallback() {\n    super.connectedCallback();\n    this.updateTargetFromSelector();\n    this.initA11y();\n  }\n  @ready\n  protected disconnectedCallback() {\n    this.unbindEvents();\n  }\n\n  protected bindEvents() {\n    if (!this.$target) return;\n    this.$target.addEventListener('esl:show', this._onTargetStateChange);\n    this.$target.addEventListener('esl:hide', this._onTargetStateChange);\n\n    this.addEventListener('click', this._onClick);\n    this.addEventListener('keydown', this._onKeydown);\n    this.addEventListener('mouseenter', this._onMouseEnter);\n    this.addEventListener('mouseleave', this._onMouseLeave);\n  }\n  protected unbindEvents() {\n    if (!this.$target) return;\n    this.$target.removeEventListener('esl:show', this._onTargetStateChange);\n    this.$target.removeEventListener('esl:hide', this._onTargetStateChange);\n\n    this.removeEventListener('click', this._onClick);\n    this.removeEventListener('keydown', this._onKeydown);\n    this.removeEventListener('mouseenter', this._onMouseEnter);\n    this.removeEventListener('mouseleave', this._onMouseLeave);\n  }\n\n  /** Update `$target` Toggleable  from `target` selector */\n  protected updateTargetFromSelector() {\n    if (!this.target) return;\n    this.$target = TraversingQuery.first(this.target, this) as ESLToggleable;\n  }\n\n  /** Check if the event target should be ignored */\n  protected isTargetIgnored(target: EventTarget | null) {\n    if (!target || !(target instanceof HTMLElement) || !this.ignore) return false;\n    const $ignore = target.closest(this.ignore);\n    // Ignore only inner elements (but do not ignore the trigger itself)\n    return !!$ignore && $ignore !== this && this.contains($ignore);\n  }\n\n  /** Merge params to pass to the toggleable */\n  protected mergeToggleableParams(this: ESLTrigger, ...params: ToggleableActionParams[]) {\n    return Object.assign({\n      initiator: 'trigger',\n      activator: this\n    }, ...params);\n  }\n\n  /** Show target toggleable with passed params */\n  public showTarget(params: ToggleableActionParams = {}) {\n    const actionParams = this.mergeToggleableParams({\n      delay: parseNumber(this.showDelay)\n    }, params);\n    this.$target && this.$target.show(actionParams);\n  }\n  /** Hide target toggleable with passed params */\n  public hideTarget(params: ToggleableActionParams = {}) {\n    const actionParams = this.mergeToggleableParams({\n      delay: parseNumber(this.hideDelay)\n    }, params);\n    this.$target && this.$target.hide(actionParams);\n  }\n  /** Toggles target toggleable with passed params */\n  public toggleTarget(params: ToggleableActionParams = {}, state: boolean = !this.active) {\n    state ? this.showTarget(params) : this.hideTarget(params);\n  }\n\n  /** Handles ESLToggleable state change */\n  @bind\n  protected _onTargetStateChange() {\n    this.toggleAttribute('active', this.$target.open);\n\n    const clsTarget = TraversingQuery.first(this.activeClassTarget, this) as HTMLElement;\n    clsTarget && CSSClassUtils.toggle(clsTarget, this.activeClass, this.active);\n\n    this.updateA11y();\n\n    this.$$fire('change:active');\n  }\n\n  /** Handles `click` event */\n  @bind\n  protected _onClick(event: MouseEvent) {\n    if (!this.allowClick || this.isTargetIgnored(event.target)) return;\n    event.preventDefault();\n    switch (this.mode) {\n      case 'show':\n        return this.showTarget({event});\n      case 'hide':\n        return this.hideTarget({event});\n      default:\n        return this.toggleTarget({event});\n    }\n  }\n\n  /** Handles `keydown` event */\n  @bind\n  protected _onKeydown(event: KeyboardEvent) {\n    if (![ENTER, SPACE].includes(event.key) || this.isTargetIgnored(event.target)) return;\n    event.preventDefault();\n    switch (this.mode) {\n      case 'show':\n        return this.showTarget({event});\n      case 'hide':\n        return this.hideTarget({event});\n      default:\n        return this.toggleTarget({event});\n    }\n  }\n\n  /** Handles hover `mouseenter` event */\n  @bind\n  protected _onMouseEnter(event: MouseEvent) {\n    if (!this.allowHover) return;\n    const delay = parseNumber(this.hoverShowDelay);\n    this.toggleTarget({event, delay}, this.mode !== 'hide');\n    event.preventDefault();\n  }\n\n  /** Handles hover `mouseleave` event */\n  @bind\n  protected _onMouseLeave(event: MouseEvent) {\n    if (!this.allowHover) return;\n    if (this.mode === 'show' || this.mode === 'hide') return;\n    const delay = parseNumber(this.hoverHideDelay);\n    this.hideTarget({event, delay, trackHover: true});\n    event.preventDefault();\n  }\n\n  /** Set initial a11y attributes. Do nothing if trigger contains actionable element */\n  public initA11y() {\n    if (this.$a11yTarget !== this) return;\n    if (!this.hasAttribute('role')) this.setAttribute('role', 'button');\n    if (this.getAttribute('role') === 'button' && !this.hasAttribute('tabindex')) {\n      this.setAttribute('tabindex', '0');\n    }\n  }\n\n  /** Update aria attributes */\n  public updateA11y() {\n    const target = this.$a11yTarget;\n    if (!target) return;\n\n    target.setAttribute('aria-expanded', String(this.active));\n    if (this.$target.id) {\n      target.setAttribute('aria-controls', this.$target.id);\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Trigger: typeof ESLTrigger;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-trigger': ESLTrigger;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLTrigger} from '../../esl-trigger/core';\nimport {attr} from '../../esl-base-element/decorators/attr';\n\n/**\n * ESlTab component\n * @author Julia Murashko\n *\n * Tab trigger item, usually used in conjunction with a {@link ESLTabs}.\n * Can control any {@link ESLToggleable} instance but is usually used in conjunction with {@link ESLPanel}\n */\n@ExportNs('Tab')\nexport class ESLTab extends ESLTrigger {\n  public static is = 'esl-tab';\n\n  @attr({defaultValue: 'show'}) public mode: string;\n  @attr({defaultValue: 'active'}) public activeClass: string;\n\n  public initA11y() {\n    const target = this.$a11yTarget;\n    if (!target) return;\n    if (target.hasAttribute('role')) return;\n    target.setAttribute('role', 'tab');\n  }\n\n  public updateA11y() {\n    const target = this.$a11yTarget;\n    if (!target) return;\n    target.setAttribute('aria-selected', String(this.active));\n    target.setAttribute('tabindex', this.active ? '0' : '-1');\n\n    // TODO: auto generate\n    if (this.$target.id) {\n      this.setAttribute('aria-controls', this.$target.id);\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Tab: typeof ESLTab;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-tab': ESLTab;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement, attr, boolAttr} from '../../esl-base-element/core';\nimport {TraversingQuery} from '../../esl-traversing-query/core';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {ARROW_DOWN, ARROW_LEFT, ARROW_RIGHT, ARROW_UP} from '../../esl-utils/dom/keys';\n\n/** Relative targeting type definition */\nexport type GroupTarget = 'next' | 'prev' | 'current';\n\n/**\n * ESLA11yGroup component\n * @author Julia Murashko\n *\n * ESLA11yGroup - helper custom element that adds a11y group behavior to targets.\n */\n@ExportNs('A11yGroup')\nexport class ESLA11yGroup extends ESLBaseElement {\n  public static is = 'esl-a11y-group';\n\n  /** Target elements multiple selector ({@link TraversingQuery} syntax) */\n  @attr({defaultValue: '::child'}) public targets: string;\n  /** Activate target (via click event) on selection */\n  @boolAttr({}) public activateSelected: boolean;\n\n  /** @returns HTMLElement root element of the group */\n  public get $root(): HTMLElement | null {\n    return this.parentElement;\n  }\n  /** @returns HTMLElement[] targets of the group */\n  public get $targets(): HTMLElement[] {\n    if (!this.$root) return [];\n    return TraversingQuery.all(this.targets, this.$root) as HTMLElement[];\n  }\n\n  protected connectedCallback() {\n    super.connectedCallback();\n    this.bindEvents();\n  }\n  protected disconnectedCallback() {\n    super.disconnectedCallback();\n    this.unbindEvents();\n  }\n\n  protected bindEvents() {\n    this.$root?.addEventListener('keydown', this._onKeydown);\n  }\n  protected unbindEvents() {\n    this.$root?.removeEventListener('keydown', this._onKeydown);\n  }\n\n  @bind\n  protected _onKeydown(e: KeyboardEvent) {\n    const target = e.target as HTMLElement;\n\n    if (!this.$targets.includes(target)) return;\n\n    if ([ARROW_UP, ARROW_LEFT].includes(e.key)) {\n      this.goTo('prev', target);\n      e.preventDefault();\n    }\n\n    if ([ARROW_DOWN, ARROW_RIGHT].includes(e.key)) {\n      this.goTo('next', target);\n      e.preventDefault();\n    }\n  }\n\n  /** Go to the target from the passed element or currently focused target by default */\n  public goTo(target: GroupTarget, from: HTMLElement | null = this.current()) {\n    if (!from) return;\n    const targetEl = this[target](from);\n    if (!targetEl) return;\n    targetEl.focus();\n    this.activateSelected && targetEl.click();\n  }\n\n  /** @returns HTMLElement next target fot trigger */\n  public next(trigger: HTMLElement) {\n    const triggers = this.$targets;\n    const index = triggers.indexOf(trigger);\n    return triggers[(index + 1) % triggers.length];\n  }\n\n  /** @returns HTMLElement previous target fot trigger */\n  public prev(trigger: HTMLElement): HTMLElement | undefined {\n    const triggers = this.$targets;\n    const index = triggers.indexOf(trigger);\n    return triggers[(index - 1 + triggers.length) % triggers.length];\n  }\n\n  /** @returns HTMLElement currently focused element from targets */\n  public current(): HTMLElement | null {\n    const $active = document.activeElement as HTMLElement;\n    return this.$targets.includes($active) ? $active : null;\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    A11yGroup: typeof ESLA11yGroup;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-a11y-group': ESLA11yGroup;\n  }\n}\n","import {ExportNs} from '../environment/export-ns';\nimport {memoize} from '../decorators/memoize';\n\nexport type ScrollType = 'default' | 'negative' | 'reverse';\n\n@ExportNs('RTLUtils')\nexport abstract class RTLUtils {\n  /** Check if the element in a RTL direction context */\n  static isRtl(el: HTMLElement = document.body) {\n    return getComputedStyle(el).direction === 'rtl';\n  }\n\n  /**\n   * @returns RTL scroll type (lazy, memoized)\n   */\n  @memoize()\n  static get scrollType(): ScrollType {\n    let scrollType: ScrollType = 'default';\n    const el = createDummyEl();\n    document.body.appendChild(el);\n    if (el.scrollLeft <= 0) {\n      el.scrollLeft = 2;\n      scrollType = el.scrollLeft < 2 ? 'negative' : 'reverse';\n    }\n    document.body.removeChild(el);\n    return scrollType;\n  }\n\n  static normalizeScrollLeft(el: HTMLElement, value: number | null = null, isRtl: boolean = RTLUtils.isRtl(el)): number {\n    value = (value === null) ? el.scrollLeft : value;\n    switch (isRtl ? RTLUtils.scrollType : '') {\n      case 'negative':\n        return el.scrollWidth - el.clientWidth + value;\n      case 'reverse':\n        return el.scrollWidth - el.clientWidth - value;\n      default:\n        return value;\n    }\n  }\n}\n\n/** Creates the dummy test element with a horizontal scroll presented */\nfunction createDummyEl() {\n  const el = document.createElement('div');\n  el.appendChild(document.createTextNode('ESL!'));\n  el.dir = 'rtl';\n  Object.assign(el.style, {\n    position: 'absolute',\n    top: '-1000px',\n    width: '4px',\n    height: '1px',\n    fontSize: '14px',\n    overflow: 'scroll'\n  });\n  return el;\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement, attr} from '../../esl-base-element/core';\nimport {rafDecorator} from '../../esl-utils/async/raf';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {memoize} from '../../esl-utils/decorators/memoize';\nimport {RTLUtils} from '../../esl-utils/dom/rtl';\nimport {debounce} from '../../esl-utils/async/debounce';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {ESLMediaRuleList} from '../../esl-media-query/core/esl-media-rule-list';\nimport {ESLTab} from './esl-tab';\n\n/**\n * ESlTabs component\n * @author Julia Murashko\n *\n * Tabs container component for Tabs trigger group.\n * Uses {@link ESLTab} as an item.\n * Each individual {@link ESLTab} can control {@link ESLToggleable} or, usually, {@link ESLPanel}\n */\n@ExportNs('Tabs')\nexport class ESLTabs extends ESLBaseElement {\n  public static is = 'esl-tabs';\n\n  /** List of supported scrollable types */\n  public static supportedScrollableTypes = ['disabled', 'side', 'center'];\n\n  /**\n   * Scrollable mode.\n   * Supported types for different breakpoints ('disabled' by default):\n   * - 'disabled' or not defined -  scroll behavior is disabled;\n   * - 'center' - scroll behavior is enabled, tab is center-aligned;\n   * - 'side' - scroll behavior is enabled, tab is side-aligned;\n   * - empty or unsupported value - scroll behavior is enabled, tab is side-aligned;\n   */\n  @attr({defaultValue: 'disabled'}) public scrollable: string;\n\n  /** Inner element to contain {@link ESLTab} collection. Will be scrolled in a scrollable mode */\n  @attr({defaultValue: '.esl-tab-container'}) public scrollableTarget: string;\n\n  protected _deferredUpdateArrows = debounce(this.updateArrows.bind(this), 100);\n  protected _deferredFitToViewport = debounce(this.fitToViewport.bind(this), 100);\n\n  static get observedAttributes() {\n    return ['scrollable'];\n  }\n\n  /** ESLMediaRuleList instance of the scrollable type mapping */\n  @memoize()\n  public get scrollableTypeRules() {\n    return ESLMediaRuleList.parse(this.scrollable);\n  }\n\n  /** @returns current scrollable type */\n  public get currentScrollableType(): string {\n    return this.scrollableTypeRules.activeValue || '';\n  }\n\n  protected connectedCallback() {\n    super.connectedCallback();\n    this.scrollableTypeRules.addListener(this._onScrollableTypeChange);\n    this.updateScrollableType();\n  }\n\n  protected disconnectedCallback() {\n    super.disconnectedCallback();\n    this.scrollableTypeRules.removeListener(this._onScrollableTypeChange);\n    this.unbindScrollableEvents();\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string) {\n    if (!this.connected || oldVal === newVal) return;\n    if (attrName === 'scrollable') {\n      this.scrollableTypeRules.removeListener(this._onScrollableTypeChange);\n      memoize.clear(this, 'scrollableTypeRules');\n      this.scrollableTypeRules.addListener(this._onScrollableTypeChange);\n      this.updateScrollableType();\n    }\n  }\n\n  protected bindScrollableEvents() {\n    this.addEventListener('esl:change:active', this._onTriggerStateChange);\n    this.addEventListener('click', this._onClick, false);\n    this.addEventListener('focusin', this._onFocus);\n    this.$scrollableTarget?.addEventListener('scroll', this._onScroll, {passive: true});\n\n    window.addEventListener('resize', this._onResize);\n  }\n  protected unbindScrollableEvents() {\n    this.removeEventListener('esl:change:active', this._onTriggerStateChange);\n    this.removeEventListener('click', this._onClick, false);\n    this.removeEventListener('focusin', this._onFocus);\n    this.$scrollableTarget?.removeEventListener('scroll', this._onScroll);\n\n    window.removeEventListener('resize', this._onResize);\n  }\n\n  /** Collection of inner {@link ESLTab} items */\n  public get $tabs(): ESLTab[] {\n    const els = this.querySelectorAll(ESLTab.is);\n    return els ? Array.from(els) as ESLTab[] : [];\n  }\n\n  /** Active {@link ESLTab} item */\n  public get $current(): ESLTab | null {\n    return this.$tabs.find((el) => el.active) || null;\n  }\n\n  /** Container element to scroll */\n  public get $scrollableTarget(): HTMLElement | null {\n    return this.querySelector(this.scrollableTarget);\n  }\n\n  /** Is the scrollable mode enabled ? */\n  public get isScrollable(): boolean {\n    return this.currentScrollableType !== 'disabled';\n  }\n\n  /** Move scroll to the next/previous item */\n  public moveTo(direction: string, behavior: ScrollBehavior = 'smooth') {\n    const $scrollableTarget = this.$scrollableTarget;\n    if (!$scrollableTarget) return;\n    let left = $scrollableTarget.offsetWidth;\n    left = RTLUtils.isRtl(this) && RTLUtils.scrollType !== 'reverse' ? -left : left;\n    left = direction === 'left' ? -left : left;\n\n    $scrollableTarget.scrollBy({left, behavior});\n  }\n\n  /** Scroll tab to the view */\n  protected fitToViewport($trigger: ESLTab, behavior: ScrollBehavior = 'smooth'): void {\n    this.updateMarkers();\n\n    const $scrollableTarget = this.$scrollableTarget;\n    if (!$scrollableTarget || !$trigger) return;\n\n    const areaRect = $scrollableTarget.getBoundingClientRect();\n    const itemRect = $trigger.getBoundingClientRect();\n\n    $scrollableTarget.scrollBy({\n      left: this.calcScrollOffset(itemRect, areaRect),\n      behavior\n    });\n\n    this.updateArrows();\n  }\n\n  /** Get scroll offset position from the selected item rectangle */\n  protected calcScrollOffset(itemRect: DOMRect, areaRect: DOMRect) {\n    const isReversedRTL = RTLUtils.isRtl(this) && RTLUtils.scrollType === 'reverse';\n\n    if (this.currentScrollableType === 'center') {\n      const shift = itemRect.left + itemRect.width / 2 - (areaRect.left + areaRect.width / 2);\n      return isReversedRTL ? -shift : shift;\n    }\n\n    // item is out of area from the right side\n    // else item out is of area from the left side\n    if (itemRect.right > areaRect.right) {\n      return isReversedRTL ? Math.floor(areaRect.right - itemRect.right) : Math.ceil(itemRect.right - areaRect.right);\n    } else if (itemRect.left < areaRect.left) {\n      return isReversedRTL ? Math.ceil(areaRect.left - itemRect.left) : Math.floor(itemRect.left - areaRect.left);\n    }\n  }\n\n  protected updateArrows() {\n    const $scrollableTarget = this.$scrollableTarget;\n    if (!$scrollableTarget) return;\n\n    const swapSides = RTLUtils.isRtl(this) && RTLUtils.scrollType === 'default';\n    const scrollStart = Math.abs($scrollableTarget.scrollLeft) > 1;\n    const scrollEnd = Math.abs($scrollableTarget.scrollLeft) + $scrollableTarget.clientWidth + 1 < $scrollableTarget.scrollWidth;\n\n    const $rightArrow = this.querySelector('[data-tab-direction=\"right\"]');\n    const $leftArrow = this.querySelector('[data-tab-direction=\"left\"]');\n\n    $leftArrow && $leftArrow.toggleAttribute('disabled', !(swapSides ? scrollEnd : scrollStart));\n    $rightArrow && $rightArrow.toggleAttribute('disabled', !(swapSides ? scrollStart : scrollEnd));\n  }\n\n  protected updateMarkers() {\n    const $scrollableTarget = this.$scrollableTarget;\n    if (!$scrollableTarget) return;\n\n    const hasScroll = this.isScrollable && ($scrollableTarget.scrollWidth > this.clientWidth);\n    this.toggleAttribute('has-scroll', hasScroll);\n  }\n\n  /** Update element state according to scrollable type */\n  protected updateScrollableType() {\n    ESLTabs.supportedScrollableTypes.forEach((type) => {\n      CSSClassUtils.toggle(this, `${type}-alignment`, this.currentScrollableType === type);\n    });\n\n    this.$current && this._deferredFitToViewport(this.$current);\n\n    if (this.currentScrollableType === 'disabled') {\n      this.unbindScrollableEvents();\n    } else {\n      this.bindScrollableEvents();\n    }\n  }\n\n  @bind\n  protected _onTriggerStateChange() {\n    this._deferredFitToViewport(this.$current);\n  }\n\n  @bind\n  protected _onClick(event: Event) {\n    const eventTarget: HTMLElement = event.target as HTMLElement;\n    const target: HTMLElement | null = eventTarget.closest('[data-tab-direction]');\n    const direction = target && target.dataset.tabDirection;\n\n    if (!direction) return;\n    this.moveTo(direction);\n  }\n\n  @bind\n  protected _onFocus(e: FocusEvent) {\n    const target = e.target;\n    if (target instanceof ESLTab) this._deferredFitToViewport(target);\n  }\n\n  @bind\n  protected _onScroll() {\n    this._deferredUpdateArrows();\n  }\n\n  // TODO: is the raf decorator needed?\n  protected _onResize = rafDecorator(() => {\n    this._deferredFitToViewport(this.$current, 'auto');\n  });\n\n  /** Handles scrollable type change */\n  @bind\n  protected _onScrollableTypeChange() {\n    this.updateScrollableType();\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Tabs: typeof ESLTabs;\n  }\n\n  export interface HTMLElementTagNameMap {\n    'esl-tabs': ESLTabs;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement, attr, boolAttr} from '../../esl-base-element/core';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {ready} from '../../esl-utils/decorators/ready';\nimport {rafDecorator} from '../../esl-utils/async/raf';\nimport {EventUtils} from '../../esl-utils/dom/events';\nimport {TraversingUtils} from '../../esl-utils/dom/traversing';\nimport {TraversingQuery} from '../../esl-traversing-query/core';\nimport {RTLUtils} from '../../esl-utils/dom/rtl';\n\n/**\n * ESL Scrollbar component\n * @author Yuliya Adamskaya\n */\n@ExportNs('Scrollbar')\nexport class ESLScrollbar extends ESLBaseElement {\n  public static is = 'esl-scrollbar';\n\n  /** Horizontal scroll orientation marker */\n  @boolAttr() public horizontal: boolean;\n\n  /** Target element {@link TraversingQuery} selector. Parent element by default */\n  @attr({defaultValue: '::parent'}) public target: string;\n  /** Custom class for thumb element. 'scrollbar-thumb' by default */\n  @attr({defaultValue: 'scrollbar-thumb'}) public thumbClass: string;\n  /** Custom class for track element area. 'scrollbar-track' by default */\n  @attr({defaultValue: 'scrollbar-track'}) public trackClass: string;\n\n  /** @readonly Dragging state marker */\n  @boolAttr({readonly: true}) public dragging: boolean;\n  /** @readonly Inactive state marker */\n  @boolAttr({readonly: true}) public inactive: boolean;\n\n  protected $scrollbarThumb: HTMLElement;\n  protected $scrollbarTrack: HTMLElement;\n\n  protected _$target: HTMLElement | null;\n  protected _initialPosition: number;\n  protected _initialMousePosition: number;\n\n  protected deferredRefresh = rafDecorator(() => this.refresh());\n  protected _resizeObserver = new ResizeObserver(this.deferredRefresh);\n  protected _mutationObserver = new MutationObserver((rec) => this.updateContentObserve(rec));\n\n  static get observedAttributes() {\n    return ['target', 'horizontal'];\n  }\n\n  @ready\n  protected connectedCallback() {\n    super.connectedCallback();\n    this.findTarget();\n    this.render();\n    this.bindEvents();\n  }\n\n  @ready\n  protected disconnectedCallback() {\n    this.unbindEvents();\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string) {\n    if (!this.connected && oldVal === newVal) return;\n    if (attrName === 'target') this.findTarget();\n    if (attrName === 'horizontal') this.refresh();\n  }\n\n  protected findTarget() {\n    this.$target = this.target ?\n      TraversingQuery.first(this.target, this) as HTMLElement :\n      null;\n  }\n\n  /** Target element to observe and scroll */\n  public get $target() {\n    return this._$target || null;\n  }\n\n  public set $target(content: HTMLElement | null) {\n    this.unbindTargetEvents();\n    this._$target = content;\n    this.bindTargetEvents();\n    this.deferredRefresh();\n  }\n\n  protected render() {\n    this.innerHTML = '';\n    this.$scrollbarTrack = document.createElement('div');\n    this.$scrollbarTrack.className = this.trackClass;\n    this.$scrollbarThumb = document.createElement('div');\n    this.$scrollbarThumb.className = this.thumbClass;\n\n    this.$scrollbarTrack.appendChild(this.$scrollbarThumb);\n    this.appendChild(this.$scrollbarTrack);\n  }\n\n  protected bindEvents() {\n    this.addEventListener('click', this._onClick);\n    this.$scrollbarThumb.addEventListener('mousedown', this._onMouseDown);\n    window.addEventListener('esl:refresh', this._onRefresh);\n  }\n\n  protected bindTargetEvents() {\n    if (!this.$target) return;\n    if (document.documentElement === this.$target) {\n      window.addEventListener('resize', this._onRefresh, {passive: true});\n      window.addEventListener('scroll', this._onRefresh, {passive: true});\n    } else {\n      this._resizeObserver.observe(this.$target);\n      this._mutationObserver.observe(this.$target, {childList: true});\n      Array.from(this.$target.children).forEach((el) => this._resizeObserver.observe(el));\n      this.$target.addEventListener('scroll', this._onRefresh, {passive: true});\n    }\n  }\n\n  protected updateContentObserve(recs: MutationRecord[] = []) {\n    if (!this.$target) return;\n    const contentChanges = recs.filter((rec) => rec.type === 'childList');\n    contentChanges.forEach((rec) => {\n      Array.from(rec.addedNodes)\n        .filter((el) => el instanceof Element)\n        .forEach((el: Element) => this._resizeObserver.observe(el));\n      Array.from(rec.removedNodes)\n        .filter((el) => el instanceof Element)\n        .forEach((el: Element) => this._resizeObserver.unobserve(el));\n    });\n    if (contentChanges.length) this.deferredRefresh();\n  }\n\n  protected unbindEvents() {\n    this.removeEventListener('click', this._onClick);\n    this.$scrollbarThumb.removeEventListener('mousedown', this._onMouseDown);\n    this.unbindTargetEvents();\n    window.removeEventListener('esl:refresh', this._onRefresh);\n  }\n\n  protected unbindTargetEvents() {\n    if (!this.$target) return;\n    if (document.documentElement === this.$target) {\n      window.removeEventListener('resize', this._onRefresh);\n      window.removeEventListener('scroll', this._onRefresh);\n    } else {\n      this._resizeObserver.disconnect();\n      this._mutationObserver.disconnect();\n      this.$target.removeEventListener('scroll', this._onRefresh);\n    }\n  }\n\n  /** @readonly Scrollable distance size value (px) */\n  public get scrollableSize() {\n    if (!this.$target) return 0;\n    return this.horizontal ?\n      this.$target.scrollWidth - this.$target.clientWidth :\n      this.$target.scrollHeight - this.$target.clientHeight;\n  }\n\n  /** @readonly Track size value (px) */\n  public get trackOffset() {\n    return this.horizontal ? this.$scrollbarTrack.offsetWidth : this.$scrollbarTrack.offsetHeight;\n  }\n\n  /** @readonly Thumb size value (px) */\n  public get thumbOffset() {\n    return this.horizontal ? this.$scrollbarThumb.offsetWidth : this.$scrollbarThumb.offsetHeight;\n  }\n\n  /** @readonly Relative thumb size value (between 0.0 and 1.0) */\n  public get thumbSize() {\n    // behave as native scroll\n    if (!this.$target || !this.$target.scrollWidth || !this.$target.scrollHeight) return 1;\n    const areaSize = this.horizontal ? this.$target.clientWidth : this.$target.clientHeight;\n    const scrollSize = this.horizontal ? this.$target.scrollWidth : this.$target.scrollHeight;\n    return Math.min((areaSize + 1) / scrollSize, 1);\n  }\n\n  /** Relative position value (between 0.0 and 1.0) */\n  public get position() {\n    if (!this.$target) return 0;\n    const scrollOffset = this.horizontal ? RTLUtils.normalizeScrollLeft(this.$target) : this.$target.scrollTop;\n    return this.scrollableSize ? (scrollOffset / this.scrollableSize) : 0;\n  }\n\n  public set position(position) {\n    this.scrollTargetTo(this.scrollableSize * this.normalizePosition(position));\n    this.update();\n  }\n\n  /** Normalize position value (between 0.0 and 1.0) */\n  protected normalizePosition(position: number) {\n    const relativePosition = Math.min(1, Math.max(0, position));\n    if (this.$target && !RTLUtils.isRtl(this.$target)) return relativePosition;\n    return RTLUtils.scrollType === 'negative' ? (relativePosition - 1) : (1 - relativePosition);\n  }\n\n  /** Scroll target element to passed position */\n  protected scrollTargetTo(pos: number) {\n    if (!this.$target) return;\n    this.$target.scrollTo({\n      [this.horizontal ? 'left' : 'top']: pos,\n      behavior: this.dragging ? 'auto' : 'smooth'\n    });\n  }\n\n  /** Update thumb size and position */\n  public update() {\n    if (!this.$scrollbarThumb || !this.$scrollbarTrack) return;\n    const thumbSize = this.trackOffset * this.thumbSize;\n    const thumbPosition = (this.trackOffset - thumbSize) * this.position;\n    const style = {\n      [this.horizontal ? 'left' : 'top']: `${thumbPosition}px`,\n      [this.horizontal ? 'width' : 'height']: `${thumbSize}px`\n    };\n    Object.assign(this.$scrollbarThumb.style, style);\n  }\n\n  /** Update auxiliary markers */\n  public updateMarkers() {\n    this.toggleAttribute('inactive', this.thumbSize >= 1);\n  }\n\n  /** Refresh scroll state and position */\n  public refresh() {\n    this.update();\n    this.updateMarkers();\n  }\n\n  // Event listeners\n  /** `mousedown` event to track thumb drag start */\n  @bind\n  protected _onMouseDown(event: MouseEvent) {\n    this.toggleAttribute('dragging', true);\n    this.$target?.style.setProperty('scroll-behavior', 'auto');\n\n    this._initialPosition = this.position;\n    this._initialMousePosition = this.horizontal ? event.clientX : event.clientY;\n\n    // Attach drag listeners\n    window.addEventListener('mousemove', this._onMouseMove);\n    window.addEventListener('mouseup', this._onMouseUp);\n    window.addEventListener('click', this._onBodyClick, {capture: true});\n\n    // Prevents default text selection, etc.\n    event.preventDefault();\n  }\n\n  /** Set position on drug */\n  protected _dragToCoordinate(mousePosition: number) {\n    const positionChange = mousePosition - this._initialMousePosition;\n    const scrollableAreaHeight = this.trackOffset - this.thumbOffset;\n    const absChange = scrollableAreaHeight ? (positionChange / scrollableAreaHeight) : 0;\n    this.position = this._initialPosition + absChange;\n  }\n  protected _deferredDragToCoordinate = rafDecorator(this._dragToCoordinate);\n\n  /** `mousemove` document handler for thumb drag event. Active only if drag action is active */\n  @bind\n  protected _onMouseMove(event: MouseEvent) {\n    if (!this.dragging) return;\n\n    // Request position update\n    this._deferredDragToCoordinate(this.horizontal ? event.clientX : event.clientY);\n\n    // Prevents default text selection, etc.\n    event.preventDefault();\n    event.stopPropagation();\n  }\n\n  /** `mouseup` short-time document handler for drag end action */\n  @bind\n  protected _onMouseUp() {\n    this.toggleAttribute('dragging', false);\n    this.$target?.style.removeProperty('scroll-behavior');\n\n    // Unbind drag listeners\n    window.removeEventListener('mousemove', this._onMouseMove);\n    window.removeEventListener('mouseup', this._onMouseUp);\n  }\n\n  /** Body `click` short-time handler to prevent clicks event on thumb drag. Handles capture phase */\n  @bind\n  protected _onBodyClick(event: MouseEvent) {\n    event.stopImmediatePropagation();\n\n    window.removeEventListener('click', this._onBodyClick, {capture: true});\n  }\n\n  /** Handler for track clicks. Move scroll to selected position */\n  @bind\n  protected _onClick(event: MouseEvent) {\n    if (event.target !== this.$scrollbarTrack && event.target !== this) return;\n    const clickCoordinates = EventUtils.normalizeCoordinates(event, this.$scrollbarTrack);\n    const clickPosition = this.horizontal ? clickCoordinates.x : clickCoordinates.y;\n\n    const freeTrackArea = this.trackOffset - this.thumbOffset; // px\n    const clickPositionNoOffset = clickPosition - this.thumbOffset / 2;\n    const newPosition = clickPositionNoOffset / freeTrackArea;  // abs % to track\n\n    this.position = Math.min(this.position + this.thumbSize,\n      Math.max(this.position - this.thumbSize, newPosition));\n  }\n\n  /**\n   * Handler for refresh events to update the scroll.\n   * @param event - instance of 'resize' or 'scroll' or 'esl:refresh' event.\n   */\n  @bind\n  protected _onRefresh(event: Event) {\n    const target = event.target as HTMLElement;\n    if (event.type === 'scroll' && this.dragging) return;\n    if (event.type === 'esl:refresh' && !TraversingUtils.isRelative(target.parentNode, this.$target)) return;\n    this.deferredRefresh();\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Scrollbar: typeof ESLScrollbar;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-scrollbar': ESLScrollbar;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {attr, jsonAttr} from '../../esl-base-element/core';\nimport {ESLToggleable} from '../../esl-toggleable/core';\nimport {DeviceDetector} from '../../esl-utils/environment/device-detector';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {createZIndexIframe} from '../../esl-utils/fixes/ie-fixes';\nimport {TraversingQuery} from '../../esl-traversing-query/core';\n\nimport type {ToggleableActionParams} from '../../esl-toggleable/core';\n\nexport interface AlertActionParams extends ToggleableActionParams {\n  /** text to be shown; pass empty string or null to hide */\n  text?: string;\n  /** html content */\n  html?: string;\n  /** classes to add to alert element */\n  cls?: string;\n  /** timeout to clear classes */\n  hideTime?: number;\n}\n\n/**\n * ESLAlert component\n *\n * @author Julia Murashko\n *\n * ESLAlert is a component to show small notifications on your pages. ESLAlert can have multiple instances on the page.\n */\n@ExportNs('Alert')\nexport class ESLAlert extends ESLToggleable {\n  static is = 'esl-alert';\n  static eventNs = 'esl:alert';\n\n  static get observedAttributes() {\n    return ['target'];\n  }\n\n  /** Default show/hide params for all ESLAlert instances */\n  static defaultConfig: AlertActionParams = {\n    hideTime: 300,\n    hideDelay: 2500\n  };\n\n  /** Define the scope (using {@link TraversingQuery} syntax) element to listen to activation event. Parent element by default */\n  @attr({defaultValue: '::parent'}) public target: string;\n\n  /** Default show/hide params for current ESLAlert instance */\n  @jsonAttr<AlertActionParams>()\n  public defaultParams: AlertActionParams;\n\n  protected $content: HTMLElement;\n  protected activeCls?: string;\n\n  private _$target: EventTarget;\n  private _clearTimeout: number;\n\n  /** Create global alert instance (using body element as a base) */\n  public static init() {\n    if (document.querySelector(`body > ${ESLAlert.is}`)) return;\n    const alert = document.createElement(ESLAlert.is) as ESLAlert;\n    document.body.appendChild(alert);\n  }\n\n  protected mergeDefaultParams(params?: ToggleableActionParams): ToggleableActionParams {\n    const type = this.constructor as typeof ESLAlert;\n    return Object.assign({}, type.defaultConfig, this.defaultParams || {}, params || {});\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string) {\n    if (!this.connected) return;\n    if (attrName === 'target') {\n      this.$target = TraversingQuery.first(this.target) as EventTarget;\n    }\n  }\n\n  protected connectedCallback() {\n    super.connectedCallback();\n    this.setAttribute('role', this.getAttribute('role') || 'alert');\n    this.$content = document.createElement('div');\n    this.$content.className = 'esl-alert-content';\n    this.innerHTML = '';\n    this.appendChild(this.$content);\n    if (DeviceDetector.isIE) this.appendChild(createZIndexIframe());\n    if (this.target) {\n      this.$target = TraversingQuery.first(this.target, this) as EventTarget;\n    }\n  }\n\n  protected unbindEvents() {\n    super.unbindEvents();\n    this.unbindTargetEvents();\n  }\n\n  /** Target element to listen to activation events */\n  public get $target() {\n    return this._$target;\n  }\n  public set $target($el: EventTarget) {\n    this.unbindTargetEvents();\n    this._$target = $el;\n    this.bindTargetEvents();\n  }\n\n  protected bindTargetEvents() {\n    if (!this.$target || !this.connected) return;\n    this.$target.addEventListener(`${ESLAlert.eventNs}:show`, this._onTargetEvent);\n    this.$target.addEventListener(`${ESLAlert.eventNs}:hide`, this._onTargetEvent);\n  }\n  protected unbindTargetEvents() {\n    if (!this.$target) return;\n    this.$target.removeEventListener(`${ESLAlert.eventNs}:show`, this._onTargetEvent);\n    this.$target.removeEventListener(`${ESLAlert.eventNs}:hide`, this._onTargetEvent);\n  }\n\n  protected onShow(params: AlertActionParams) {\n    if (this._clearTimeout) window.clearTimeout(this._clearTimeout);\n    if (params.html || params.text) {\n      this.render(params);\n      super.onShow(params);\n    }\n    this.hide(params);\n  }\n  protected onHide(params: AlertActionParams) {\n    super.onHide(params);\n    this._clearTimeout = window.setTimeout(() => this.clear(), params.hideTime);\n  }\n\n  protected render({text, html, cls}: AlertActionParams) {\n    CSSClassUtils.remove(this, this.activeCls);\n    CSSClassUtils.add(this, this.activeCls = cls);\n    if (html) this.$content.innerHTML = html;\n    if (text) this.$content.textContent = text;\n  }\n  protected clear() {\n    this.$content.innerHTML = '';\n    CSSClassUtils.remove(this, this.activeCls);\n  }\n\n  @bind\n  protected _onTargetEvent(e: CustomEvent) {\n    if (e.type === `${ESLAlert.eventNs}:show`) {\n      const params = Object.assign({}, e.detail, {force: true});\n      this.show(params);\n    }\n    if (e.type === `${ESLAlert.eventNs}:hide`) {\n      const params = Object.assign({}, {hideDelay: 0}, e.detail, {force: true});\n      this.hide(params);\n    }\n    e.stopPropagation();\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Alert: typeof ESLAlert;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-alert': ESLAlert;\n  }\n}\n","/** Fix IE browser to allow to display alert under iframe */\nexport function createZIndexIframe(): HTMLElement {\n  const iframe = document.createElement('iframe');\n  iframe.className = 'ie-zindex-fix';\n  iframe.src = 'about:blank';\n  return iframe;\n}\n","import {attr, boolAttr, ESLBaseElement} from '../../../esl-base-element/core';\nimport {ExportNs} from '../../../esl-utils/environment/export-ns';\n\nimport type {ESLSelectOption} from './esl-select-wrapper';\n\n/**\n * ESLSelectItem component\n * @author Alexey Stsefanovich (ala'n)\n *\n * ESLSelectItem - inner component to render an option\n */\n@ExportNs('SelectItem')\nexport class ESLSelectItem extends ESLBaseElement {\n  public static readonly is: string = 'esl-select-item';\n\n  public static get observedAttributes() {\n    return ['selected', 'disabled'];\n  }\n\n  /** Option value */\n  @attr() public value: string;\n  /** Selected state marker */\n  @boolAttr() public selected: boolean;\n  /** Disabled state marker */\n  @boolAttr() public disabled: boolean;\n\n  /** Original option */\n  public original: ESLSelectOption;\n\n  protected connectedCallback() {\n    super.connectedCallback();\n    this.tabIndex = 0;\n    this.setAttribute('role', 'checkbox');\n    this.setAttribute('aria-selected', String(this.selected));\n  }\n\n  protected attributeChangedCallback(attrName: string) {\n    if (attrName === 'selected') {\n      this.setAttribute('aria-selected', String(this.selected));\n    }\n    if (attrName === 'disabled') {\n      this.setAttribute('aria-disabled', String(this.disabled));\n    }\n  }\n\n  public update(option?: ESLSelectOption) {\n    if (option) this.original = option;\n    this.value = this.original.value;\n    this.disabled = this.original.disabled;\n    this.selected = this.original.selected;\n    this.textContent = this.original.text;\n  }\n\n  /** Helper to create an option item */\n  public static build(option: ESLSelectOption) {\n    const item = document.createElement(ESLSelectItem.is) as ESLSelectItem;\n    item.update(option);\n    return item;\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    SelectItem: typeof ESLSelectItem;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-select-item': ESLSelectItem;\n  }\n}\n","import {ESLBaseElement} from '../../../esl-base-element/core';\nimport {EventUtils} from '../../../esl-utils/dom/events';\nimport {bind} from '../../../esl-utils/decorators/bind';\n\n/** Interface for option definition */\nexport interface ESLSelectOption {\n  /** Label text of the option */\n  text: string;\n  /** Value of the option */\n  value: string;\n  /** Disabled marker */\n  disabled: boolean;\n  /** Selected marker */\n  selected: boolean;\n  /** Initially selected marker */\n  defaultSelected: boolean;\n}\n\n/** Interface to declare options source for select components */\nexport interface ESLSelectModel {\n  /** Allow multiple items */\n  multiple: boolean;\n  /** Get list of options */\n  options: ESLSelectOption[];\n  /** Get list of selected options */\n  selectedOptions: ESLSelectOption[];\n\n  /** Toggle option with passed value to the state */\n  setSelected(value: string, state: boolean): void;\n  /** Check selected state*/\n  isSelected(value: string): boolean;\n  /** Has selected options */\n  hasSelected(): boolean;\n\n  /** Check that all options are selected */\n  isAllSelected(): boolean;\n  /** Toggle all options to the state */\n  setAllSelected(state: boolean): void;\n}\n\n/**\n * Base class for {@link HTMLSelectElement} wrapper element, implements {@link ESLSelectModel} options source\n */\nexport abstract class ESLSelectWrapper extends ESLBaseElement implements ESLSelectModel {\n  protected static observationConfig: MutationObserverInit = {\n    subtree: true,\n    attributes: true,\n    attributeFilter: ['value', 'selected', 'disabled'],\n    childList: true,\n    characterData: true\n  };\n\n  private _$select: HTMLSelectElement;\n  private _mutationObserver = new MutationObserver(this._onTargetMutation.bind(this));\n\n  /** Native select that is wrapped */\n  public get $select() {\n    return this._$select;\n  }\n  public set $select(select: HTMLSelectElement) {\n    const prev = this._$select;\n    this._$select = select;\n    this._onTargetChange(select, prev);\n  }\n\n  protected connectedCallback() {\n    super.connectedCallback();\n    this.ownerDocument.addEventListener('reset', this._onReset);\n  }\n\n  protected disconnectedCallback() {\n    super.disconnectedCallback();\n    this.ownerDocument.removeEventListener('reset', this._onReset);\n    this._mutationObserver.disconnect();\n    this._$select && this._$select.removeEventListener('change', this._onChange);\n  }\n\n  protected _onChange(event?: Event) {}\n  protected _onListChange() {}\n  protected _onTargetChange(newTarget: HTMLSelectElement | undefined,\n                            oldTarget: HTMLSelectElement | undefined) {\n    if (oldTarget) oldTarget.removeEventListener('change', this._onChange);\n    if (newTarget) newTarget.addEventListener('change', this._onChange);\n    this._mutationObserver.disconnect();\n    const type = (this.constructor as typeof ESLSelectWrapper);\n    if (newTarget) this._mutationObserver.observe(newTarget, type.observationConfig);\n  }\n  protected _onTargetMutation(changes: MutationRecord[]) {\n    const isListChange = (change: MutationRecord) => change.addedNodes.length + change.removedNodes.length > 0;\n    changes.some(isListChange) ? this._onListChange() : this._onChange();\n  }\n\n  @bind\n  protected _onReset(event: Event) {\n    if (!event.target || event.target !== this.form) return;\n    setTimeout(() => this._onChange(event));\n  }\n\n  public get multiple() {\n    return this.$select && this.$select.multiple;\n  }\n\n  public get options(): ESLSelectOption[] {\n    return this.$select ? Array.from(this.$select.options) : [];\n  }\n  public get selectedOptions(): ESLSelectOption[] {\n    return this.options.filter((item) => item.selected);\n  }\n\n  protected getOption(value: string): ESLSelectOption | undefined {\n    return this.options.find((item) => item.value === value);\n  }\n\n  public setSelected(value: string, state: boolean) {\n    const option = this.getOption(value);\n    option && (option.selected = state);\n    EventUtils.dispatch(this.$select, 'change');\n  }\n  public isSelected(value: string): boolean {\n    const opt = this.getOption(value);\n    return !!opt && opt.selected;\n  }\n  public hasSelected(): boolean {\n    return this.options.some((item) => item.selected);\n  }\n\n  public isAllSelected(): boolean {\n    return this.options.every((item) => item.selected || item.disabled);\n  }\n\n  public setAllSelected(state: boolean) {\n    if (!this.multiple) return false;\n    this.options.forEach((item: HTMLOptionElement) => item.selected = !item.disabled && state);\n    EventUtils.dispatch(this.$select, 'change');\n  }\n\n  // Proxy select methods and values\n  public get value() {\n    return this.$select?.value;\n  }\n  public get values() {\n    return this.selectedOptions.map((item: HTMLOptionElement) => item.value);\n  }\n\n  public get form(): HTMLFormElement | null {\n    return this.$select?.form;\n  }\n\n  public get name(): string {\n    return this.$select?.name;\n  }\n  public set name(name: string) {\n    this.$select && (this.$select.name = name);\n  }\n\n  public get required(): boolean {\n    return this.$select?.required;\n  }\n  public set required(required: boolean) {\n    this.$select && (this.$select.required = required);\n  }\n\n  // Validation API values\n  public get validity(): ValidityState {\n    return this.$select?.validity;\n  }\n  public get validationMessage(): string {\n    return this.$select?.validationMessage;\n  }\n  public get willValidate(): boolean {\n    return this.$select?.willValidate;\n  }\n\n  // Validation API methods\n  public checkValidity(): boolean {\n    return this.$select?.checkValidity();\n  }\n  public reportValidity(): boolean {\n    return this.$select?.reportValidity();\n  }\n  public setCustomValidity(error: string): void {\n    this.$select?.setCustomValidity(error);\n  }\n}\n","import {attr, boolAttr} from '../../../esl-base-element/core';\nimport {bind} from '../../../esl-utils/decorators/bind';\nimport {ARROW_DOWN, ARROW_UP, ENTER, SPACE} from '../../../esl-utils/dom/keys';\nimport {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {ESLScrollbar} from '../../../esl-scrollbar/core';\nimport {ESLSelectItem} from './esl-select-item';\nimport {ESLSelectWrapper} from './esl-select-wrapper';\n\n/**\n * ESLSelectList component\n * @author Alexey Stsefanovich (ala'n)\n *\n * ESLSelectList is a component to show selectable list of items. Decorates native HTMLSelectElement\n */\n@ExportNs('SelectList')\nexport class ESLSelectList extends ESLSelectWrapper {\n  public static readonly is = 'esl-select-list';\n  public static get observedAttributes() {\n    return ['select-all-label', 'disabled'];\n  }\n\n  public static register() {\n    ESLSelectItem.register();\n    super.register();\n  }\n\n  /** Select all options text */\n  @attr({defaultValue: 'Select All'}) public selectAllLabel: string;\n\n  /** Disabled state marker */\n  @boolAttr() public disabled: boolean;\n  /** Marker for selecting items to be pinned to the top of the list */\n  @boolAttr() public pinSelected: boolean;\n\n  protected $items: ESLSelectItem[];\n  protected $list: HTMLDivElement;\n  protected $scroll: ESLScrollbar;\n  protected $selectAll: ESLSelectItem;\n\n  constructor() {\n    super();\n    this.$list = document.createElement('div');\n    this.$list.setAttribute('role', 'list');\n    this.$list.classList.add('esl-scrollable-content');\n    this.$list.classList.add('esl-select-list-container');\n    this.$scroll = document.createElement(ESLScrollbar.is) as ESLScrollbar;\n    this.$scroll.target = '::prev';\n    this.$selectAll = document.createElement(ESLSelectItem.is) as ESLSelectItem;\n    this.$selectAll.classList.add('esl-select-all-item');\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string) {\n    if (!this.connected || newVal === oldVal) return;\n    if (attrName === 'select-all-label') {\n      this.$selectAll.textContent = newVal;\n    }\n    if (attrName === 'disabled') {\n      this._updateDisabled();\n    }\n  }\n\n  protected connectedCallback() {\n    super.connectedCallback();\n\n    this.appendChild(this.$selectAll);\n    this.appendChild(this.$list);\n    this.appendChild(this.$scroll);\n\n    this.bindSelect();\n    this.bindEvents();\n\n    this._updateDisabled();\n  }\n  protected disconnectedCallback() {\n    super.disconnectedCallback();\n\n    this.appendChild(this.$selectAll);\n    this.appendChild(this.$list);\n    this.appendChild(this.$scroll);\n\n    this.unbindEvents();\n  }\n\n  protected bindSelect() {\n    const target = this.querySelector('[esl-select-target]');\n    if (!target || !(target instanceof HTMLSelectElement)) return;\n    this.$select = target;\n  }\n\n  public bindEvents() {\n    if (!this.$select) return;\n    this.addEventListener('click', this._onClick);\n    this.addEventListener('keydown', this._onKeydown);\n  }\n  public unbindEvents() {\n    if (!this.$select) return;\n    this.removeEventListener('click', this._onClick);\n    this.removeEventListener('keydown', this._onKeydown);\n  }\n\n  protected _renderItems() {\n    if (!this.$select) return;\n    this.$list.innerHTML = '';\n    this.$items = this.options.map(ESLSelectItem.build);\n    if (this.pinSelected) {\n      this._renderGroup(this.$items.filter((option) => option.selected));\n      this._renderGroup(this.$items.filter((option) => !option.selected));\n    } else {\n      this._renderGroup(this.$items);\n    }\n    this.toggleAttribute('multiple', this.multiple);\n  }\n  protected _renderGroup(items: ESLSelectItem[]) {\n    items.forEach((item) => this.$list.appendChild(item));\n    const [last] = items.slice(-1);\n    last && last.classList.add('last-in-group');\n  }\n\n  protected _updateSelectAll() {\n    if (!this.multiple) {\n      this.$selectAll.removeAttribute('tabindex');\n      return;\n    }\n    this.$selectAll.tabIndex = 0;\n    this.$selectAll.selected = this.isAllSelected();\n    this.$selectAll.textContent = this.selectAllLabel;\n  }\n  protected _updateDisabled() {\n    this.setAttribute('aria-disabled', String(this.disabled));\n    if (!this.$select) return;\n    this.$select.disabled = this.disabled;\n  }\n\n  @bind\n  protected _onTargetChange(newTarget: HTMLSelectElement | undefined, oldTarget: HTMLSelectElement | undefined) {\n    super._onTargetChange(newTarget, oldTarget);\n    this._updateSelectAll();\n    this._renderItems();\n\n    this.bindEvents();\n  }\n\n  @bind\n  public _onChange() {\n    this._updateSelectAll();\n    this.$items.forEach((item) => item.update());\n  }\n\n  @bind\n  public _onListChange() {\n    this._renderItems();\n  }\n\n  @bind\n  protected _onClick(e: MouseEvent | KeyboardEvent) {\n    if (this.disabled) return;\n    const target = e.target;\n    if (!target || !(target instanceof ESLSelectItem)) return;\n    if (target.classList.contains('esl-select-all-item')) {\n      this.setAllSelected(!target.selected);\n    } else {\n      this.setSelected(target.value, !target.selected);\n    }\n  }\n\n  @bind\n  protected _onKeydown(e: KeyboardEvent) {\n    if ([ENTER, SPACE].includes(e.key)) {\n      this._onClick(e);\n      e.preventDefault();\n    }\n    if ([ARROW_UP, ARROW_DOWN].includes(e.key)) {\n      const index = this.$items.indexOf(document.activeElement as ESLSelectItem);\n      const count = this.$items.length;\n      const increment = e.key === ARROW_UP ? -1 : 1;\n      if (index === -1) return;\n      this.$items[(index + increment + count) % count].focus();\n      e.preventDefault();\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    SelectList: typeof ESLSelectList;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-select-list': ESLSelectList;\n  }\n}\n","import {attr, boolAttr, ESLBaseElement} from '../../../esl-base-element/core';\nimport {rafDecorator} from '../../../esl-utils/async/raf';\nimport {bind} from '../../../esl-utils/decorators/bind';\nimport {format} from '../../../esl-utils/misc/format';\n\nimport {ESLSelect} from './esl-select';\n\n/**\n * ESLSelectRenderer component\n * @author Alexey Stsefanovich (ala'n)\n *\n * Auxiliary inner custom element to render {@link ESLSelect} inline field\n */\nexport class ESLSelectRenderer extends ESLBaseElement {\n  public static readonly is = 'esl-select-renderer';\n\n  /** Attribute for empty text value */\n  @attr() public emptyText: string;\n  /** Attribute for more label format */\n  @attr() public moreLabelFormat: string;\n  /** Marker attribute to reflect filled state */\n  @boolAttr() public hasValue: boolean;\n\n  protected $container: HTMLDivElement;\n  protected $rest: HTMLElement;\n  protected $text: HTMLElement;\n  protected $remove: HTMLButtonElement;\n\n  protected _deferredRerender = rafDecorator(() => this.render());\n\n  constructor() {\n    super();\n\n    this.$remove = document.createElement('button');\n    this.$remove.type = 'button';\n    this.$remove.setAttribute('aria-label', 'Clear');\n    this.$remove.classList.add('esl-select-clear-btn');\n    this.$remove.classList.add('icon-nav-close-menu');\n\n    this.$container = document.createElement('div');\n    this.$container.classList.add('esl-select-text-container');\n    this.$text = document.createElement('span');\n    this.$text.classList.add('esl-select-text');\n    this.$container.appendChild(this.$text);\n    this.$rest = document.createElement('span');\n    this.$rest.classList.add('esl-select-text');\n    this.$container.appendChild(this.$rest);\n  }\n\n  /** ESLSelect owner */\n  get owner(): ESLSelect | null {\n    return this.parentElement instanceof ESLSelect ? this.parentElement : null;\n  }\n\n  protected connectedCallback() {\n    super.connectedCallback();\n    this.appendChild(this.$container);\n    this.appendChild(this.$remove);\n    this.bindEvents();\n\n    customElements.whenDefined(ESLSelectRenderer.is).then(() => this.render());\n  }\n  protected disconnectedCallback() {\n    super.disconnectedCallback();\n    this.removeChild(this.$container);\n    this.removeChild(this.$remove);\n    this.unbindEvents();\n  }\n\n  protected bindEvents() {\n    if (!this.owner) return;\n    this.owner.addEventListener('esl:change:value', this.render);\n    this.$remove.addEventListener('click', this._onClear);\n    window.addEventListener('resize', this._deferredRerender);\n  }\n  protected unbindEvents() {\n    if (!this.owner) return;\n    this.owner.removeEventListener('esl:change:value', this.render);\n    this.$remove.removeEventListener('click', this._onClear);\n    window.removeEventListener('resize', this._deferredRerender);\n  }\n\n  /** Rerender component with markers */\n  @bind\n  public render() {\n    if (!this.owner) return;\n    const selected = this.owner.selectedOptions;\n    this.hasValue = !!selected.length;\n    this.toggleAttribute('multiple', this.owner.multiple);\n    this.applyItems(selected.map((item) => item.text));\n  }\n\n  /** Render item with a visible items limit */\n  protected apply(items: string[], limit: number) {\n    const length = items.length;\n    const rest = length - limit;\n    const options = {rest, length, limit};\n    this.$text.textContent = items.slice(0, limit).join(', ');\n    if (rest > 0) {\n      this.$rest.textContent = format(this.moreLabelFormat || '', options);\n    } else {\n      this.$rest.textContent = '';\n    }\n  }\n  /** Render items using adaptive algorithm */\n  protected applyItems(items: string[]) {\n    let size = 0;\n    do {\n      this.apply(items, ++size); // Render with extended limit while it not fits to the container\n    } while (size <= items.length && this.$container.scrollWidth <= this.$container.clientWidth);\n    this.apply(items, size - 1); // Render last limit that fits\n  }\n\n  /** Handle clear button click */\n  @bind\n  protected _onClear(e: MouseEvent) {\n    if (!this.owner) return;\n    this.owner.setAllSelected(false);\n    e.stopPropagation();\n    e.preventDefault();\n  }\n}\n\ndeclare global {\n  export interface HTMLElementTagNameMap {\n    'esl-select-renderer': ESLSelectRenderer;\n  }\n}\n","import {ESLToggleable} from '../../../esl-toggleable/core/esl-toggleable';\nimport {bind} from '../../../esl-utils/decorators/bind';\nimport {prop} from '../../../esl-utils/decorators/prop';\nimport {TAB} from '../../../esl-utils/dom/keys';\nimport {rafDecorator} from '../../../esl-utils/async/raf';\nimport {ESLSelectList} from '../../esl-select-list/core';\n\nimport type {ESLSelect} from './esl-select';\nimport type {ToggleableActionParams} from '../../../esl-toggleable/core/esl-toggleable';\n\n/**\n * ESLSelectDropdown component\n * @author Alexey Stsefanovich (ala'n)\n *\n * Auxiliary inner custom component to render {@link ESLSelect} dropdown section\n * Uses {@link ESLSelectList} to render the content\n */\nexport class ESLSelectDropdown extends ESLToggleable {\n  public static readonly is = 'esl-select-dropdown';\n  public static register() {\n    ESLSelectList.register();\n    super.register();\n  }\n\n  /** Owner ESLSelect instance */\n  public $owner: ESLSelect;\n\n  /** Inner ESLSelectList component */\n  protected $list: ESLSelectList;\n  protected _disposeTimeout: number;\n  protected _deferredUpdatePosition = rafDecorator(() => this.updatePosition());\n\n  @prop() public closeOnEsc = true;\n  @prop() public closeOnOutsideAction = true;\n\n  constructor() {\n    super();\n    this.$list = document.createElement(ESLSelectList.is);\n  }\n\n  protected setInitialState() {}\n\n  protected connectedCallback() {\n    super.connectedCallback();\n    this.appendChild(this.$list);\n  }\n  protected disconnectedCallback() {\n    super.disconnectedCallback();\n    this.removeChild(this.$list);\n  }\n\n  protected bindEvents() {\n    super.bindEvents();\n    window.addEventListener('resize', this._deferredUpdatePosition);\n  }\n  protected unbindEvents() {\n    super.unbindEvents();\n    window.removeEventListener('resize', this._deferredUpdatePosition);\n  }\n\n  protected onShow(params: ToggleableActionParams) {\n    document.body.appendChild(this);\n    this._disposeTimeout && window.clearTimeout(this._disposeTimeout);\n\n    this.$list.pinSelected = this.$owner.pinSelected;\n    this.$list.selectAllLabel = this.$owner.selectAllLabel;\n    this.$list.$select = this.$owner.$select;\n\n    super.onShow(params);\n    const focusable: HTMLElement | null = this.querySelector('[tabindex]');\n    focusable?.focus({preventScroll: true});\n    this.updatePosition();\n  }\n  protected onHide(params: ToggleableActionParams) {\n    const select = this.activator;\n    super.onHide(params);\n    this._disposeTimeout = window.setTimeout(() => {\n      if (this.parentNode !== document.body) return;\n      document.body.removeChild(this);\n    }, 1000);\n    select && setTimeout(() => select.focus({preventScroll: true}), 0);\n  }\n\n  @bind\n  protected _onKeyboardEvent(e: KeyboardEvent) {\n    super._onKeyboardEvent(e);\n    if (e.key === TAB) this._onTabKey(e);\n  }\n\n  protected _onTabKey(e: KeyboardEvent) {\n    const els = this.querySelectorAll('[tabindex]');\n    const first = els[0] as HTMLElement;\n    const last = els[els.length - 1] as HTMLElement;\n    if (first && e.target === last && !e.shiftKey) first.focus();\n    if (last && e.target === first && e.shiftKey) last.focus();\n  }\n\n  @bind\n  public updatePosition() {\n    if (!this.activator) return;\n    const windowY = window.scrollY || window.pageYOffset;\n    const rect = this.activator.getBoundingClientRect();\n\n    this.style.top = `${windowY + rect.top + rect.height}px`;\n    this.style.left = `${rect.left}px`;\n    this.style.width = `${rect.width}px`;\n  }\n}\n\ndeclare global {\n  export interface HTMLElementTagNameMap {\n    'esl-select-dropdown': ESLSelectDropdown;\n  }\n}\n","import {attr, boolAttr} from '../../../esl-base-element/core';\nimport {bind} from '../../../esl-utils/decorators/bind';\nimport {CSSClassUtils} from '../../../esl-utils/dom/class';\nimport {ENTER, SPACE} from '../../../esl-utils/dom/keys';\nimport {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {EventUtils} from '../../../esl-utils/dom/events';\n\nimport {ESLSelectWrapper} from '../../esl-select-list/core/esl-select-wrapper';\nimport {ESLSelectRenderer} from './esl-select-renderer';\nimport {ESLSelectDropdown} from './esl-select-dropdown';\n\n/**\n * ESLSelect component\n * @author Alexey Stsefanovich (ala'n)\n *\n * ESLSelect is a component on top of native select that brings more customization features.\n * Uses \"select with dropdown\" view. Supports both single and multiple selection.\n */\n@ExportNs('Select')\nexport class ESLSelect extends ESLSelectWrapper {\n  public static readonly is = 'esl-select';\n  public static get observedAttributes() {\n    return ['disabled'];\n  }\n  public static register() {\n    ESLSelectDropdown.register();\n    ESLSelectRenderer.register();\n    super.register();\n  }\n\n  /** Placeholder text property */\n  @attr() public placeholder: string;\n  /** Class(es) to mark not empty state */\n  @attr() public hasValueClass: string;\n  /** Class(es) for focused state. Select is also focused if the dropdown list is opened */\n  @attr() public hasFocusClass: string;\n  /** Select all options text */\n  @attr({defaultValue: 'Select All'}) public selectAllLabel: string;\n\n  /**\n   * Text to add when there is not enough space to show all selected options inline,\n   * Supports `{rest}`, `{length}` and `{limit}` placeholders\n   */\n  @attr({defaultValue: '+ {rest} more...'}) public moreLabelFormat: string;\n\n  /** Dropdown open marker */\n  @boolAttr() public open: boolean;\n  /** Disabled state marker */\n  @boolAttr() public disabled: boolean;\n  /** Marker for selecting items to be pinned to the top of the dropdown */\n  @boolAttr() public pinSelected: boolean;\n\n  protected $renderer: ESLSelectRenderer;\n  protected $dropdown: ESLSelectDropdown;\n\n  constructor() {\n    super();\n\n    this.$renderer = document.createElement(ESLSelectRenderer.is);\n    this.$dropdown = document.createElement(ESLSelectDropdown.is);\n  }\n\n  protected attributeChangedCallback(attrName: string) {\n    if (attrName === 'disabled') this._updateDisabled();\n  }\n\n  protected connectedCallback() {\n    super.connectedCallback();\n\n    this.$select = this.querySelector('[esl-select-target]')!;\n    if (!this.$select) return;\n\n    this._prepare();\n    this._updateDisabled();\n    this.bindEvents();\n    this._onUpdate();\n  }\n  protected disconnectedCallback() {\n    super.disconnectedCallback();\n    this.unbindEvents();\n    this._dispose();\n  }\n\n  /** Catches the focus */\n  public focus(options?: FocusOptions) {\n    this.$select.focus(options);\n  }\n  /** Updates select component */\n  public update(valueChanged = true) {\n    this._onUpdate();\n    if (!valueChanged) return;\n    // TODO: silent updates\n    EventUtils.dispatch(this, 'esl:change:value', {detail: {event: null}});\n  }\n\n  protected bindEvents() {\n    this.addEventListener('click', this._onClick);\n    this.addEventListener('keydown', this._onKeydown);\n    this.addEventListener('focusout', this._onUpdate);\n    this.$dropdown.addEventListener('esl:show', this._onPopupStateChange);\n    this.$dropdown.addEventListener('esl:hide', this._onPopupStateChange);\n  }\n  protected unbindEvents() {\n    this.removeEventListener('click', this._onClick);\n    this.removeEventListener('keydown', this._onKeydown);\n    this.removeEventListener('focusout', this._onUpdate);\n    this.$dropdown.removeEventListener('esl:show', this._onPopupStateChange);\n    this.$dropdown.removeEventListener('esl:hide', this._onPopupStateChange);\n  }\n\n  protected _prepare() {\n    this.$renderer.className = this.$select.className;\n    this.$renderer.emptyText = this.placeholder;\n    this.$renderer.moreLabelFormat = this.moreLabelFormat;\n    this.$dropdown.$owner = this;\n    this.appendChild(this.$renderer);\n  }\n  protected _dispose() {\n    this.$select.className = this.$renderer.className;\n    this.removeChild(this.$renderer);\n  }\n\n  protected _updateDisabled() {\n    this.setAttribute('aria-disabled', String(this.disabled));\n    if (!this.$select) return;\n    this.$select.disabled = this.disabled;\n    if (this.disabled && this.open) this.$dropdown.hide();\n  }\n\n  @bind\n  protected _onChange(event: Event) {\n    this._onUpdate();\n    EventUtils.dispatch(this, 'esl:change:value', {detail: {event}});\n  }\n\n  @bind\n  protected _onUpdate() {\n    const hasValue = this.hasSelected();\n    this.toggleAttribute('has-value', hasValue);\n    CSSClassUtils.toggle(this, this.hasValueClass, hasValue);\n\n    const focusEl = document.activeElement;\n    const hasFocus = this.open || (focusEl && this.contains(focusEl));\n    CSSClassUtils.toggle(this, this.hasFocusClass, !!hasFocus);\n  }\n\n  @bind\n  protected _onClick() {\n    if (this.disabled) return;\n    this.$dropdown.toggle(!this.$dropdown.open, {\n      activator: this,\n      initiator: 'select'\n    });\n  }\n\n  @bind\n  protected _onKeydown(e: KeyboardEvent) {\n    if ([ENTER, SPACE].includes(e.key)) {\n      this.click();\n      e.preventDefault();\n    }\n  }\n\n  @bind\n  protected _onPopupStateChange(e: CustomEvent) {\n    if (e.target !== this.$dropdown) return;\n    this.open = this.$dropdown.open;\n    this._onUpdate();\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Select: typeof ESLSelect;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-select': ESLSelect;\n  }\n}\n","const ns = window || global;\nconst sequences = ns.__esl_sequences__ || new Map<string, number>();\nns.__esl_sequences__ = sequences;\n\ndeclare global {\n  interface Window {\n    __esl_sequences__: Map<string, number>;\n  }\n}\n\n/** Create and return sequential id */\nexport const sequentialUID = (name: string, prefix: string = name) => {\n  const uid = (sequences.get(name) || 0) + 1;\n  sequences.set(name, uid);\n  return prefix + uid;\n};\n\n/** Return random unique identifier */\nexport const randUID = (prefix: string = ''): string => {\n  const time = Date.now().toString(32);\n  const rand = Math.round(Math.random() * 1024 * 1024).toString(32);\n  return prefix + time + '-' + rand;\n};\n\n/**\n * Generate unique id\n * @deprecated Alias for {@link randUID}\n */\nexport const generateUId = randUID;\n","import type {ESLNote} from './esl-note';\n\nexport interface FootnotesItem {\n  index: string;\n  text: string;\n}\n\n/* Convert notes list to footnotes items list */\nfunction convertNotesToFootnotesList(notes: ESLNote[]): FootnotesItem[] {\n  return notes.map(({index, html}) => ({\n    index: `${index}`,\n    text: html\n  }));\n}\n\n/* Compile footnotes non-grouped list */\nexport function compileFootnotesNongroupedList(notes: ESLNote[]): FootnotesItem[] {\n  return convertNotesToFootnotesList(notes);\n}\n\n/* Compile footnotes grouped list */\nexport function compileFootnotesGroupedList(notes: ESLNote[]): FootnotesItem[] {\n  const map = new Map();\n  convertNotesToFootnotesList(notes).forEach(({index, text}) => {\n    map.set(text, map.has(text) ? `${map.get(text)}, ${index}` : index);\n  });\n  const groupedList: FootnotesItem[] = [];\n  map.forEach((index, text) => groupedList.push({index, text}));\n  return groupedList;\n}\n\n/* Sort notes list */\nexport function sortFootnotes(notes: ESLNote[]): ESLNote[] {\n  return notes.sort((note1: ESLNote, note2: ESLNote) => {\n    const rect1 = note1.getBoundingClientRect();\n    const rect2 = note2.getBoundingClientRect();\n    return rect1.top - rect2.top || rect1.left - rect2.left;\n  });\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {memoize} from '../../esl-utils/decorators/memoize';\nimport {ESLBaseElement, attr} from '../../esl-base-element/core';\nimport {TraversingQuery} from '../../esl-traversing-query/core';\nimport {EventUtils} from '../../esl-utils/dom/events';\nimport {sequentialUID} from '../../esl-utils/misc/uid';\nimport {compileFootnotesGroupedList, compileFootnotesNongroupedList, sortFootnotes} from './esl-footnotes-data';\n\nimport type {ESLNote} from './esl-note';\nimport type {FootnotesItem} from './esl-footnotes-data';\n\n@ExportNs('Footnotes')\nexport class ESLFootnotes extends ESLBaseElement {\n  static is = 'esl-footnotes';\n  static eventNs = 'esl:footnotes';\n\n  /** Target element {@link TraversingQuery} to define scope */\n  @attr({defaultValue: '::parent'}) public scopeTarget: string;\n\n  /** Grouping note instances with identical content enable/disable */\n  @attr({defaultValue: 'enable'}) public grouping: string;\n\n  protected _notes: ESLNote[] = [];\n\n  @memoize()\n  protected get scopeEl() {\n    return TraversingQuery.first(this.scopeTarget, this) as HTMLElement;\n  }\n\n  protected get footnotesList(): FootnotesItem[] {\n    this.reindex();\n    return this.grouping !== 'enable'\n      ? compileFootnotesNongroupedList(this._notes)\n      : compileFootnotesGroupedList(this._notes);\n  }\n\n  public reindex() {\n    this._notes = sortFootnotes(this._notes);\n    this._notes.forEach((note, index) => note.setIndex(index + 1));\n  }\n\n  protected connectedCallback() {\n    super.connectedCallback();\n\n    this.bindEvents();\n    this._sendRequestToNote();\n  }\n\n  protected disconnectedCallback() {\n    super.disconnectedCallback();\n\n    this.unbindEvents();\n    this._notes.forEach((el) => el.unlink());\n    this._notes = [];\n  }\n\n  protected bindEvents() {\n    if (this.scopeEl) {\n      this.scopeEl.addEventListener(`${ESLFootnotes.eventNs}:response`, this._onNoteSubscribe);\n    }\n    this.addEventListener('click', this._onClick);\n  }\n  protected unbindEvents() {\n    if (this.scopeEl) {\n      this.scopeEl.removeEventListener(`${ESLFootnotes.eventNs}:response`, this._onNoteSubscribe);\n    }\n    this.removeEventListener('click', this._onClick);\n  }\n\n  public linkNote(note: ESLNote) {\n    if (this._notes.includes(note)) return;\n    this._notes.push(note);\n    const index = +sequentialUID(ESLFootnotes.is, '');\n    note.link(this, index);\n  }\n\n  public unlinkNote(note: ESLNote) {\n    this._notes = this._notes.filter((el) => el !== note);\n    this.update();\n  }\n\n  public update() {\n    this.innerHTML = this.buildItems();\n  }\n\n  protected buildItems(): string {\n    const items = this.footnotesList.map((footnote) => this.buildItem(footnote)).join('');\n    return `<ul class=\"esl-footnotes-items\">${items}</ul>`;\n  }\n\n  protected buildItem(footnote: FootnotesItem): string {\n    const item = `${this.buildItemIndex(footnote)}${this.buildItemText(footnote)}${this.buildItemBack(footnote)}`;\n    return `<li class=\"esl-footnotes-item\" data-order=\"${footnote.index}\">${item}</li>`;\n  }\n\n  protected buildItemIndex(footnote: FootnotesItem): string {\n    return `<span class=\"esl-footnotes-index\">${footnote.index}</span>`;\n  }\n\n  protected buildItemText(footnote: FootnotesItem): string {\n    return `<span class=\"esl-footnotes-text\">${footnote.text}</span>`;\n  }\n\n  protected buildItemBack(footnote: FootnotesItem): string {\n    return '<span class=\"esl-footnotes-back-to-note\" tabindex=\"0\"></span>';\n  }\n\n  @bind\n  protected _onNoteSubscribe(e: CustomEvent) {\n    const note = e.target as ESLNote;\n    this.linkNote(note);\n    this.update();\n\n    e.stopImmediatePropagation();\n  }\n\n  @bind\n  protected _onClick(e: MouseEvent | KeyboardEvent) {\n    const target = e.target as HTMLElement;\n    if (target && target.classList.contains('esl-footnotes-back-to-note')) {\n      const orderAttr = target.closest('.esl-footnotes-item')?.getAttribute('data-order');\n      const order = orderAttr?.split(',').map((item) => +item);\n      order && this._onBackToNote(order);\n    }\n  }\n\n  protected _onBackToNote(order: number[]) {\n    const index = order[order.length - 1];\n    this._notes.forEach((note) => {\n      note.highlight(order.includes(note.index));\n      if (note.index === index) {\n        note.activate();\n      }\n    });\n  }\n\n  public turnOffHighlight(note: ESLNote) {\n    this._notes\n      .filter((item) => note.html === item.html)\n      .forEach((item) => item.highlight(false));\n  }\n\n  protected _sendRequestToNote() {\n    EventUtils.dispatch(this, `${ESLFootnotes.eventNs}:request`);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Footnotes: typeof ESLFootnotes;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-footnotes': ESLFootnotes;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {attr, boolAttr} from '../../esl-base-element/core';\nimport {ESLPopup} from '../../esl-popup/core';\nimport {memoize} from '../../esl-utils/decorators/memoize';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\n\nimport type {PopupActionParams} from '../../esl-popup/core';\nimport type {PositionType} from '../../esl-popup/core/esl-popup-position';\n\nexport interface TooltipActionParams extends PopupActionParams {\n  /** text to be shown */\n  text?: string;\n  /** html content to be shown */\n  html?: string;\n  /** tooltip without arrow */\n  disableArrow?: boolean;\n}\n\n@ExportNs('Tooltip')\nexport class ESLTooltip extends ESLPopup {\n  static is = 'esl-tooltip';\n\n  @attr({defaultValue: 'top'}) public position: PositionType;\n  @attr({defaultValue: 'fit'}) public behavior: string;\n  @boolAttr() public disableArrow: boolean;\n\n  @memoize()\n  public static get sharedInstance(): ESLTooltip {\n    return document.createElement('esl-tooltip');\n  }\n\n  public static show(params: TooltipActionParams = {}) {\n    ESLTooltip.sharedInstance.hide(params);\n    ESLTooltip.sharedInstance.show(params);\n  }\n\n  public static hide(params: TooltipActionParams = {}) {\n    ESLTooltip.sharedInstance.hide(params);\n  }\n\n  public connectedCallback() {\n    if (!this.disableArrow) {\n      this._appendArrow();\n    }\n    super.connectedCallback();\n    this.classList.add(ESLPopup.is);\n  }\n\n  protected setInitialState() {}\n\n  @memoize()\n  protected _createArrow() {\n    const arrow = document.createElement('span');\n    arrow.className = 'esl-popup-arrow';\n    return arrow;\n  }\n\n  protected _appendArrow() {\n    this.$arrow = this._createArrow();\n    this.appendChild(this.$arrow);\n  }\n\n  public onShow(params: TooltipActionParams) {\n    if (params.disableArrow) {\n      this.disableArrow = params.disableArrow;\n    }\n    if (params.text) {\n      this.innerText = params.text;\n    }\n    if (params.html) {\n      this.innerHTML = params.html;\n    }\n    if (params.extraClass) {\n      CSSClassUtils.add(this, params.extraClass);\n    }\n    document.body.appendChild(this);\n    super.onShow(params);\n    this._updateActivatorState(true);\n  }\n\n  public onHide(params: TooltipActionParams) {\n    this._updateActivatorState(false);\n    super.onHide(params);\n    document.body.removeChild(this);\n    if (params.extraClass) {\n      CSSClassUtils.remove(this, params.extraClass);\n    }\n  }\n\n  protected _updateActivatorState(newState: boolean) {\n    this.activator?.toggleAttribute('tooltip-shown', newState);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Tooltip: typeof ESLTooltip;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-tooltip': ESLTooltip;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {attr, boolAttr, ESLBaseElement} from '../../esl-base-element/core';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {ready} from '../../esl-utils/decorators/ready';\nimport {ESLTooltip} from '../../esl-tooltip/core';\nimport {EventUtils} from '../../esl-utils/dom/events';\nimport {ENTER, SPACE} from '../../esl-utils/dom/keys';\nimport {scrollIntoViewAsync} from '../../esl-utils/dom/scroll';\nimport {DeviceDetector} from '../../esl-utils/environment/device-detector';\nimport {ESLMediaQuery} from '../../esl-media-query/core';\nimport {ESLFootnotes} from './esl-footnotes';\n\nimport type {ToggleableActionParams} from '../../esl-toggleable/core/esl-toggleable';\n\n@ExportNs('Note')\nexport class ESLNote extends ESLBaseElement {\n  static is = 'esl-note';\n\n  /** Linked state marker */\n  @boolAttr() public linked: boolean;\n\n  /** Tooltip state marker */\n  @boolAttr() public tooltipShown: boolean;\n\n  /** Tooltip content */\n  @attr() public html: string;\n\n  /** Click event tracking media query. Default: `all` */\n  @attr({defaultValue: 'all'}) public trackClick: string;\n  /** Hover event tracking media query. Default: `all` */\n  @attr({defaultValue: 'all'}) public trackHover: string;\n\n  protected _$footnotes: ESLFootnotes | null;\n  protected _index: number;\n\n  /** Marker to allow track hover */\n  public get allowHover() {\n    return DeviceDetector.hasHover && ESLMediaQuery.for(this.trackHover).matches;\n  }\n  /** Marker to allow track clicks */\n  public get allowClick() {\n    return ESLMediaQuery.for(this.trackClick).matches;\n  }\n\n  static get observedAttributes() {\n    return ['tooltip-shown'];\n  }\n\n  get index(): number {\n    return this._index;\n  }\n\n  @ready\n  protected connectedCallback() {\n    if (!this.html) {\n      this.html = this.innerHTML;\n    }\n    super.connectedCallback();\n    this.bindEvents();\n    this._sendResponseToFootnote();\n  }\n\n  protected disconnectedCallback() {\n    super.disconnectedCallback();\n    this.unbindEvents();\n    this._$footnotes?.unlinkNote(this);\n    this.restore();\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string) {\n    if (!this.connected || oldVal === newVal) return;\n    if (attrName === 'tooltip-shown' && newVal === null) {\n      this._$footnotes?.turnOffHighlight(this);\n    }\n  }\n\n  protected bindEvents() {\n    document.body.addEventListener(`${ESLFootnotes.eventNs}:request`, this._onFootnotesReady);\n    this.addEventListener('click', this._onClick);\n    this.addEventListener('keydown', this._onKeydown);\n    this.addEventListener('mouseenter', this._onMouseEnter);\n    this.addEventListener('mouseleave', this._onMouseLeave);\n  }\n  protected unbindEvents() {\n    document.body.removeEventListener(`${ESLFootnotes.eventNs}:request`, this._onFootnotesReady);\n    this.removeEventListener('click', this._onClick);\n    this.removeEventListener('keydown', this._onKeydown);\n    this.removeEventListener('mouseenter', this._onMouseEnter);\n    this.removeEventListener('mouseleave', this._onMouseLeave);\n  }\n\n  public activate() {\n    scrollIntoViewAsync(this, {behavior: 'smooth', block: 'nearest'}).then(() => this.showTooltip());\n  }\n\n  public highlight(enable: boolean = true) {\n    this.classList.toggle('highlight', enable);\n  }\n\n  public link(footnotes: ESLFootnotes, index: number) {\n    this.linked = true;\n    this._$footnotes = footnotes;\n    this.setIndex(index);\n    this.tabIndex = 0;\n  }\n\n  public unlink() {\n    this.restore();\n    this._sendResponseToFootnote();\n  }\n\n  public setIndex(index: number) {\n    this._index = index;\n    this.innerHTML = `${index}`;\n  }\n\n  protected restore() {\n    this.linked = false;\n    this._$footnotes = null;\n    this.innerHTML = this.html;\n    this.tabIndex = -1;\n  }\n\n  /** Merge params to pass to the toggleable */\n  protected mergeToggleableParams(this: ESLNote, ...params: ToggleableActionParams[]) {\n    return Object.assign({\n      initiator: 'note',\n      activator: this,\n      html: this.html\n    }, ...params);\n  }\n\n  /** Show tooltip with passed params */\n  public showTooltip(params: ToggleableActionParams = {}) {\n    const actionParams = this.mergeToggleableParams({\n    }, params);\n    ESLTooltip.show(actionParams);\n    this.highlight();\n  }\n  /** Hide tooltip with passed params */\n  public hideTooltip(params: ToggleableActionParams = {}) {\n    const actionParams = this.mergeToggleableParams({\n    }, params);\n    ESLTooltip.hide(actionParams);\n  }\n  /** Toggles tooltip with passed params */\n  public toggleTooltip(params: ToggleableActionParams = {}, state: boolean = !this.tooltipShown) {\n    state ? this.showTooltip(params) : this.hideTooltip(params);\n  }\n\n  /** Handles `click` event */\n  @bind\n  protected _onClick(event: MouseEvent) {\n    if (!this.allowClick) return;\n    event.preventDefault();\n    return this.toggleTooltip({event});\n  }\n\n  /** Handles `keydown` event */\n  @bind\n  protected _onKeydown(event: KeyboardEvent) {\n    if (![ENTER, SPACE].includes(event.key)) return;\n    event.preventDefault();\n    return this.toggleTooltip({event});\n  }\n\n  /** Handles hover `mouseenter` event */\n  @bind\n  protected _onMouseEnter(event: MouseEvent) {\n    if (!this.allowHover) return;\n    this.showTooltip({event});\n    event.preventDefault();\n  }\n\n  /** Handles hover `mouseleave` event */\n  @bind\n  protected _onMouseLeave(event: MouseEvent) {\n    if (!this.allowHover) return;\n    this.hideTooltip({event, trackHover: true});\n    event.preventDefault();\n  }\n\n  @bind\n  protected _onFootnotesReady(e: CustomEvent) {\n    if (this.linked) return;\n    this._sendResponseToFootnote();\n  }\n\n  protected _sendResponseToFootnote() {\n    EventUtils.dispatch(this, `${ESLFootnotes.eventNs}:response`);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Note: typeof ESLNote;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-note': ESLNote;\n  }\n}\n","import {BaseProvider, PlayerStates} from '../core/esl-media-provider';\nimport {randUID} from '../../esl-utils/misc/uid';\n\n/**\n * Simple Basic Iframe provider for {@link ESLMedia}\n * @author Alexey Stsefanovich (ala'n)\n */\n@BaseProvider.register\nexport class IframeBasicProvider extends BaseProvider {\n  static readonly providerName: string = 'iframe';\n\n  private _state: PlayerStates = PlayerStates.UNINITIALIZED;\n  protected _el: HTMLIFrameElement;\n\n  static parseUrl(url: string) {\n    try {\n      if (!url) return null;\n      const {protocol} = new URL(url);\n      if (protocol !== 'http:' && protocol !== 'https:') return null;\n      return {mediaSrc: url};\n    } catch {\n      return null;\n    }\n  }\n\n  protected buildIframe() {\n    const el = document.createElement('iframe');\n    el.id = 'esl-media-iframe-' + randUID();\n    el.className = 'esl-media-inner esl-media-iframe';\n    el.title = this.config.title;\n    el.setAttribute('aria-label', this.config.title);\n    el.setAttribute('frameborder', '0');\n    el.setAttribute('tabindex', '0');\n    el.setAttribute('scrolling', 'no');\n    el.setAttribute('allowfullscreen', 'yes');\n    el.toggleAttribute('playsinline', this.config.playsinline);\n    el.src = this.config.mediaSrc || '';\n    return el;\n  }\n\n  public bind() {\n    if (this._state !== PlayerStates.UNINITIALIZED) return;\n    this._ready = new Promise((resolve, reject) => {\n      this._el = this.buildIframe();\n      this._el.onload = () => resolve(this);\n      this._el.onerror = (e) => reject(e);\n      this._state = PlayerStates.UNSTARTED;\n      this.component.appendChild(this._el);\n    });\n    this._ready.then(() => {\n      this._state = PlayerStates.PLAYING;\n      this.component._onReady();\n      this.component._onPlay();\n    });\n    this._ready.catch((e) => this.component._onError(e));\n  }\n\n  public unbind() {\n    this.component._onDetach();\n    this._state = PlayerStates.UNINITIALIZED;\n    super.unbind();\n  }\n\n  get ready() {\n    return Promise.resolve();\n  }\n\n  public focus() {\n    if (this._el && this._el.contentWindow) {\n      this._el.contentWindow.focus();\n    }\n  }\n\n  public get state() {\n    return this._state;\n  }\n\n  public get duration() {\n    return 0;\n  }\n\n  public get currentTime() {\n    return 0;\n  }\n\n  get defaultAspectRatio(): number {\n    return 0;\n  }\n\n  public seekTo(pos: number) {\n    console.error('[ESLMedia] Unsupported action: can not execute seekTo on abstract iframe provider');\n  }\n\n  public play() {\n    if (this.state === PlayerStates.UNINITIALIZED) {\n      this.bind();\n    }\n  }\n\n  public pause() {\n    this.unbind();\n  }\n\n  public stop() {\n    this.unbind();\n  }\n}\n","import {BaseProvider, PlayerStates} from '../../core/esl-media-provider';\n\nimport type {MediaProviderConfig, ProviderObservedParams} from '../../core/esl-media-provider';\n\n/**\n * Simple Native Media API provider for {@link ESLMedia}\n * @author Yuliya Adamskaya, Alexey Stsefanovich (ala'n)\n */\nexport abstract class HTMLMediaProvider extends BaseProvider {\n  static readonly urlPattern: RegExp;\n\n  static parseUrl(mediaSrc: string) {\n    if (this.urlPattern.test(mediaSrc)) {\n      return {mediaSrc};\n    }\n    return null;\n  }\n\n  protected _el: HTMLMediaElement;\n\n  protected static applyElementSettings(el: HTMLMediaElement, cfg: MediaProviderConfig) {\n    el.classList.add('esl-media-inner');\n    el.autoplay = cfg.autoplay;\n    el.preload = cfg.preload || 'auto';\n    el.loop = cfg.loop;\n    el.muted = cfg.muted;\n    el.controls = cfg.controls;\n    el.tabIndex = 0;\n    el.toggleAttribute('playsinline', cfg.playsinline);\n    return el;\n  }\n\n  protected abstract createElement(): HTMLMediaElement;\n\n  public onConfigChange(param: ProviderObservedParams, value: boolean) {\n    super.onConfigChange(param, value);\n    HTMLMediaProvider.applyElementSettings(this._el, this.config);\n  }\n\n  public bind() {\n    this._el = this.createElement();\n    HTMLMediaProvider.applyElementSettings(this._el, this.config);\n    this.component.appendChild(this._el);\n    this.bindListeners();\n  }\n\n  protected bindListeners() {\n    this._el.addEventListener('loadedmetadata', () => this.component._onReady());\n    this._el.addEventListener('play', () => this.component._onPlay());\n    this._el.addEventListener('pause', () => this.component._onPaused());\n    this._el.addEventListener('ended', () => this.component._onEnded());\n    this._el.addEventListener('error', (e) => this.component._onError(e));\n  }\n\n  public unbind() {\n    this.component._onDetach();\n    super.unbind();\n  }\n\n  get ready() {\n    return Promise.resolve();\n  }\n\n  public get state() {\n    if (!this._el) return PlayerStates.UNINITIALIZED;\n    if (this._el.ended) return PlayerStates.ENDED;\n    if (!this._el.played || !this._el.played.length) return PlayerStates.UNSTARTED;\n    if (this._el.paused) return PlayerStates.PAUSED;\n    return PlayerStates.PLAYING;\n  }\n\n  public get duration() {\n    return this._el ? this._el.duration : 0;\n  }\n\n  public get currentTime() {\n    return this._el ? this._el.currentTime : 0;\n  }\n\n  public seekTo(pos: number) {\n    this._el.currentTime = pos;\n  }\n\n  public play() {\n    return this._el.play();\n  }\n\n  public pause() {\n    return this._el.pause();\n  }\n\n  public stop() {\n    this._el.pause();\n    this._el.currentTime = 0;\n  }\n}\n","import {BaseProvider} from '../../core/esl-media-provider';\nimport {HTMLMediaProvider} from './media-provider';\n\n/**\n * Simple Audio API provider for {@link ESLMedia}\n * @author Alexey Stsefanovich (ala'n)\n */\n@BaseProvider.register\nexport class AudioProvider extends HTMLMediaProvider {\n  static readonly providerName: string = 'audio';\n  static readonly urlPattern = /\\.(mp3|wav|aac)(\\?|$)/;\n\n  protected _el: HTMLAudioElement;\n\n  protected createElement(): HTMLAudioElement {\n    const el = document.createElement('audio');\n    el.src = this.config.mediaSrc || '';\n    return el;\n  }\n\n  public get defaultAspectRatio(): number {\n    return 0;\n  }\n}\n","/**\n * Creates new async script tag by id and src\n */\nconst createAsyncScript = (id: string, src: string) => {\n  const script = document.createElement('script');\n  script.id = id;\n  script.async = true;\n  script.src = src;\n  return script;\n};\n\n/**\n * Common function that loads script async\n * @param id - unique script id that is used as a marker to prevent future load\n * @param src - script src (url) to load\n */\nexport function loadScript(id: string, src: string): Promise<Event> {\n  return new Promise((resolve, reject) => {\n    const script: HTMLScriptElement =\n      (document.getElementById(id) || createAsyncScript(id, src)) as HTMLScriptElement;\n    const state = script.getAttribute('state');\n\n    switch (state) {\n      case 'success': resolve(new Event('load')); break;\n      case 'error': reject(new Event('error')); break;\n      default:\n        script.addEventListener('load', (e: Event) => {\n          script.setAttribute('state', 'success');\n          resolve(e);\n        });\n        script.addEventListener('error', (e: Event) => {\n          script.setAttribute('state', 'error');\n          reject(e);\n        });\n    }\n    if (!script.parentNode) {\n      const firstScriptTag =\n        document.querySelector('script') || document.querySelector('head title');\n      if (firstScriptTag && firstScriptTag.parentNode) {\n        firstScriptTag.parentNode.insertBefore(script, firstScriptTag);\n      } else {\n        reject('Page document structure is incorrect');\n      }\n    }\n  });\n}\n","import {BaseProvider} from '../../core/esl-media-provider';\nimport {HTMLMediaProvider} from './media-provider';\n\n/**\n * Simple Video API provider for {@link ESLMedia}\n * @author Yuliya Adamskaya\n */\n@BaseProvider.register\nexport class VideoProvider extends HTMLMediaProvider {\n  static readonly providerName: string = 'video';\n  static readonly urlPattern = /\\.(mp4|webm|ogv|mov)(\\?|$)/;\n\n  protected _el: HTMLVideoElement;\n\n  protected createElement(): HTMLVideoElement {\n    const el = document.createElement('video');\n    el.src = this.config.mediaSrc || '';\n    return el;\n  }\n\n  get defaultAspectRatio(): number {\n    return this._el.videoWidth / this._el.videoHeight;\n  }\n}\n","import {loadScript} from '../../esl-utils/dom/script';\nimport {BaseProvider, PlayerStates} from '../core/esl-media-provider';\nimport {randUID} from '../../esl-utils/misc/uid';\nimport PlayerVars = YT.PlayerVars;\n\nimport type {MediaProviderConfig, ProviderObservedParams} from '../core/esl-media-provider';\n\nconst DEFAULT_ASPECT_RATIO = 16 / 9;\n\n/**\n * Youtube API provider for {@link ESLMedia}\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya\n */\n@BaseProvider.register\nexport class YouTubeProvider extends BaseProvider {\n  static readonly providerName: string = 'youtube';\n  static readonly idRegexp = /(?:v\\/|v=|vi=|vi\\/|e\\/|embed\\/|user\\/.*\\/u\\/\\d+\\/)([_0-9a-zA-Z-]+)/i;\n  static readonly providerRegexp = /^\\s*(?:http(?:s)?:\\/\\/)?(?:www\\.)?(?:youtu\\.be|youtube(-nocookie)?\\.com)/i;\n\n  protected _el: HTMLDivElement | HTMLIFrameElement;\n  protected _api: YT.Player;\n\n  static parseUrl(url: string) {\n    if (this.providerRegexp.test(url)) {\n      const [, id] = url.match(this.idRegexp) || [];\n      return id ? {mediaId: id} : null;\n    }\n    return null;\n  }\n\n  private static _coreApiPromise: Promise<void>;\n  protected static getCoreApi() {\n    if (!YouTubeProvider._coreApiPromise) {\n      YouTubeProvider._coreApiPromise = new Promise((resolve) => {\n        if (window.YT && window.YT.Player) return resolve(window.YT);\n        loadScript('YT_API_SOURCE', '//www.youtube.com/iframe_api');\n        const cbOrigin = window.onYouTubeIframeAPIReady;\n        window.onYouTubeIframeAPIReady = () => {\n          try {\n            (typeof cbOrigin === 'function') && cbOrigin.apply(window);\n          } catch (err) { // eslint-disable-line\n            // Do Nothing\n          }\n          return resolve(window.YT);\n        };\n      });\n    }\n    return YouTubeProvider._coreApiPromise;\n  }\n\n  protected static mapOptions(cfg: MediaProviderConfig): PlayerVars {\n    return {\n      enablejsapi: 1,\n      origin: location.origin,\n      rel: 0,\n      showinfo: 0,\n      iv_load_policy: 0, // eslint-disable-line\n      autoplay: Number(cfg.autoplay),\n      controls: Number(cfg.controls),\n      playsinline: Number(cfg.playsinline),\n      disablekb: Number(!cfg.controls), // TODO: criteria\n      autohide: Number(!cfg.controls) // TODO: criteria\n    };\n  }\n\n  protected static buildIframe(sm: MediaProviderConfig) {\n    const el = document.createElement('div');\n    el.id = 'esl-media-yt-' + randUID();\n    el.className = 'esl-media-inner esl-media-youtube';\n    el.title = sm.title;\n    el.setAttribute('aria-label', el.title);\n    el.setAttribute('frameborder', '0');\n    el.setAttribute('tabindex', '0');\n    el.setAttribute('allowfullscreen', 'yes');\n    return el;\n  }\n\n  public bind() {\n    this._el = YouTubeProvider.buildIframe(this.config);\n    this.component.appendChild(this._el);\n    this._ready = YouTubeProvider.getCoreApi()\n      .then(() => this.onCoreApiReady())\n      .then(() => this.onPlayerReady())\n      .catch((e) => this.component._onError(e));\n  }\n\n  /** Init YT.Player on target element */\n  protected onCoreApiReady() {\n    return new Promise((resolve, reject) => {\n      console.debug('[ESL]: Media Youtube Player initialization for ', this);\n      this._api = new YT.Player(this._el.id, {\n        videoId: this.config.mediaId,\n        events: {\n          onError: (e) => reject(e),\n          onReady: () => resolve(this),\n          onStateChange: (e) => this._onStateChange(e)\n        },\n        playerVars: YouTubeProvider.mapOptions(this.config)\n      });\n    });\n  }\n  /** Post YT.Player init actions */\n  protected onPlayerReady() {\n    console.debug('[ESL]: Media Youtube Player ready ', this);\n    this._el = this._api.getIframe();\n    if (this.config.muted) {\n      this._api.mute();\n    }\n    this.component._onReady();\n  }\n\n  public unbind() {\n    this.component._onDetach();\n    this._api && this._api.destroy();\n    super.unbind();\n  }\n\n  private _onStateChange(event: YT.OnStateChangeEvent) {\n    switch (+event.data) {\n      case PlayerStates.PLAYING:\n        this.component._onPlay();\n        break;\n      case PlayerStates.PAUSED:\n        this.component._onPaused();\n        break;\n      case PlayerStates.ENDED:\n        if (this.config.loop) {\n          this._api.playVideo();\n        } else {\n          this.component._onEnded();\n        }\n        break;\n    }\n  }\n\n  protected onConfigChange(param: ProviderObservedParams, value: boolean) {\n    super.onConfigChange(param, value);\n    if (param === 'muted') {\n      value ? this._api.mute() : this._api.unMute();\n    }\n  }\n\n  public focus() {\n    if (this._el instanceof HTMLIFrameElement && this._el.contentWindow) {\n      this._el.contentWindow.focus();\n    }\n  }\n\n  public get state() {\n    if (this._api && typeof this._api.getPlayerState === 'function') {\n      return this._api.getPlayerState() as number as PlayerStates;\n    }\n    return PlayerStates.UNINITIALIZED;\n  }\n\n  public get duration() {\n    return this._api ? this._api.getDuration() : 0;\n  }\n\n  public get currentTime() {\n    return this._api ? this._api.getCurrentTime() : 0;\n  }\n\n  public get defaultAspectRatio(): number {\n    return DEFAULT_ASPECT_RATIO;\n  }\n\n  public seekTo(pos: number) {\n    this._api.seekTo(pos, false);\n  }\n\n  public play() {\n    if (this.state === PlayerStates.ENDED) {\n      this._api.seekTo(0, false);\n    }\n    this._api.playVideo();\n  }\n\n  public pause() {\n    this._api.pauseVideo();\n  }\n\n  public stop() {\n    this._api.stopVideo();\n  }\n}\n\n// typings\ndeclare global {\n  interface YT extends Promise<void> {\n    Player: YT.Player;\n  }\n\n  interface Window {\n    YT?: YT;\n    onYouTubeIframeAPIReady?: () => void;\n  }\n}\n","import {loadScript} from '../../esl-utils/dom/script';\nimport {BaseProvider, PlayerStates} from '../core/esl-media-provider';\nimport {randUID} from '../../esl-utils/misc/uid';\n\nimport type {ESLMedia} from '../core/esl-media';\nimport type {ProviderObservedParams} from '../core/esl-media-provider';\nimport type {VideoJsPlayer} from 'video.js';\n\nconst API_SCRIPT_ID = 'BC_API_SOURCE';\n\nexport interface BCPlayerAccount {\n  playerId: string | null;\n  accountId: string | null;\n}\n\n/**\n * Brightcove API provider for {@link ESLMedia}\n * @author Julia Murashko\n */\n@BaseProvider.register\nexport class BrightcoveProvider extends BaseProvider {\n  static readonly providerName: string = 'brightcove';\n\n  protected videojsClasses = 'video-js vjs-default-skin video-js-brightcove';\n\n  protected _api: VideoJsPlayer;\n  protected _account: BCPlayerAccount;\n  protected _autoplay: boolean;\n\n  /**\n   * @returns settings, get from element by default\n   */\n  protected static getAccount(el: ESLMedia): BCPlayerAccount {\n    return {\n      playerId: el.getAttribute('player-id'),\n      accountId: el.getAttribute('player-account')\n    };\n  }\n\n  /** Loads player API according defined settings */\n  protected static loadAPI(account: BCPlayerAccount): Promise<Event> {\n    const apiSrc =\n      `//players.brightcove.net/${account.accountId}/${account.playerId}_default/index.min.js`;\n    const apiScript = document.getElementById(API_SCRIPT_ID);\n    if (apiScript && apiScript.parentNode && apiScript.getAttribute('src') !== apiSrc) {\n      apiScript.parentNode.removeChild(apiScript);\n    }\n    return loadScript(API_SCRIPT_ID, apiSrc);\n  }\n\n  /** Build video brightcove element */\n  protected buildVideo() {\n    const el = document.createElement('video-js');\n    el.id = 'esl-media-brightcove-' + randUID();\n    el.className = 'esl-media-inner esl-media-brightcove ' + this.videojsClasses;\n    el.title = this.config.title;\n    el.toggleAttribute('loop', this.config.loop);\n    el.toggleAttribute('muted', this.config.muted);\n    el.toggleAttribute('controls', this.config.controls);\n    el.setAttribute('aria-label', el.title);\n    el.setAttribute('data-embed', 'default');\n    el.setAttribute('data-video-id', `ref:${this.config.mediaId}`);\n    el.toggleAttribute('playsinline', this.config.playsinline);\n    this._account.playerId && el.setAttribute('data-player', this._account.playerId);\n    this._account.accountId && el.setAttribute('data-account', this._account.accountId);\n    return el;\n  }\n\n  /** Utility method to convert api event to promise */\n  protected $$fromEvent(eventName: string): Promise<void> {\n    if (!this._api) return Promise.reject();\n    return new Promise((resolve, reject) => this._api ? this._api.one(eventName, resolve) : reject());\n  }\n\n  /**\n   * Executes as soon as api script detected or loaded.\n   * @returns promise with provided API\n   */\n  protected onAPILoaded(): Promise<void> | void {\n    if (typeof window.bc !== 'function' || typeof window.videojs !== 'function') {\n      throw new Error('Brightcove API is not in the global scope');\n    }\n    console.debug('ESL Media: Brightcove API init for ', this);\n    this._api = window.bc(this._el);\n    return new Promise((resolve, reject) => this._api ? this._api.ready(resolve) : reject());\n  }\n\n  /**\n   * Executes after API ready state resolved\n   * Basic onAPIReady should be called to subscribe to API state\n   */\n  protected onAPIReady(): Promise<void> | void {\n    console.debug('ESL Media: Brightcove API is ready ', this);\n    // Set autoplay though js because BC is unresponsive while processing it natively\n    this._api.autoplay(this._autoplay || this.config.autoplay);\n\n    // Listeners to control player state\n    this._api.on('play', () => this.component._onPlay());\n    this._api.on('pause', () => this.component._onPaused());\n    this._api.on('ended', () => this.component._onEnded());\n    this.component._onReady();\n\n    // Can handle query only when loadedmetadata have happened\n    return this.$$fromEvent('loadedmetadata');\n  }\n\n  public bind() {\n    const Provider = (this.constructor as typeof BrightcoveProvider);\n    this._account = Provider.getAccount(this.component);\n    this._el = this.buildVideo();\n    this.component.appendChild(this._el);\n\n    this._ready = Provider.loadAPI(this._account)\n      .then(() => this.onAPILoaded())\n      .then(() => this.onAPIReady())\n      .catch((e) => this.component._onError(e));\n  }\n\n  public unbind() {\n    this.component._onDetach();\n    this._api && this._api.dispose();\n    super.unbind();\n  }\n\n  protected onConfigChange(param: ProviderObservedParams, value: boolean) {\n    super.onConfigChange(param, value);\n    if (typeof this._api[param] === 'function') {\n      this._api[param](value);\n    }\n  }\n\n  public focus() {\n    this._api && this._api.focus();\n  }\n\n  public get state() {\n    if (this._api) {\n      if (this._api.ended()) return PlayerStates.ENDED;\n      if (this._api.paused()) return PlayerStates.PAUSED;\n      if (!this._api.played()) return PlayerStates.UNSTARTED;\n      return PlayerStates.PLAYING;\n    }\n    return PlayerStates.UNINITIALIZED;\n  }\n\n  public get defaultAspectRatio(): number {\n    if (!this._api) return 0;\n    return this._api.videoWidth() / this._api.videoHeight();\n  }\n\n  public get currentTime() {\n    return this._api ? this._api.currentTime() : 0;\n  }\n\n  public get duration() {\n    return this._api ? this._api.duration() : 0;\n  }\n\n  public seekTo(pos: number) {\n    this._api.currentTime(pos);\n  }\n\n  public play() {\n    this._api.play();\n  }\n\n  public pause() {\n    this._api.pause();\n  }\n\n  public stop() {\n    this._api.currentTime(0);\n    this._api.pause();\n  }\n\n  // Overrides to set tech autoplay marker\n  public safePlay() {\n    this._autoplay = true;\n    return super.safePlay();\n  }\n  public safeStop() {\n    this._autoplay = true;\n    return super.safeStop();\n  }\n}\n\n// root typing\ndeclare global {\n  interface Window {\n    bc?: (el: HTMLElement, ...args: any[]) => VideoJsPlayer;\n  }\n}\n","/**\n * Slide controller\n * @author Julia Murashko\n */\nimport {ESLBaseElement} from '../../../esl-base-element/core';\n\nexport class ESLCarouselSlide extends ESLBaseElement {\n  // TODO: refactor (check type of Element)\n  public get index(): number {\n    if (!this.parentNode) return -1;\n    return Array.prototype.indexOf.call(this.parentNode.children, this);\n  }\n\n  public get active(): boolean {\n    return this.hasAttribute('active');\n  }\n  public _setActive(active: boolean) {\n    this.toggleAttribute('active', active);\n  }\n\n  public get first(): boolean {\n    return this.hasAttribute('first');\n  }\n  public _setFirst(first: boolean) {\n    this.toggleAttribute('first', first);\n  }\n}\n\ndeclare global {\n  export interface HTMLElementTagNameMap {\n    'esl-carousel-slide': ESLCarouselSlide;\n  }\n}\n","import {Observable} from '../../../../esl-utils/abstract/observable';\n\nimport type {ESLCarousel} from '../esl-carousel';\n\nexport abstract class ESLCarouselView {\n  protected readonly carousel: ESLCarousel;\n\n  protected constructor(carousel: ESLCarousel) {\n    this.carousel = carousel; // TODO: unsafe while lifecycle is not clear\n  }\n\n  public abstract bind(): void;\n\n  public abstract draw(): void;\n\n  public abstract goTo(nextIndex: number, direction: string): void;\n\n  public abstract unbind(): void;\n}\n\nexport type ESLCarouselViewConstructor = new(carousel: ESLCarousel) => ESLCarouselView;\n\nlet eslRegistryInstance: ESLCarouselViewRegistry | null = null;\nexport class ESLCarouselViewRegistry extends Observable<(name: string, view: ESLCarouselViewConstructor) => void> {\n  private registry = new Map<string, ESLCarouselViewConstructor>();\n\n  public static get instance() {\n    if (eslRegistryInstance === null) {\n      eslRegistryInstance = new ESLCarouselViewRegistry();\n    }\n    return eslRegistryInstance;\n  }\n\n  public createViewInstance(name: string, carousel: ESLCarousel): ESLCarouselView | null {\n    const View = this.registry.get(name);\n    return View ? new View(carousel) : null;\n  }\n\n  public registerView(name: string, view: ESLCarouselViewConstructor) {\n    if (this.registry.has(name)) {\n      throw new Error(`View with name ${name} already defined`);\n    }\n    this.registry.set(name, view);\n    this.fire(name, view);\n  }\n}\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {ESLBaseElement, attr} from '../../../esl-base-element/core';\nimport {deepCompare} from '../../../esl-utils/misc/object';\nimport {ESLMediaRuleList} from '../../../esl-media-query/core';\nimport {ESLCarouselSlide} from './esl-carousel-slide';\nimport {ESLCarouselViewRegistry} from './view/esl-carousel-view';\n\nimport type {ESLCarouselView} from './view/esl-carousel-view';\nimport type {ESLCarouselPlugin} from '../plugin/esl-carousel-plugin';\n\ninterface CarouselConfig { // Registry\n  view?: string;\n  count?: number;\n  className?: string;\n}\n\n// TODO: add ability to choose the number of an active slide\n@ExportNs('Carousel')\nexport class ESLCarousel extends ESLBaseElement {\n  public static Slide = ESLCarouselSlide;\n\n  public static is = 'esl-carousel';\n\n  static get observedAttributes() {\n    return ['config'];\n  }\n\n  @attr() public config: string;\n\n  private _configRules: ESLMediaRuleList<CarouselConfig | null>;\n  private _currentConfig: CarouselConfig = {};\n  private _view: ESLCarouselView | null;\n  private readonly _plugins = new Map<string, ESLCarouselPlugin>();\n\n  private readonly _onMatchChange: () => void;\n\n  constructor() {\n    super();\n    this._onMatchChange = this.update.bind(this, false);\n    this._onRegistryChange = this._onRegistryChange.bind(this);\n  }\n\n  get $slidesArea(): HTMLElement | null {\n    return this.querySelector('[data-slides-area]');\n  }\n\n  get $slides(): ESLCarouselSlide[] {\n    // TODO cache\n    const els = this.$slidesArea && this.$slidesArea.querySelectorAll(ESLCarouselSlide.is);\n    return els ? Array.from(els) as ESLCarouselSlide[] : [];\n  }\n\n  get count(): number {\n    return this.$slides.length || 0;\n  }\n\n  get activeIndexes(): number[] {\n    return this.$slides.reduce((activeIndexes: number[], el, index) => {\n      if (el.active) {\n        activeIndexes.push(index);\n      }\n      return activeIndexes;\n    }, []);\n  }\n\n  get activeCount(): number {\n    return this.activeConfig.count || 0;\n  }\n\n  /**\n   * @returns number first active index\n   */\n  get firstIndex(): number {\n    const index = this.$slides.findIndex((slide) => {\n      return slide.first;\n    });\n    return Math.max(index, 0);\n  }\n\n  get activeConfig(): CarouselConfig {\n    return this._currentConfig;\n  }\n\n  set activeConfig(config) {\n    this._currentConfig = Object.assign({}, config);\n  }\n\n  // eslint-disable-next-line sonarjs/cognitive-complexity\n  public goTo(nextIndex: number, direction?: string, force: boolean = false) {\n    if (this.dataset.isAnimated) {\n      return;\n    }\n\n    if (nextIndex < 0) {\n      nextIndex = 0;\n    }\n\n    if (this.firstIndex === nextIndex && !force) {\n      return;\n    }\n\n    if (!direction) {\n      // calculate and compare how much slides we have to go due to direction (left or right)\n      // choose less\n      // TODO: optimize\n      if (nextIndex > this.firstIndex) {\n        direction = nextIndex - this.firstIndex > (this.firstIndex - nextIndex + this.count) % this.count ? 'left' : 'right';\n      } else {\n        direction = this.firstIndex - nextIndex >= (nextIndex - this.firstIndex - nextIndex + this.count) % this.count ? 'right' : 'left';\n      }\n    }\n\n    const eventDetails = { // Todo change info\n      bubbles: true,\n      detail: {\n        direction\n      }\n    };\n\n    const approved = this.$$fire('slide:change', eventDetails);\n\n    if (this._view && approved && this.firstIndex !== nextIndex) {\n      this._view.goTo(nextIndex, direction);\n    }\n    if (this._view && approved) {\n      let i = 0;\n      this.$slides.forEach((el, index) => {\n        el._setActive(((nextIndex + this.count) % this.count <= index) && (index < (nextIndex + this.activeCount + this.count) % this.count));\n      });\n\n      while (i < this.activeCount) {\n        const computedIndex = (nextIndex + i + this.count) % this.count;\n        this.$slides[computedIndex]._setActive(true);\n        ++i;\n      }\n\n      if (this.activeConfig.view === 'multiple') {\n        this.$slides[this.firstIndex]._setFirst(false);\n        this.$slides[nextIndex]._setFirst(true);\n      }\n    }\n\n    this.$$fire('slide:changed', eventDetails);\n  }\n\n  public prev() {\n    // const nextGroup = this.getNextGroup(-1);\n    this.goTo((this.firstIndex - this.activeCount + this.count) % this.count, 'left');\n  }\n\n  public next() {\n    // const nextGroup = this.getNextGroup(1);\n    this.goTo((this.firstIndex + this.activeCount + this.count) % this.count, 'right');\n  }\n\n  protected connectedCallback() {\n    super.connectedCallback();\n\n    this.update(true);\n    this.goTo(this.firstIndex, '', true);\n    this._bindEvents();\n\n    ESLCarouselViewRegistry.instance.addListener(this._onRegistryChange);\n  }\n\n  protected disconnectedCallback() {\n    super.disconnectedCallback();\n    this._unbindEvents();\n\n    ESLCarouselViewRegistry.instance.removeListener(this._onRegistryChange);\n  }\n\n  private attributeChangedCallback(attrName: string, oldVal: string, newVal: string) {\n    // TODO: change observed attributes\n    if (attrName === 'config') {\n      this.configRules = ESLMediaRuleList.parse<CarouselConfig>(this.config, ESLMediaRuleList.OBJECT_PARSER);\n      this.update(true);\n    }\n  }\n\n  protected _bindEvents() {\n    this.addEventListener('click', this._onClick, false);\n  }\n\n  protected _unbindEvents() {\n    this.removeEventListener('click', this._onClick, false);\n  }\n\n  get configRules() {\n    if (!this._configRules) {\n      this.configRules = ESLMediaRuleList.parse<CarouselConfig>(this.config, ESLMediaRuleList.OBJECT_PARSER);\n    }\n    return this._configRules;\n  }\n\n  set configRules(rules: ESLMediaRuleList<CarouselConfig | null>) {\n    if (this._configRules) {\n      this._configRules.removeListener(this._onMatchChange);\n    }\n    this._configRules = rules;\n    this._configRules.addListener(this._onMatchChange);\n  }\n\n  private update(force: boolean = false) {\n    const config: CarouselConfig = Object.assign(\n      {view: 'multiple', count: 1},\n      this.configRules.activeValue\n    );\n\n    if (!force && deepCompare(this.activeConfig, config)) {\n      return;\n    }\n    this.activeConfig = config;\n\n    const viewType = this.activeConfig.view;\n    if (!viewType) return;\n\n    // TODO: somehow compare active view & selected view\n    // this._view && this._view.unbind();\n    this._view = ESLCarouselViewRegistry.instance.createViewInstance(viewType, this);\n    // this._view && this._view.bind();\n\n    if (force || this.activeIndexes.length !== this.activeConfig.count) {\n      this._view && this._view.draw();\n      // this.goTo(this.firstIndex, '', true);\n    }\n  }\n\n  private getNextGroup(shiftGroupsCount: number) {\n    // get number of group of current active slides by last index of this group\n    const lastIndex = this.activeIndexes.length - 1;\n    const currentGroup = Math.floor(this.activeIndexes[lastIndex] / this.activeCount);\n    // get count of groups of slides\n    const countGroups = Math.ceil(this.count / this.activeCount);\n    // get number of group of next active slides\n    return (currentGroup + shiftGroupsCount + countGroups) % countGroups;\n  }\n\n  // move to core plugin\n  protected _onClick(event: MouseEvent) {\n    const eventTarget: HTMLElement = event.target as HTMLElement;\n    const markedTarget: HTMLElement | null = eventTarget.closest('[data-slide-target]');\n    if (markedTarget && markedTarget.dataset.slideTarget) {\n      const target = markedTarget.dataset.slideTarget;\n      if ('prev' === target) {\n        this.prev();\n      } else if ('next' === target) {\n        this.next();\n      } else if ('g' === target[0]) {\n        const group = +(target.substr(1)) - 1;\n        const lastGroup = Math.floor(this.count / this.activeCount);\n        this.goTo(group === lastGroup ? this.count - this.activeCount : this.activeCount * group);\n      } else {\n        this.goTo(+target - 1);\n      }\n    }\n  }\n\n  protected _onRegistryChange() {\n    if (!this._view) this.update(true);\n  }\n\n  // Plugin management\n  public addPlugin(plugin: ESLCarouselPlugin) {\n    if (plugin.carousel) return;\n    this.appendChild(plugin);\n  }\n\n  public removePlugin(plugin: ESLCarouselPlugin | string | undefined) {\n    if (typeof plugin === 'string') plugin = this._plugins.get(plugin);\n    if (!plugin || plugin.carousel !== this) return;\n    plugin.parentNode && plugin.parentNode.removeChild(plugin);\n  }\n\n  public _addPlugin(plugin: ESLCarouselPlugin) {\n    if (this._plugins.has(plugin.key)) return;\n    this._plugins.set(plugin.key, plugin);\n    if (this.isConnected) plugin.bind();\n  }\n\n  public _removePlugin(plugin: ESLCarouselPlugin) {\n    if (!this._plugins.has(plugin.key)) return;\n    plugin.unbind();\n    this._plugins.delete(plugin.key);\n  }\n\n  public static register(tagName?: string) {\n    ESLCarouselSlide.register((tagName || ESLCarousel.is) + '-slide');\n    customElements.whenDefined(ESLCarouselSlide.is).then(() => super.register.call(this, tagName));\n  }\n}\n\ndeclare global {\n  export interface ESLCarouselPlugins {}\n  export interface ESLLibrary {\n    Carousel: typeof ESLCarousel;\n    CarouselPlugin: typeof ESLCarouselPlugin;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-carousel': ESLCarousel;\n  }\n}\n","import {ESLCarouselView, ESLCarouselViewRegistry} from './esl-carousel-view';\n\nimport type {ESLCarousel} from '../esl-carousel';\n\nclass ESLSingleCarouselView extends ESLCarouselView {\n\n  public constructor(carousel: ESLCarousel) {\n    super(carousel);\n  }\n\n  public bind() {}\n\n  // TODO: check\n  public draw() {\n    const {$slides, $slidesArea} = this.carousel;\n    if (!$slidesArea || !$slides.length) return;\n\n    const slideStyles = getComputedStyle($slides[this.carousel.firstIndex]);\n    const slidesAreaStyles = getComputedStyle($slidesArea);\n\n    const slideWidth = parseFloat(slidesAreaStyles.width) - parseFloat(slideStyles.marginLeft) - parseFloat(slideStyles.marginRight);\n    const computedLeft = -(parseFloat(slidesAreaStyles.width) / this.carousel.firstIndex);\n\n    $slides.forEach((slide) => {\n      slide.style.minWidth = slideWidth + 'px';\n      slide.style.left = computedLeft + 'px';\n    });\n  }\n\n  public goTo(nextIndex: number, direction: string) {\n    if (this.carousel.firstIndex === nextIndex) {\n      return;\n    }\n\n    this.carousel.setAttribute('data-is-animated', 'true');\n    this.carousel.setAttribute('direction', direction);\n\n    const activeSlide = this.carousel.$slides[this.carousel.firstIndex];\n    const nextSlide = this.carousel.$slides[nextIndex];\n\n    activeSlide.classList.add(direction);\n    nextSlide.classList.add(direction);\n\n    activeSlide.classList.add('prev');\n\n    activeSlide.addEventListener('animationend', (e) => this._cleanAnimation(e));\n    nextSlide.addEventListener('animationend', (e) => this._cleanAnimation(e));\n  }\n\n  private _cleanAnimation(event: Event) {\n    const target = event.target as HTMLElement;\n    const direction = this.carousel.getAttribute('direction');\n\n    direction && target.classList.remove(direction);\n    target.classList.remove('prev');\n\n    this.carousel.removeAttribute('data-is-animated');\n  }\n\n  // tslint:disable-next-line:no-empty\n  public unbind() {\n  }\n}\n\nESLCarouselViewRegistry.instance.registerView('single', ESLSingleCarouselView);\n","import {ESLCarouselView, ESLCarouselViewRegistry} from './esl-carousel-view';\n\nimport type {ESLCarousel} from '../esl-carousel';\n\nclass ESLMultiCarouselView extends ESLCarouselView {\n\n  public constructor(carousel: ESLCarousel) {\n    super(carousel);\n  }\n\n  // tslint:disable-next-line:no-empty\n  public bind() {\n  }\n\n  public draw() {\n    const {$slides, $slidesArea} = this.carousel;\n    if (!$slidesArea || !$slides.length) return;\n\n    const slideStyles = getComputedStyle($slides[this.carousel.firstIndex]);\n    const currentTrans = slideStyles.transform !== 'none' ? parseFloat(slideStyles.transform.split(',')[4]) : 0;\n    const slidesAreaStyles = getComputedStyle($slidesArea);\n\n    const slideWidth = parseFloat(slidesAreaStyles.width) / this.carousel.activeCount\n      - parseFloat(slideStyles.marginLeft) - parseFloat(slideStyles.marginRight);\n    const computedLeft = this.carousel.firstIndex === 0 ?\n      -currentTrans :\n      -(parseFloat(slidesAreaStyles.width) / this.carousel.activeCount * this.carousel.firstIndex) - currentTrans;\n\n\n    $slides.forEach((slide) => {\n      slide.style.minWidth = slideWidth + 'px';\n      slide.style.left = computedLeft + 'px';\n    });\n  }\n\n  // eslint-disable-next-line sonarjs/cognitive-complexity\n  public goTo(nextIndex: number, direction: string) {\n    const slideIndex = direction === 'right' ? this.carousel.activeIndexes[0] : this.carousel.firstIndex;\n    const slideStyles = getComputedStyle(this.carousel.$slides[slideIndex]);\n    const slideWidth = parseFloat(slideStyles.width) +\n      parseFloat(slideStyles.marginLeft) +\n      parseFloat(slideStyles.marginRight);\n    const areaWidth = slideWidth * this.carousel.$slides.length;\n\n    const transitionDuration = parseFloat(slideStyles.transitionDuration) * 1000; // ms\n    const currentLeft = parseFloat(slideStyles.left);\n    const currentTrans = parseFloat(slideStyles.transform.split(',')[4]) || 0;\n\n    if (this.carousel.firstIndex === nextIndex) {\n      return 0;\n    }\n\n    let shiftCount = 0;\n    if (direction === 'left') {\n      shiftCount = (this.carousel.firstIndex - nextIndex + this.carousel.count) % this.carousel.count;\n    } else if (direction === 'right') {\n      shiftCount = (this.carousel.count - this.carousel.firstIndex + nextIndex) % this.carousel.count;\n    }\n    const direct = direction === 'left' ? -1 : 1;\n    const trans = currentTrans - (shiftCount * slideWidth) * direct;\n\n    const nextActiveIndexes: number[] = [];\n    for (let i = 0; i < this.carousel.activeCount; ++i) {\n      nextActiveIndexes.push((nextIndex + i + this.carousel.count) % this.carousel.count);\n    }\n\n    const intersectionIndexes = nextActiveIndexes.filter(\n      (index: number) => this.carousel.activeIndexes.includes(index)\n    );\n\n    let left = 0;\n    const animatedCount = shiftCount < this.carousel.activeCount ? this.carousel.activeCount : shiftCount;\n    for (let i = 0; i < animatedCount; ++i) {\n      const computedIndex = (nextIndex + i + this.carousel.count) % this.carousel.count;\n      const minActive = Math.min(...this.carousel.activeIndexes);\n      // make next active slides be in one line\n      if (computedIndex >= this.carousel.firstIndex && direction === 'left') {\n        left = currentLeft - areaWidth;\n      } else if (computedIndex <= minActive && direction === 'right') {\n        left = currentLeft + areaWidth;\n      } else {\n        left = currentLeft;\n      }\n\n      // exclude slides that are active now and have to be active then\n      if (!intersectionIndexes.includes(computedIndex)) {\n        this.carousel.$slides[computedIndex].style.left = left + 'px';\n      }\n\n      // handle slides that are active now and have to be active then\n      if (intersectionIndexes.includes(computedIndex)) {\n        const orderIndex = nextActiveIndexes.indexOf(computedIndex);\n        const time = (direction === 'right') ?\n          (transitionDuration / this.carousel.activeCount) * orderIndex :\n          (transitionDuration / this.carousel.activeCount) * (this.carousel.activeCount - orderIndex - 1);\n        const copyLeft = left;\n        setTimeout(() => {\n          this.carousel.$slides[computedIndex].style.left = copyLeft + 'px';\n        }, time);\n      }\n\n    }\n\n    this.carousel.$slides.forEach((slide) => {\n      // exclude slides that are active now and have to be active then\n\n      slide.style.transform = `translateX(${trans}px)`;\n\n      // handle slides that are active now and have to be active then\n      const sIndex = slide.index;\n      if (intersectionIndexes.includes(sIndex)) {\n        const orderIndex = nextActiveIndexes.indexOf(sIndex);\n        const time = (direction === 'right') ?\n          (transitionDuration / this.carousel.activeCount) * orderIndex :\n          (transitionDuration / this.carousel.activeCount) * (this.carousel.activeCount - orderIndex - 1);\n        setTimeout(() => {\n          this.carousel.$slides[sIndex].style.transform = `translateX(${trans}px)`;\n        }, time);\n      }\n    });\n\n    this.carousel.setAttribute('data-is-animated', 'true');\n\n    setTimeout(() => {\n      this.carousel.removeAttribute('data-is-animated');\n    }, transitionDuration);\n\n  }\n\n  public unbind() {\n    this.carousel.$slides.forEach((el) => {\n      el.style.transform = 'none';\n      el.style.left = 'none';\n    });\n  }\n}\n\nESLCarouselViewRegistry.instance.registerView('multiple', ESLMultiCarouselView);\n","import {ESLBaseElement} from '../../../esl-base-element/core';\nimport {ESLCarousel} from '../core/esl-carousel';\n\n/**\n * {@link ESLCarousel} Plugin base class.\n * The ESL Carousel Plugin should have the dom representation so it's extends {@link ESLBaseElement}\n * Use the attributes to path the plugin options, the same as with any custom elements.\n */\nexport abstract class ESLCarouselPlugin extends ESLBaseElement {\n  /**\n   * Marker to define the restriction for the plugin placement.\n   * If freePlacement is false - plugin element should be child of ESLCarousel element.\n   * If freePlacement is true - plugin can be placed anywhere inside of carousel.\n   */\n  public static freePlacement = false;\n\n  /**\n   * @returns carousel owner of the plugin\n   */\n  protected findCarouselOwner(): ESLCarousel | null {\n    if ((this.constructor as typeof ESLCarouselPlugin).freePlacement) {\n      return this.closest(ESLCarousel.is);\n    } else {\n      return this.parentNode as ESLCarousel;\n    }\n  }\n\n  private _carousel?: ESLCarousel;\n\n  /**\n   * @returns plugin unique key, ESLCarousel can not own more then one plugin with the same key\n   */\n  public get key() {\n    return this.nodeName.toLowerCase();\n  }\n  /**\n   * @returns owner of plugin\n   */\n  public get carousel(): ESLCarousel {\n    return this._carousel!;\n  }\n\n  protected connectedCallback() {\n    const carousel = this.findCarouselOwner();\n    if (carousel instanceof ESLCarousel) {\n      this._carousel = carousel;\n      this._carousel._addPlugin(this);\n    } else {\n      throw new Error('Invalid esl-carousel-plugin placement: plugin element should be placed under the esl-carousel node');\n    }\n  }\n  protected disconnectedCallback() {\n    if (this.carousel) {\n      this.carousel._removePlugin(this);\n      delete this._carousel;\n    }\n  }\n\n  /**\n   * Define the plugin bind lifecycle hook.\n   * Unlike {@link connectedCallback}, bind is called by owner ESL Carousel when the plugin can be attached.\n   */\n  public abstract bind(): void;\n\n  /**\n   * Define the plugin unbind lifecycle hook.\n   * Unlike {@link disconnectedCallback}, unbind is called by owner ESL Carousel when the plugin should be detached.\n   */\n  public abstract unbind(): void;\n\n  public static register(tagName?: string) {\n    customElements.whenDefined(ESLCarousel.is).then(() => super.register.call(this, tagName));\n  }\n}\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {ESLCarouselPlugin} from './esl-carousel-plugin';\n\n/**\n * Slide Carousel Dots plugin\n * Dots plugin renders carousel dots navigation\n *\n * @author Julia Murashko\n */\n@ExportNs('CarouselPlugins.Dots')\nexport class ESLCarouselDotsPlugin extends ESLCarouselPlugin {\n  public static is = 'esl-carousel-dots';\n  public static freePlacement = true;\n\n  private _onUpdate = () => this.rerender();\n\n  public bind() {\n    this.rerender();\n    this.carousel.addEventListener('esl:slide:changed', this._onUpdate);\n  }\n\n  public unbind() {\n    this.innerHTML = '';\n    this.carousel.removeEventListener('esl:slide:changed', this._onUpdate);\n  }\n\n  public rerender() {\n    let html = '';\n    const activeDot = Math.floor(this.carousel.activeIndexes[this.carousel.activeCount - 1] / this.carousel.activeCount);\n    for (let i = 0; i < Math.ceil(this.carousel.count / this.carousel.activeCount); ++i) {\n      html += this.buildDot(i, i === activeDot);\n    }\n    this.innerHTML = html;\n  }\n\n  public buildDot(index: number, isActive: boolean) {\n    return `<button role=\"button\" class=\"carousel-dot ${isActive ? 'active-dot' : ''}\" data-slide-target=\"g${index + 1}\"></button>`;\n  }\n}\n\ndeclare global {\n  export interface ESLCarouselPlugins {\n    Dots: typeof ESLCarouselDotsPlugin;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-carousel-dots': ESLCarouselDotsPlugin;\n  }\n}\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {attr} from '../../../esl-base-element/core';\nimport {ESLCarousel} from '../core/esl-carousel';\nimport {ESLCarouselPlugin} from './esl-carousel-plugin';\n\n/**\n * Slide Carousel Link plugin. Allows to bind carousel positions.\n */\n@ExportNs('CarouselPlugins.Link')\nexport class ESLCarouselLinkPlugin extends ESLCarouselPlugin {\n  public static is = 'esl-carousel-link-plugin';\n\n  public static get observedAttributes() {\n    return ['to', 'direction'];\n  }\n\n  @attr() public to: string;\n  @attr({defaultValue: 'both'}) public direction: string;\n\n  private _target: ESLCarousel | null;\n\n  constructor() {\n    super();\n    this._onSlideChange = this._onSlideChange.bind(this);\n  }\n\n  public bind() {\n    if (!this.target) {\n      this.target = document.querySelector(this.to);\n    }\n    if (!(this.target instanceof ESLCarousel)) return;\n\n    if (this.direction === 'both' || this.direction === 'reverse') {\n      this.target.addEventListener('esl:slide:changed', this._onSlideChange);\n    }\n    if (this.direction === 'both' || this.direction === 'target') {\n      this.carousel.addEventListener('esl:slide:changed', this._onSlideChange);\n    }\n  }\n\n  public unbind() {\n    this.target && this.target.removeEventListener('esl:slide:changed', this._onSlideChange);\n    this.carousel && this.carousel.removeEventListener('esl:slide:changed', this._onSlideChange);\n  }\n\n  protected _onSlideChange(e: CustomEvent) {\n    if (!this.target || !this.carousel) return;\n    const $target = e.target === this.carousel ? this.target : this.carousel;\n    const $source = e.target === this.carousel ? this.carousel : this.target;\n    $target.goTo($source.firstIndex, e.detail.direction);\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string) {\n    if (this.carousel && oldVal !== newVal) {\n      this.unbind();\n      if (attrName === 'to') {\n        this._target = null;\n      }\n      this.bind();\n    }\n  }\n\n  get target() {\n    return this._target;\n  }\n  set target(target) {\n    this._target = target;\n  }\n}\n\ndeclare global {\n  export interface ESLCarouselPlugins {\n    Link: typeof ESLCarouselLinkPlugin;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-carousel-link-plugin': ESLCarouselLinkPlugin;\n  }\n}\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {DeviceDetector} from '../../../esl-utils/environment/device-detector';\nimport {EventUtils} from '../../../esl-utils/dom/events';\nimport {ESLCarouselPlugin} from './esl-carousel-plugin';\n\nimport type {Point} from '../../../esl-utils/dom/events';\n\n/**\n * Slide Carousel Touch plugin\n */\n@ExportNs('CarouselPlugins.Touch')\nexport class ESLCarouselTouchPlugin extends ESLCarouselPlugin {\n  public static is = 'esl-carousel-touch-plugin';\n\n  private isTouchStarted = false;\n  private startPoint: Point = {x: 0, y: 0};\n\n  public bind() {\n    const events = DeviceDetector.TOUCH_EVENTS;\n\n    this.carousel.addEventListener(events.START, this.onTouchStart);\n    this.carousel.addEventListener(events.MOVE, this.onTouchMove);\n    this.carousel.addEventListener(events.END, this.onTouchEnd);\n  }\n\n  public unbind() {\n    const events = DeviceDetector.TOUCH_EVENTS;\n\n    this.carousel.removeEventListener(events.START, this.onTouchStart);\n    this.carousel.removeEventListener(events.MOVE, this.onTouchMove);\n    this.carousel.removeEventListener(events.END, this.onTouchEnd);\n  }\n\n  onTouchStart = (event: TouchEvent | PointerEvent) => {\n    // TODO: precondition for focused element ?\n    if ((event instanceof TouchEvent && event.touches.length !== 1) ||\n      (event instanceof PointerEvent && event.pointerType !== 'touch')) {\n      this.isTouchStarted = false;\n      return;\n    }\n    this.isTouchStarted = true;\n    this.startPoint = EventUtils.normalizeTouchPoint(event);\n  };\n\n  onTouchMove = (event: TouchEvent | PointerEvent) => {\n    if (!this.isTouchStarted) return;\n    // const point = EventUtils.normalizeTouchPoint(event);\n    // const offset = {\n    // \tx: point.x - this.startPoint.x,\n    // \ty: point.y - this.startPoint.y\n    // };\n  };\n\n  onTouchEnd = (event: TouchEvent | PointerEvent) => {\n    if (!this.isTouchStarted) return;\n    const point = EventUtils.normalizeTouchPoint(event);\n    const offset = {\n      x: point.x - this.startPoint.x,\n      y: point.y - this.startPoint.y\n    };\n    this.isTouchStarted = false;\n\n    // TODO: temporary, update according final implementation\n    if (Math.abs(offset.x) < Math.abs(offset.y)) return; // Direction\n    if (Math.abs(offset.x) < 100) return; // Tolerance\n\n    // Swipe gesture example\n    if (offset.x < 0) {\n      this.carousel.next();\n    } else {\n      this.carousel.prev();\n    }\n    event.preventDefault();\n    event.stopPropagation();\n  };\n}\n\ndeclare global {\n  export interface ESLCarouselPlugins {\n    Touch: typeof ESLCarouselTouchPlugin;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-carousel-touch-plugin': ESLCarouselTouchPlugin;\n  }\n}\n","// Views\nimport './core/view/esl-single-carousel-view';\nimport './core/view/esl-multi-carousel-view';\n\nexport * from './core/esl-carousel';\n\n// Plugins\nimport {ESLCarouselDotsPlugin} from './plugin/esl-carousel-dots.plugin';\nimport {ESLCarouselLinkPlugin} from './plugin/esl-carousel-link.plugin';\nimport {ESLCarouselTouchPlugin} from './plugin/esl-carousel-touch.plugin';\nimport {ESLCarouselAutoplayPlugin} from './plugin/esl-carousel-autoplay.plugin';\n\n// TODO: ??\nexport const ESLCarouselPlugins = {\n  Dots: ESLCarouselDotsPlugin,\n  Link: ESLCarouselLinkPlugin,\n  Touch: ESLCarouselTouchPlugin,\n  Autoplay: ESLCarouselAutoplayPlugin\n};\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {attr} from '../../../esl-base-element/core';\nimport {ESLCarouselPlugin} from './esl-carousel-plugin';\n\n/**\n * Slide Carousel Autoplay (Auto-Advance) plugin\n * Automatically switch slides by timeout\n *\n * @author Alexey Stsefanovich (ala'n)\n */\n@ExportNs('CarouselPlugins.Autoplay')\nexport class ESLCarouselAutoplayPlugin extends ESLCarouselPlugin {\n  public static is = 'esl-carousel-autoplay-plugin';\n\n  @attr({defaultValue: 'next'}) public direction: string;\n  @attr({defaultValue: '5000'}) public timeout: number;\n\n  private _active: boolean;\n  private _timeout: number | null = null;\n\n  constructor() {\n    super();\n    this._onInterval = this._onInterval.bind(this);\n    this._onInteract = this._onInteract.bind(this);\n  }\n\n  public get active() {\n    return this._active;\n  }\n\n  public bind(): void {\n    this.carousel.addEventListener('mouseover', this._onInteract);\n    this.carousel.addEventListener('mouseout', this._onInteract);\n    this.carousel.addEventListener('focusin', this._onInteract);\n    this.carousel.addEventListener('focusout', this._onInteract);\n    this.carousel.addEventListener('esl:slide:changed', this._onInteract);\n    this.start();\n    // console.log('Auto-advance plugin attached successfully to ', this.carousel);\n  }\n  public unbind(): void {\n    this.carousel.removeEventListener('mouseover', this._onInteract);\n    this.carousel.removeEventListener('mouseout', this._onInteract);\n    this.carousel.removeEventListener('focusin', this._onInteract);\n    this.carousel.removeEventListener('focusout', this._onInteract);\n    this.carousel.removeEventListener('esl:slide:changed', this._onInteract);\n    this.stop();\n    // console.log('Auto-advance plugin detached successfully from ', this.carousel);\n  }\n\n  public start() {\n    this._active = true;\n    this.reset();\n  }\n  public stop() {\n    this._active = false;\n    this.reset();\n  }\n\n  public reset() {\n    if (typeof this._timeout === 'number') clearTimeout(this._timeout);\n    this._timeout = this._active ? window.setTimeout(this._onInterval, this.timeout) : null;\n  }\n\n  protected _onInterval() {\n    if (!this._active) return;\n    switch (this.direction) {\n      case 'next':\n        this.carousel.next();\n        return;\n      case 'prev':\n        this.carousel.prev();\n        return;\n    }\n    this.reset();\n  }\n\n  protected _onInteract(e: Event) {\n    switch (e.type) {\n      case 'mouseover':\n      case 'focusin':\n        this.stop();\n        return;\n      case 'mouseout':\n      case 'focusout':\n        this.start();\n        return;\n      case 'esl:slide:changed':\n        this.reset();\n        return;\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLCarouselPlugins {\n    Autoplay: typeof ESLCarouselAutoplayPlugin;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-carousel-autoplay-plugin': ESLCarouselAutoplayPlugin;\n  }\n}\n","// Support for ES5 bundle target\nimport '../../src/polyfills/es5-target-shim';\n// Builtin polyfills\nimport '../../src/polyfills/polyfills.es6';\n// Validate environment\nimport '../../src/polyfills/polyfills.validate';\n\nimport './common/test-media';\nimport './common/test-media-source';\n\n// With Namespace\nimport '../../src/modules/lib';\n\nimport {\n  ESLImage,\n  ESLMedia,\n  ESLToggleable,\n  ESLPopup,\n  ESLPanel,\n  ESLPanelGroup,\n  ESLTrigger,\n  ESLA11yGroup,\n  ESLTabs,\n  ESLTab,\n  ESLScrollbar,\n  ESLAlert,\n  ESLToggleableDispatcher,\n  ESLSelect,\n  ESLSelectList,\n  ESLNote,\n  ESLFootnotes,\n  ESLTooltip\n} from '../../src/modules/all';\n\nimport '../../src/modules/esl-media/providers/iframe-provider';\nimport '../../src/modules/esl-media/providers/html5/audio-provider';\nimport '../../src/modules/esl-media/providers/html5/video-provider';\nimport '../../src/modules/esl-media/providers/youtube-provider';\nimport '../../src/modules/esl-media/providers/brightcove-provider';\n\nimport {\n  ESLCarousel,\n  ESLCarouselPlugins\n} from '../../src/modules/draft/all';\n\nESLImage.register();\nESLMedia.register();\n\nESLToggleableDispatcher.init();\nESLToggleable.register();\nESLPopup.register();\n\nESLPanelGroup.register();\nESLPanel.register();\n\nESLTrigger.register();\nESLTab.register();\n\nESLA11yGroup.register();\nESLTabs.register();\n\nESLScrollbar.register();\nESLAlert.register();\nESLAlert.init();\n\nESLSelectList.register();\nESLSelect.register();\n\nESLFootnotes.register();\nESLNote.register();\nESLTooltip.register();\n\nESLCarousel.register();\nESLCarouselPlugins.Dots.register();\nESLCarouselPlugins.Link.register();\nESLCarouselPlugins.Touch.register();\nESLCarouselPlugins.Autoplay.register();\n"],"names":["targetSel","this","getAttribute","Array","from","document","querySelectorAll","TestMediaControls","ACTIONS_ALL","render","actionList","actions","split","innerHTML","actionName","action","ACTIONS","appendChild","onClick","e","target","dataset","forEach","$el","call","connectedCallback","addEventListener","bind","play","title","renderButton","pause","stop","Object","keys","join","HTMLElement","btn","createElement","className","textContent","customElements","define","Element","prototype","toggleAttribute","name","force","has","hasAttribute","state","setAttribute","removeAttribute","KeyboardEventProto","desc","getOwnPropertyDescriptor","keyMap","Win","Scroll","Spacebar","Down","Left","Right","Up","Del","Apps","Esc","Multiply","Add","Subtract","Decimal","Divide","defineProperty","get","key","hasOwnProperty","KeyboardEvent","Node","ownerDocument","compareDocumentPosition","DOCUMENT_POSITION_DISCONNECTED","window","Error","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","g","globalThis","Function","promisifyTimeout","timeout","payload","Promise","resolve","setTimeout","promisifyEvent","event","options","reject","eventCallback","removeEventListener","promisifyMarker","marker","then","tryUntil","callback","tryCount","check","result","createDeferred","promise","res","rej","resolvePromise","arg","rejectPromise","debounce","fn","wait","deferred","debouncedSubject","clearTimeout","apply","args","writable","enumerable","value","BuiltInHTMLElement","Reflect","polyfillWrapFlushCallback","construct","constructor","setPrototypeOf","shimES5ElementConstructor","fromTimeout","fromEvent","fromMarker","querySelector","form","onChange","inputs","input","HTMLInputElement","type","checked","TestMediaSource","ExportNs","root","reduce","obj","index","parts","length","exportNs","propertyKey","descriptor","TypeError","configurable","bindings","WeakMap","set","declare","wrap","arr","isArray","lockStore","add","el","locker","CSSClassUtils","remove","substr","elLocks","Map","classLocks","Set","lock","classList","delete","size","unlock","splitTokens","tokenString","filter","str","els","cls","tokens","toggle","isObject","isPrimitive","deepCompare","obj1","obj2","is","keys1","keys2","some","getPropertyDescriptor","o","prop","proto","getPrototypeOf","defined","params","param","toKebabCase","replace","toLowerCase","unwrapParenthesis","trim","parseNumber","nanValue","NaN","isNaN","evaluate","defaultValue","console","warn","DEF_FORMAT_MATCHER","format","source","matcher","match","data","val","curr","attr","config","assign","propName","attrName","dataAttr","buildAttrName","readOnly","buildSimpleDescriptor","readonly","boolAttr","buildConditionalDescriptor","dispatch","eventName","eventInit","init","bubbles","composed","cancelable","dispatchEvent","CustomEvent","targets","composedPath","normalizeTouchPoint","TouchEvent","changedTouches","x","pageX","y","pageY","normalizeCoordinates","elem","props","getBoundingClientRect","top","pageYOffset","left","pageXOffset","stopPropagation","preventDefault","_connected","disconnectedCallback","$$fire","EventUtils","register","tagName","whenDefined","_listeners","addListener","listener","removeListener","fire","error","memoizeFn","hashFn","memo","cache","clear","defaultArgsHashFn","String","memoize","originalMethod","locks","defineOwnKeySafe","memoizeGetter","memoizeMethod","property","navigator","userAgent","vendor","platform","DeviceDetector","navApi","maxTouchPoints","msMaxTouchPoints","Touch","matchMedia","matches","isTouch","isTouchDevice","START","MOVE","END","isTrident","test","isIE","isEdgeHTML","isBlinkEdge","isEdge","isGecko","isFirefox","isOpera","isChrome","isWebkit","isSafari","isBlink","isBot","isAndroid","isMobileIOS13","isMobileIOS","isLegacyMobile","isMobile","isMobileSafari","ESLScreenDPR","toDPI","dpr","toFixed","process","VALUE_REGEXP","parseFloat","ignoreBotsDpr","registry","ESLScreenBreakpoints","minWidth","maxWidth","BP_NAME_REGEXP","current","ESLScreenBreakpoint","push","term","BP_REGEXP","sign","bp","shortcut","mediaQueryGE","mediaQueryLE","mediaQuery","min","max","toString","shortcuts","includes","_shortcuts","ESLEnvShortcuts","_matches","cb","optimize","eq","ALL","MediaQueryConstCondition","NOT_ALL","query","inverted","_inverted","_mq","media","items","_onChildChange","item","Observable","every","optimizedItems","map","MediaQueryConjunction","MediaQueryContainer","MediaQueryDisjunction","pretty","ESLMediaQuery","use","preprocessor","_preprocessors","unshift","for","conjunctions","conditions","parseSimpleQuery","preprocess","SHORTCUT_PATTERN","queryInverted","processedQuery","sanitizedQuery","invert","MediaQueryCondition","iObserver","_query","_default","_payload","parse","lex","parser","payloadValue","ESLMediaRule","all","default","empty","rules","_rules","rule","_onMatchChanged","ESLMediaRuleList","STRING_PARSER","part","parseTuple","values","mask","valueList","i","_active","activeRule","satisfiedRules","active","OBJECT_PARSER","isRelative","nodeA","nodeB","contains","closestBy","node","predicate","skipSelf","parentNode","createSequenceFinder","next","base","sel","findAll","findChildren","children","findNext","TraversingUtils","nextElementSibling","findPrev","previousElementSibling","findParent","parentElement","TraversingQuery","ELEMENT_PROCESSORS","concat","COLLECTION_PROCESSORS","RegExp","isCollectionProcessor","processElement","selString","processCollection","traverseChain","collection","processors","findFirst","processor","rest","processedItem","resultCollection","slice","uniq","traverse","PROCESSORS_REGEX","rootSel","shift","baseCollection","initial","acc","first","list","getIObserver","IntersectionObserver","entries","handleViewport","threshold","rootMargin","entry","image","ESLImage","isIntersecting","intersectionRatio","triggerLoad","STRATEGIES","img","shadowImg","src","isEmpty","isEmptyImage","style","backgroundImage","width","paddingTop","height","innerImg","attachInnerImage","removeInnerImage","devicePixelRatio","request","XMLHttpRequest","open","onreadystatechange","readyState","status","tmp","responseText","send","alt","updateA11y","srcRules","_onMediaMatchChange","lazyObservable","observe","_detachLazyTrigger","unobserve","refresh","_srcRules","attributeChangedCallback","oldVal","newVal","connected","changeMode","lazyTriggered","update","_currentSrc","lazy","_shadowImageElement","mode","clearImage","loaded","syncImage","canUpdate","getPath","activeValue","ready","_shadowImg","refreshOnUpdate","complete","_shadowImgError","_onError","_onLoad","role","innerImage","srcBase","EMPTY_IMAGE","updateContainerClasses","strategy","_strategy","_innerImg","innerImageClass","cloneNode","removeChild","Image","onload","onerror","naturalHeight","_onReadyState","successful","containerClass","DEFAULT_CONTAINER_CLS","isLoadState","containerClassState","targetEl","containerClassTarget","ESLBaseElement","afterNextRender","requestAnimationFrame","rafDecorator","lastArgs","ENTER","SPACE","PAUSE","ARROW_LEFT","ARROW_UP","ARROW_RIGHT","ARROW_DOWN","video","ESLMedia","autoplay","PlayerStates","evRegistryInstance","providersMap","ESLMediaProviderRegistry","provider","providerName","findByName","createFor","createByType","createBySrc","mediaType","_create","providers","reverse","cfg","parseUrl","mediaSrc","parseConfig","component","url","loop","muted","controls","preload","playsinline","mediaId","_ready","catch","log","unbind","focus","_el","onConfigChange","setSize","setProperty","PAUSED","UNSTARTED","VIDEO_CUED","onSafeConfigChange","safeSeekTo","pos","seekTo","safePlay","safePause","safeStop","safeToggle","BaseProvider","instance","managerMap","registerPlay","group","unregister","deferredResize","_onResize","deferredReinitialize","reinitInstance","supports","bindEvents","attachViewportConstraint","unbindEvents","detachViewportConstraint","_provider","playInViewport","_onRegistryStateChange","conditionQuery","fillModeEnabled","_onRefresh","_onKeydown","canActivate","disabled","debug","updateContainerMarkers","loadClsTarget","loadClsAccepted","loadClsDeclined","allowActivate","cancel","focusPlayer","_onReady","updateReadyClass","detail","setReadyState","_onDetach","_onPlay","autofocus","MediaGroupRestrictionManager","_onPaused","_onEnded","actualAspectRatio","stretchVertically","offsetWidth","offsetHeight","fillMode","providerType","readyClassTarget","readyClass","UNINITIALIZED","duration","currentTime","time","_conditionQuery","aspectRatio","w","h","parseAspectRatio","defaultAspectRatio","observer","ns","eventNs","_fn","_timeout","run","put","task","delay","prev","jsonAttr","serializedValue","JSON","stringify","buildJsonAttrDescriptor","activators","_open","_task","DelayedTask","_trackHover","initiallyOpened","setInitialState","initiator","showDelay","hideDelay","oldGroupName","newGroupName","initialParams","_onClick","_onKeyboardEvent","bindOutsideEventTracking","bindHoverStateTracking","track","body","_onOutsideAction","hasHover","_trackHoverDelay","_onMouseEnter","_onMouseLeave","mergeDefaultParams","defaultParams","copy","show","hide","showTask","closeOnOutsideAction","trackHover","hideTask","silent","activator","onShow","onHide","activeClass","bodyClass","$a11yTarget","closeTrigger","closest","closeOnEsc","baseParams","trackHoverParams","ESLToggleable","_popups","getElementsByTagName","insertAdjacentElement","_onBeforeShow","_onShow","_onHide","_onChangeGroup","_root","isAcceptable","groupName","hideActive","getActive","dispatcher","setActive","popup","deleteActive","ESLToggleableDispatcher","onDocumentReady","prototypeConfig","rect","grow","increment","shrink","decrement","getNodeName","element","Window","getParentNode","ShadowRoot","host","assignedSlot","documentElement","getDocumentElement","$html","initiatorSet","getListScrollParents","scrollParent","getScrollParent","isBody","isScrollParent","updatedList","indexOf","getComputedStyle","overflow","overflowX","overflowY","hasVerticalScroll","scrollHeight","clientHeight","hasScroll","ScrollUtils","requestLock","requestUnlock","_deferredUpdatePosition","_updatePosition","_intersectionRatio","$arrow","position","behavior","_offsetTrigger","offsetTrigger","_offsetWindow","offsetWindow","visibility","_addActivatorObserver","_removeActivatorObserver","_checkIntersectionForAdjacentAxis","isAdjacentAxis","onActivatorIntersection","intersectionRect","boundingClientRect","_isPositioningAlongHorizontal","bottom","_isPositioningAlongVertical","right","onActivatorScroll","unsubscribers","$root","passive","_activatorObserver","disconnect","triggerRect","popupRect","arrowRect","DOMRect","trigger","Rect","innerMargin","inner","cx","cy","calcPopupBasicRect","arrow","placedAt","isMirrored","outer","fitByMajorAxis","arrowAdjust","fitByMinorAxisVertical","fitByMinorAxisHorizontal","fitByMinorAxis","calcPopupPosition","innerHeight","innerWidth","clientWidth","ESLPopup","_initialHeight","_fallbackTimer","ESLPanelGroup","_onTransitionEnd","beforeAnimate","noCollapse","afterAnimate","onAnimate","animateClass","postAnimateClass","fallbackAnimate","clearAnimation","removeProperty","fallbackDuration","propertyName","stackConfig","$group","panelConfig","ESLPanel","_previousHeight","modeRules","_onModeChange","updateMode","_onBeforeHide","currentMode","$target","modeClsTarget","supportedModes","registered","$panels","panel","shouldOpen","includesPanel","noCollapseModes","shouldCollapse","to","animationClass","$activePanels","initialHeight","updateTargetFromSelector","_$target","newPopupInstance","_onTargetStateChange","a11yTarget","trackClick","initA11y","isTargetIgnored","ignore","$ignore","mergeToggleableParams","showTarget","actionParams","hideTarget","toggleTarget","clsTarget","activeClassTarget","allowClick","allowHover","hoverShowDelay","hoverHideDelay","id","ESLTrigger","ESLTab","$targets","goTo","activateSelected","click","triggers","$active","activeElement","ESLA11yGroup","RTLUtils","isRtl","direction","scrollType","createTextNode","dir","fontSize","createDummyEl","scrollLeft","normalizeScrollLeft","scrollWidth","_deferredUpdateArrows","updateArrows","_deferredFitToViewport","fitToViewport","$current","ESLTabs","scrollable","scrollableTypeRules","_onScrollableTypeChange","updateScrollableType","unbindScrollableEvents","bindScrollableEvents","_onTriggerStateChange","_onFocus","$scrollableTarget","_onScroll","$tabs","find","scrollableTarget","currentScrollableType","moveTo","scrollBy","$trigger","updateMarkers","areaRect","itemRect","calcScrollOffset","isReversedRTL","Math","floor","ceil","swapSides","scrollStart","abs","scrollEnd","$rightArrow","$leftArrow","isScrollable","supportedScrollableTypes","tabDirection","deferredRefresh","_resizeObserver","ResizeObserver","_mutationObserver","MutationObserver","rec","updateContentObserve","_deferredDragToCoordinate","_dragToCoordinate","findTarget","content","unbindTargetEvents","bindTargetEvents","$scrollbarTrack","trackClass","$scrollbarThumb","thumbClass","_onMouseDown","childList","recs","contentChanges","addedNodes","removedNodes","horizontal","areaSize","scrollSize","scrollOffset","scrollTop","scrollableSize","scrollTargetTo","normalizePosition","relativePosition","scrollTo","dragging","thumbSize","trackOffset","thumbPosition","_initialPosition","_initialMousePosition","clientX","clientY","_onMouseMove","_onMouseUp","_onBodyClick","capture","mousePosition","positionChange","scrollableAreaHeight","thumbOffset","absChange","stopImmediatePropagation","clickCoordinates","clickPosition","freeTrackArea","newPosition","ESLScrollbar","ESLAlert","alert","defaultConfig","iframe","$content","_onTargetEvent","_clearTimeout","html","text","hideTime","activeCls","ESLSelectItem","tabIndex","selected","option","original","build","_onTargetMutation","_$select","select","_onTargetChange","_onReset","_onChange","_onListChange","newTarget","oldTarget","observationConfig","changes","change","$select","multiple","getOption","setSelected","isSelected","opt","hasSelected","isAllSelected","setAllSelected","selectedOptions","required","validity","validationMessage","willValidate","checkValidity","reportValidity","setCustomValidity","subtree","attributes","attributeFilter","characterData","$list","$scroll","$selectAll","_updateDisabled","bindSelect","HTMLSelectElement","_renderItems","$items","pinSelected","_renderGroup","last","_updateSelectAll","selectAllLabel","count","ESLSelectList","ESLSelectWrapper","_deferredRerender","$remove","$container","$text","$rest","ESLSelect","ESLSelectRenderer","owner","_onClear","hasValue","applyItems","limit","moreLabelFormat","updatePosition","_disposeTimeout","$owner","focusable","preventScroll","_onTabKey","shiftKey","windowY","scrollY","$renderer","$dropdown","ESLSelectDropdown","_prepare","_onUpdate","_dispose","valueChanged","_onPopupStateChange","emptyText","placeholder","hasValueClass","focusEl","hasFocus","hasFocusClass","sequences","__esl_sequences__","randUID","prefix","Date","now","round","random","convertNotesToFootnotesList","notes","_notes","ESLFootnotes","scopeTarget","reindex","grouping","groupedList","compileFootnotesGroupedList","sort","note1","note2","rect1","rect2","note","setIndex","_sendRequestToNote","unlink","scopeEl","_onNoteSubscribe","linkNote","uid","sequentialUID","link","unlinkNote","buildItems","footnotesList","footnote","buildItem","buildItemIndex","buildItemText","buildItemBack","orderAttr","order","_onBackToNote","highlight","activate","turnOffHighlight","ESLTooltip","sharedInstance","disableArrow","_appendArrow","_createArrow","innerText","extraClass","_updateActivatorState","newState","_index","_sendResponseToFootnote","_$footnotes","restore","_onFootnotesReady","block","scrollIntoView","intersectionObserver","showTooltip","enable","footnotes","linked","hideTooltip","toggleTooltip","tooltipShown","ESLNote","_state","protocol","URL","buildIframe","PLAYING","contentWindow","IframeBasicProvider","urlPattern","applyElementSettings","HTMLMediaProvider","bindListeners","ended","ENDED","played","paused","AudioProvider","loadScript","script","getElementById","async","createAsyncScript","Event","firstScriptTag","insertBefore","videoWidth","videoHeight","VideoProvider","YouTubeProvider","providerRegexp","idRegexp","getCoreApi","_coreApiPromise","YT","Player","cbOrigin","onYouTubeIframeAPIReady","err","mapOptions","enablejsapi","origin","location","rel","showinfo","iv_load_policy","Number","disablekb","autohide","sm","onCoreApiReady","onPlayerReady","_api","videoId","events","onError","onReady","onStateChange","_onStateChange","playerVars","getIframe","mute","destroy","playVideo","unMute","HTMLIFrameElement","getPlayerState","getDuration","getCurrentTime","pauseVideo","stopVideo","API_SCRIPT_ID","videojsClasses","getAccount","playerId","accountId","loadAPI","account","apiSrc","apiScript","buildVideo","_account","$$fromEvent","one","onAPILoaded","bc","videojs","onAPIReady","_autoplay","on","Provider","dispose","BrightcoveProvider","_setActive","_setFirst","carousel","eslRegistryInstance","ESLCarouselViewRegistry","createViewInstance","View","registerView","view","_currentConfig","_plugins","_onMatchChange","_onRegistryChange","ESLCarousel","$slidesArea","ESLCarouselSlide","$slides","activeIndexes","activeConfig","findIndex","slide","nextIndex","isAnimated","firstIndex","eventDetails","approved","_view","activeCount","computedIndex","_bindEvents","_unbindEvents","configRules","_configRules","viewType","draw","getNextGroup","shiftGroupsCount","lastIndex","currentGroup","countGroups","markedTarget","slideTarget","lastGroup","addPlugin","plugin","removePlugin","_addPlugin","isConnected","_removePlugin","Slide","slideStyles","slidesAreaStyles","slideWidth","marginLeft","marginRight","computedLeft","activeSlide","nextSlide","_cleanAnimation","ESLCarouselView","ESLSingleCarouselView","currentTrans","transform","slideIndex","areaWidth","transitionDuration","currentLeft","shiftCount","trans","nextActiveIndexes","intersectionIndexes","animatedCount","minActive","orderIndex","sIndex","ESLMultiCarouselView","findCarouselOwner","freePlacement","nodeName","_carousel","rerender","activeDot","buildDot","isActive","ESLCarouselDotsPlugin","ESLCarouselPlugin","_onSlideChange","$source","_target","ESLCarouselLinkPlugin","isTouchStarted","startPoint","onTouchStart","touches","PointerEvent","pointerType","onTouchMove","onTouchEnd","point","offset","TOUCH_EVENTS","ESLCarouselTouchPlugin","ESLCarouselPlugins","Dots","Link","Autoplay","_onInterval","_onInteract","start","reset","ESLCarouselAutoplayPlugin"],"sourceRoot":""}