{"version":3,"sources":["webpack://EWC/webpack/universalModuleDefinition","webpack://EWC/webpack/bootstrap","webpack://EWC/./src/components/smart-query/ts/smart-rule-list.ts","webpack://EWC/./src/helpers/component-utils.ts","webpack://EWC/./src/helpers/device-utils.ts","webpack://EWC/./src/components/smart-query/ts/smart-query.ts","webpack://EWC/./src/components/smart-query/ts/smart-query-breakpoints.ts","webpack://EWC/./src/helpers/abstract/observable.ts","webpack://EWC/./src/helpers/es5-support/es6-htmlelement-shim.ts","webpack://EWC/./src/helpers/builtin-polyfils/object-polyfils.ts","webpack://EWC/./src/helpers/builtin-polyfils/closest-polyfill.ts","webpack://EWC/./src/helpers/decorators/attr.ts","webpack://EWC/./src/components/smart-image/ts/smart-image.ts","webpack://EWC/./src/components/smart-video/ts/smart-video-manager.ts","webpack://EWC/./src/components/smart-video/ts/smart-video-iobserver.ts","webpack://EWC/./src/components/smart-video/ts/smart-video-provider.ts","webpack://EWC/./src/components/smart-video/ts/smart-video-registry.ts","webpack://EWC/./src/components/smart-video/ts/smart-video.ts","webpack://EWC/./src/helpers/function-utils.ts","webpack://EWC/./src/components/smart-video/ts/video-providers/youtube-provider.ts","webpack://EWC/./src/helpers/common-utils.ts","webpack://EWC/./src/components/smart-video/ts/video-providers/video-provider.ts","webpack://EWC/./src/components/smart-manager/smart-popup-manager.group.ts","webpack://EWC/./src/components/smart-manager/smart-popup-manager.ts","webpack://EWC/./src/components/smart-popup/smart-popup.ts","webpack://EWC/./src/components/smart-trigger/smart-popup-trigger.ts","webpack://EWC/./src/components/smart-carousel/ts/strategy/smart-carousel-strategy.ts","webpack://EWC/./src/components/smart-carousel/ts/strategy/smart-single-carousel-strategy.ts","webpack://EWC/./src/components/smart-carousel/ts/strategy/smart-multi-carousel-strategy.ts","webpack://EWC/./src/components/smart-carousel/ts/smart-carousel-slide.ts","webpack://EWC/./src/components/smart-carousel/ts/smart-carousel.ts","webpack://EWC/./src/components/smart-carousel/ts/smart-carousel-dots.ts","webpack://EWC/./src/bundles/all.ts"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","SmartRule","_super","payload","query","_this","this","_default","_payload","__extends","toString","media","parse","lex","parser","_a","split","trim","all","empty","_smart_query__WEBPACK_IMPORTED_MODULE_1__","SmartRuleList","_onMatchChanged","rule","_activeRule","_active","fire","Error","_rules","parseRules","forEach","addListener","filter","default","str","parts","rules","_lex","indexOf","unshift","push","satisfied","matches","length","active","assign","STRING_PARSER","val","OBJECT_PARSER","eval","e","_helpers_abstract_observable__WEBPACK_IMPORTED_MODULE_0__","__webpack_exports__","triggerComponentEvent","target","eventName","args","eventHandlerName","eventHandlerAttr","getAttribute","apply","console","log","tagName","dispatchEvent","CustomEvent","isMobile","isTouch","test","navigator","userAgent","prefixes","document","Touch","matchMedia","mq","join","_helpers_device_utils__WEBPACK_IMPORTED_MODULE_0__","_smart_query_breakpoints__WEBPACK_IMPORTED_MODULE_1__","QUERY_CACHE","SmartQuery","_dpr","replace","match","ratio","Math","floor","round","getDprMediaQuery","pre","type","post","_mobileOnly","toUpperCase","_query","matcher","getQuery","listener","addEventListener","removeListener","removeEventListener","BreakpointRegistry","ScreenBreakpoint","min","max","registry","xs","sm","md","lg","xl","BP_NAME_REGEXP","addCustomBreakpoint","minWidth","maxWidth","toLowerCase","current","getBreakpoint","getAllBreakpointsNames","keys","breakpoints","breakpointRegex","RegExp","sign","bp","shortcut","mediaQueryGE","mediaQueryLE","mediaQuery","Observable","_listeners","index","splice","_i","arguments","es5HTMLElemeentInheritanceShim","is","x","y","configurable","writable","Element","msMatchesSelector","mozMatchesSelector","webkitMatchesSelector","closest","css","node","parentElement","toKebabCase","intersectionObserver","attr_attr","config","defaultValue","readonly","propName","attrName","dataAttr","conditional","readOnly","hasAttribute","set","setAttribute","removeAttribute","buildConditionalMapping","buildSimpleMapping","STRATEGIES","cover","useInnerImg","save-ratio","afterLoad","shadowImg","style","paddingTop","height","width","fit","origin","_innerImage","dpr","getIObserver","IntersectionObserver","entries","entry","isIntersecting","intersectionRatio","smart_image_SmartImage","triggerLoad","threshold","rootMargin","device_utils","SmartImage","_onLoad","_onError","_onMatchChange","update","register","className","customElements","lazyManual","_srcRules","srcRules","smart_rule_list","src","_currentSrc","isEmptyImage","changeMode","oldVal","newVal","_innerImg","removeChild","force","lazy","lazyTriggered","getPath","DPR","_shadowImg","refreshOnUpdate","ready","syncImage","_detachLazyTrigger","srcBase","EMPTY_IMAGE","refresh","background","isEmpty","backgroundImage","connectedCallback","constructor","classList","add","alt","lazyAuto","observe","unobserve","disconnectedCallback","attributeChangedCallback","querySelector","createElement","appendChild","_shadowImageElement","Image","onload","onerror","component_utils","_onReady","error","containerCls","targetEl","parentNode","__decorate","HTMLElement","smart_image","iObserver","PlayerStates","managerMap","smart_video_manager","VideoGroupRestrictionManager","registerPlay","instance","group","Event","bubbles","pause","unregister","RATIO_TO_ACTIVATE","RATIO_TO_DEACTIVATE","smart_video_iobserver_getIObserver","handleViewport","entire","smart_video","video","onplaying","muted","play","BaseProvider","component","_ready","res","Promise","reject","catch","toggle","getState","PAUSED","safeSeekTo","pos","then","seekTo","safePlay","safePause","safeStop","stop","safeToggle","smart_video_registry","EmbeddedVideoProviderRegistry","providers","smart_video_registry_extends","_instance","provider","getProvider","observable","smart_video_SmartVideo","SmartVideo","deferedReinit","fn","wait","immediate","timeout","context","later","callNow","clearTimeout","setTimeout","debounce","reinitInstance","_onRegistryStateChange","videoType","_onConditionStateChange","smart_video_extends","innerHTML","conditionQuery","disabled","detachViewportConstraint","_provider","unbind","playInViewport","attachViewportConstraint","buildOptions","title","autoplay","hideControls","dataId","dataset","id","dataSrc","_updateMarkers","addValue","removeValue","remove","state","reset","focus","_onDetach","_onPlay","autofocus","_onPaused","_onEnded","UNINITIALIZED","_conditionQuery","smart_query","observer","smart_video_decorate","youtube_provider_YouTubeProvider","YouTubeProvider","_onStateChange","event","data","PLAYING","ENDED","youtube_provider_extends","getCoreApi","_coreApiPromise","resolve","YT","Player","getElementById","tag","async","firstScriptTag","getElementsByTagName","insertBefore","loadScript","cbOrigin","onYouTubeIframeAPIReady","err","buildIframeUrl","Number","buildIframe","el","Date","now","random","iframeLoad","_el","_api","events","onError","onReady","onStateChange","destroy","contentWindow","getPlayerState","playVideo","pauseVideo","stopVideo","videoName","video_provider_VideoProvider","VideoProvider","video_provider_extends","buildSrc","build","preload","loop","tabIndex","controls","currentTime","Group","popups","popup","show","params","hide","_show","smart_popup_manager_all","STATES","smart_popup_manager","groups","options","smart_popup_manager_group","size","bindTriggerAndTarget","trigger","idCounter","uid","attr","smart_popup_SmartPopup","SmartPopup","Manager","smart_popup_extends","prevValue","wasClosed","activeClass","isOpen","closeOnEsc","contains","OPEN","CLOSE","evt","newState","observedAttributes","hoverHideDelay","hoverShowEvent","hoverHideEvent","SmartPopupTrigger","showEvent","hideEvent","smart_popup_trigger_extends","removeEvent","setEvents","setMode","attachEvents","addShowEvent","addHideEvent","togglePopup","hoverSubEvents","timerId","popupHide","popupShow","smart_carousel_strategy","carousel","smart_single_carousel_strategy","SmartSingleCarouselStrategy","smart_single_carousel_strategy_extends","onAnimate","nextIndex","direction","firstIndex","activeSlide","$slides","nextSlide","_cleanAnimation","cleanStyles","smart_multi_carousel_strategy","SmartMultiCarouselStrategy","smart_multi_carousel_strategy_extends","slideStyles","getComputedStyle","slideWidth","parseFloat","marginLeft","marginRight","areaWidth","transitionDuration","currentLeft","left","trans","left_1","activeCount","transform","this_1","time","activeIndexes","nextTrans","SmartCarouselSlide","smart_carousel_slide_extends","Array","childNodes","_setActive","toggleAttribute","smart_carousel_slide","smart_carousel_STRATEGIES","single","multi","smart_carousel_SmartCarousel","SmartCarousel","_currentConfig","smart_carousel_extends","els","$slidesArea","querySelectorAll","from","reduce","count","goTo","isAnimated","approved","_strategy","prev","nextGroup","getNextGroup","next","_bindEvents","_unbindEvents","updateStrategy","configRules","_onClick","strategy","_configRules","activeValue","deepCompare","obj1","obj2","keys1","keys2","some","currentTrans","slidesAreaStyles","slideWidth_1","computedLeft_1","slide","shiftGroupsCount","lastIndex","currentGroup","countGroups","ceil","findIndex","markedTarget","slideTarget","smart_carousel_decorate","smart_carousel","smart_carousel_dots_SmartCarouselDots","SmartCarouselDots","_onUpdate","rerender","smart_carousel_dots_extends","$parent","html","activeDot","buildDot","isActive","smart_carousel_dots","smart_query_breakpoints"],"mappings":"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","file":"all.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"EWC\"] = factory();\n\telse\n\t\troot[\"EWC\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n","/**\r\n * Smart Rule List\r\n * @version 1.0.0\r\n * @author Yuliya Adamskaya\r\n *\r\n * Helper class that extend provide Observable Rule Handler that resolve payload based on current device configuration.\r\n * Supports\r\n * - CSS query matching check\r\n * - DPR display queries (@x1 | @x2 | @x3)\r\n * - Screen default sizes shortcuts @[-|+](XS|SM|MD|LG|XL)\r\n * - Query matching change listeners\r\n * - Mobile / full browser detection (@MOBILE|@DESKTOP)\r\n */\r\n\r\nimport {Observable} from '@helpers/abstract/observable';\r\nimport SmartQuery from './smart-query';\r\n\r\ntype PayloadParser<T> = (val: string) => T;\r\n\r\nclass SmartRule<T> extends SmartQuery {\r\n\tprivate readonly _payload: T;\r\n\tprivate readonly _default: boolean;\r\n\r\n\tconstructor(payload: T, query: string) {\r\n\t\tsuper(query);\r\n\t\tthis._default = !query;\r\n\t\tthis._payload = payload;\r\n\t}\r\n\r\n\tpublic toString() {\r\n\t\treturn `${this.query.media} => ${this._payload}`;\r\n\t}\r\n\r\n\tget payload(): T {\r\n\t\treturn this._payload;\r\n\t}\r\n\tget default(): boolean {\r\n\t\treturn this._default;\r\n\t}\r\n\r\n\tpublic static parse<T>(lex: string, parser: PayloadParser<T>) {\r\n\t\tconst [query, payload] = lex.split('=>');\r\n\t\treturn new SmartRule<T>(parser(payload.trim()), query.trim());\r\n\t}\r\n\r\n\tpublic static all<T>(payload: T) {\r\n\t\treturn new SmartRule<T>(payload, 'all');\r\n\t}\r\n\tpublic static empty() {\r\n\t\treturn SmartRule.all(null);\r\n\t}\r\n}\r\n\r\nexport default class SmartRuleList<T extends string | object> extends Observable {\r\n\tprivate _active: SmartRule<T>;\r\n\tprivate _default: SmartRule<T>;\r\n\tprivate readonly _rules: Array<SmartRule<T>>;\r\n\r\n\tpublic static STRING_PARSER = (val: string) => val;\r\n\tpublic static OBJECT_PARSER = <T extends object> (val: string): T => {\r\n\t\ttry {\r\n\t\t\treturn eval('(' + val + ')') as T;\r\n\t\t} catch (e) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t};\r\n\r\n\tprivate static parseRules<T>(str: string, parser: PayloadParser<T>): Array<SmartRule<T>> {\r\n\t\tconst parts = str.split('|');\r\n\t\tconst rules: Array<SmartRule<T>> = [];\r\n\t\tparts.forEach((_lex: string) => {\r\n\t\t\tconst lex = _lex.trim();\r\n\t\t\tif (!lex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (lex.indexOf('=>') === -1) {\r\n\t\t\t\t// Default rule should have lower priority\r\n\t\t\t\trules.unshift(SmartRule.all(parser(lex)));\r\n\t\t\t} else {\r\n\t\t\t\tconst rule = SmartRule.parse(lex, parser);\r\n\t\t\t\trule && rules.push(rule);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn rules;\r\n\t}\r\n\r\n\tpublic static parse<T extends string | object>(query: string, parser: PayloadParser<T>) {\r\n\t\treturn new SmartRuleList<T>(query, parser);\r\n\t}\r\n\r\n\tprivate constructor(query: string, parser: PayloadParser<T>) {\r\n\t\tsuper();\r\n\t\tif (typeof query !== 'string') {\r\n\t\t\tthrow new Error('SmartRuleList require first parameter (query) typeof string');\r\n\t\t}\r\n\t\tthis._rules = SmartRuleList.parseRules(query, parser);\r\n\t\tthis._rules.forEach((rule) => rule.addListener(this._onMatchChanged));\r\n\t\tthis._default = this._rules.filter((rule) => rule.default)[0];\r\n\t}\r\n\r\n\tget rules() {\r\n\t\treturn this._rules;\r\n\t}\r\n\r\n\tget _activeRule() {\r\n\t\tconst satisfied = this.rules.filter((rule) => rule.matches);\r\n\t\treturn satisfied.length > 0 ? satisfied[satisfied.length - 1] : SmartRule.empty();\r\n\t}\r\n\r\n\tget active() {\r\n\t\tif (!this._active) {\r\n\t\t\tthis._active = this._activeRule;\r\n\t\t}\r\n\t\treturn this._active;\r\n\t}\r\n\r\n\tget activeValue(): T {\r\n\t\tconst value = this.active.payload;\r\n\t\tif (typeof value === 'string' || !this._default) {\r\n\t\t\treturn value;\r\n\t\t}\r\n\t\treturn Object.assign({}, this._default.payload || {}, value);\r\n\t}\r\n\r\n\tprivate _onMatchChanged = () => {\r\n\t\tconst rule = this._activeRule;\r\n\t\tif (this._active !== rule) {\r\n\t\t\tthis._active = rule;\r\n\t\t\tthis.fire(rule);\r\n\t\t}\r\n\t};\r\n}\r\n","/**\r\n * Common method that initiate event handler defined by on{eventName} attribute and then trigger simple custom event on the element\r\n * @param target - target HTMLElement\r\n * @param eventName - name of event\r\n * @param args - arguments for custom event\r\n */\r\nexport function triggerComponentEvent(target: HTMLElement, eventName: string, args?: any): boolean {\r\n    const eventHandlerName = 'on' + eventName;\r\n    const eventHandlerAttr = target.getAttribute(eventHandlerName);\r\n    if (eventHandlerAttr) {\r\n        try {\r\n            if (typeof (target as any)[eventHandlerName] !== 'function') {\r\n                (target as any)[eventHandlerName] = function () { eval(eventHandlerAttr); };\r\n            }\r\n            (target as any)[eventHandlerName].apply(target, args);\r\n        } catch (e) {\r\n            console.log(`Error executing ${target.tagName} ${eventName} hook function.\\n ${e}`);\r\n        }\r\n    }\r\n    return target.dispatchEvent(new CustomEvent(eventName, args)); // TODO: check args usage\r\n}\r\n","export const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\r\n\r\nexport const isTouch = function isTouchDevice() {\r\n  const prefixes = ' -webkit- -moz- -o- -ms- '.split(' ');\r\n  const mq = function (query: string) {\r\n    return window.matchMedia(query).matches;\r\n  };\r\n\r\n  if (('ontouchstart' in window) || 'TouchEvent ' in window || 'DocumentTouch' in window && document instanceof Touch) {\r\n    return true;\r\n  }\r\n\r\n  const query = ['(', prefixes.join('touch-enabled),('), 'heartz', ')'].join('');\r\n  return mq(query);\r\n};\r\n","/**\r\n * Smart Query\r\n * @version 1.2.0\r\n * @author Alexey Stsefanovich (ala'n)\r\n *\r\n * Helper class that extend MediaQueryList class\r\n * Supports\r\n * - CSS query matching check\r\n * - DPR display queries (@x1 | @x2 | @x3)\r\n * - Screen default sizes shortcuts @[-|+](XS|SM|MD|LG|XL)\r\n * - Query matching change listeners\r\n * - Mobile / full browser detection (@MOBILE|@DESKTOP)\r\n */\r\n\r\nimport {isMobile} from '@helpers/device-utils';\r\nimport {BreakpointRegistry} from './smart-query-breakpoints';\r\n\r\nconst QUERY_CACHE: any = {};\r\n\r\nfunction getQuery(query: string): MediaQueryList {\r\n\tif (query) {\r\n\t\tconst matcher = QUERY_CACHE[query] ? QUERY_CACHE[query] : window.matchMedia(query);\r\n\t\tif (matcher) {\r\n\t\t\tQUERY_CACHE[query] = matcher;\r\n\t\t}\r\n\t\treturn matcher;\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction getDprMediaQuery(ratio: number) {\r\n\tconst isWebkit = navigator.userAgent.indexOf('AppleWebKit') !== -1;\r\n\treturn isWebkit ? `(-webkit-min-device-pixel-ratio: ${ratio})` : `(min-resolution: ${Math.round(96 * ratio)}dpi)`;\r\n}\r\n\r\nexport class SmartQuery {\r\n\tstatic get BreakpointRegistry() {\r\n\t\treturn BreakpointRegistry;\r\n\t}\r\n\r\n\tprivate _dpr: number;\r\n\tprivate _mobileOnly: boolean;\r\n\tprivate readonly _query: MediaQueryList;\r\n\r\n\tconstructor(query: string) {\r\n\r\n\t\t// Applying known breakpoints shortcut\r\n\t\tquery = BreakpointRegistry.apply(query);\r\n\r\n\t\t// Applying dpr shortcut\r\n\t\tthis._dpr = 1;\r\n\t\tquery = query.replace(/@(1|2|3)x/, (match, ratio) => {\r\n\t\t\tthis._dpr = Math.floor(ratio);\r\n\t\t\treturn getDprMediaQuery(ratio);\r\n\t\t});\r\n\r\n\t\t// Applying dpr shortcut for device detection\r\n\t\tquery = query.replace(/(and ){0,1}(@MOBILE|@DESKTOP)( and){0,1}/i, (match, pre, type, post) => {\r\n\t\t\tthis._mobileOnly = (type.toUpperCase() === '@MOBILE');\r\n\t\t\tif (isMobile !== this._mobileOnly) {\r\n\t\t\t\treturn 'not all';\r\n\t\t\t}\r\n\t\t\treturn pre && post ? ' and ' : '';\r\n\t\t});\r\n\r\n\t\tthis._query = getQuery(query.trim() || 'all');\r\n\t}\r\n\r\n\tget isMobileOnly() {\r\n\t\treturn this._mobileOnly === true;\r\n\t}\r\n\r\n\tget isFullOnly() {\r\n\t\treturn this._mobileOnly === false;\r\n\t}\r\n\r\n\tget DPR() {\r\n\t\treturn this._dpr;\r\n\t}\r\n\r\n\tget query() {\r\n\t\treturn this._query;\r\n\t}\r\n\r\n\tget matches() {\r\n\t\treturn this.query && this.query.matches;\r\n\t}\r\n\r\n\tpublic addListener(listener: () => void) {\r\n\t\tif (!this.query) return;\r\n\t\tif (typeof this.query.addEventListener === 'function') {\r\n\t\t\tthis.query.addEventListener('change', listener);\r\n\t\t} else {\r\n\t\t\tthis.query.addListener(listener);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic removeListener(listener: () => void)  {\r\n\t\tif (!this.query) return;\r\n\t\tif (typeof this.query.removeEventListener === 'function') {\r\n\t\t\tthis.query.removeEventListener('change', listener);\r\n\t\t} else {\r\n\t\t\tthis.query.removeListener(listener);\r\n\t\t}\r\n\t}\r\n}\r\nexport default SmartQuery;\r\n","/**\r\n * Smart Query Breakpoint Registry\r\n * @version 1.0.0\r\n * @author Yuliya Adamskaya\r\n *\r\n * Breakpoint Registry is used to provide custom breakpoints for Smart Query\r\n */\r\n\r\nclass ScreenBreakpoint {\r\n\tpublic min: number;\r\n\tpublic max: number;\r\n\r\n\tconstructor(min: number, max: number) {\r\n\t\tthis.min = min;\r\n\t\tthis.max = max;\r\n\t}\r\n\r\n\tget mediaQuery(): string {\r\n\t\treturn `(min-width: ${this.min}px) and (max-width: ${this.max}px)`;\r\n\t}\r\n\r\n\tget mediaQueryGE(): string {\r\n\t\treturn `(min-width: ${this.min}px)`;\r\n\t}\r\n\r\n\tget mediaQueryLE(): string {\r\n\t\treturn `(max-width: ${this.max}px)`;\r\n\t}\r\n}\r\n\r\ninterface BreakpointsMapping {\r\n\t[key: string]: ScreenBreakpoint\r\n}\r\n\r\n// Default breakpoints provided in registry\r\nconst registry: BreakpointsMapping = {\r\n\txs: new ScreenBreakpoint(1, 767),\r\n\tsm: new ScreenBreakpoint(768, 991),\r\n\tmd: new ScreenBreakpoint(992, 1199),\r\n\tlg: new ScreenBreakpoint(1200, 1599),\r\n\txl: new ScreenBreakpoint(1600, 999999)\r\n};\r\n\r\nconst BP_NAME_REGEXP = /^[a-z]{1,}/i;\r\n\r\nexport abstract class BreakpointRegistry {\r\n\t/**\r\n\t * Add or replace breakpoint shortcut that could be used inside of SmartQuery\r\n\t * @param name - name of shortcut\r\n\t * @param minWidth - min width for breakpoint\r\n\t * @param maxWidth - max width for breakpoint\r\n\t */\r\n\tpublic static addCustomBreakpoint(name: string, minWidth: number, maxWidth: number): ScreenBreakpoint {\r\n\t\tname = name.toLowerCase();\r\n\t\tif (BP_NAME_REGEXP.test(name)) {\r\n\t\t\tconst current = registry[name];\r\n\t\t\tregistry[name] = new ScreenBreakpoint(minWidth, maxWidth);\r\n\t\t\treturn current;\r\n\t\t}\r\n\t\tthrow new Error('Shortcut should consist only from Latin characters. Length should be at least one character.');\r\n\t}\r\n\r\n\t/**\r\n\t * @return known breakpoint shortcut instance\r\n\t */\r\n\tpublic static getBreakpoint(name: string): ScreenBreakpoint {\r\n\t\treturn registry[(name || '').toLowerCase()];\r\n\t}\r\n\r\n\t/**\r\n\t * @returns all available breakpoints shortcuts\r\n\t */\r\n\tpublic static getAllBreakpointsNames() {\r\n\t\treturn Object.keys(registry);\r\n\t}\r\n\r\n\t/**\r\n\t * Replaces known breakpoints shortcuts to the real media queries\r\n\t * @param query - original query string\r\n\t */\r\n\tpublic static apply(query: string) {\r\n\t\tconst breakpoints = Object.keys(registry);\r\n\t\tconst breakpointRegex = new RegExp(`@([+-]{0,1})(${breakpoints.join('|')})`, 'ig');\r\n\r\n\t\treturn query.replace(breakpointRegex, (match, sign, bp) => {\r\n\t\t\tconst shortcut = BreakpointRegistry.getBreakpoint(bp);\r\n\t\t\tswitch (sign) {\r\n\t\t\t\tcase '+':\r\n\t\t\t\t\treturn shortcut.mediaQueryGE;\r\n\t\t\t\tcase '-':\r\n\t\t\t\t\treturn shortcut.mediaQueryLE;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn shortcut.mediaQuery;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport default BreakpointRegistry;\r\n","export class Observable {\r\n\tprivate _listeners: Array<() => void> = [];\r\n\r\n\tpublic addListener(listener: (...args: any) => void) {\r\n\t\tconst index = this._listeners.indexOf(listener);\r\n\t\tif (index === -1) {\r\n\t\t\tthis._listeners.push(listener);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic removeListener(listener: (...args: any) => void) {\r\n\t\tconst index = this._listeners.indexOf(listener);\r\n\t\tif (index !== -1) {\r\n\t\t\tthis._listeners.splice(index);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected fire(...args: any) {\r\n\t\tthis._listeners.forEach((listener) => {\r\n\t\t\ttry {\r\n\t\t\t\tlistener.apply(this, args);\r\n\t\t\t} catch (e) {\r\n\t\t\t\t// Don't care\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n","/**\r\n * Shim based on https://github.com/webcomponents/custom-elements/blob/master/src/native-shim.js\r\n *\r\n * This shim allows elements written in, or compiled to, ES5 to work on native\r\n * implementations of Custom Elements.\r\n *\r\n * There are some restrictions and requirements on ES5 constructors:\r\n *   1. All constructors in a inheritance hierarchy must be ES5-style, so that\r\n *      they can be called with Function.call(). This effectively means that the\r\n *      whole application must be compiled to ES5.\r\n *   2. Constructors must return the value of the emulated super() call. Like\r\n *      `return SuperClass.call(this)`\r\n *   3. The `this` reference should not be used before the emulated super() call\r\n *      just like `this` is illegal to use before super() in ES6.\r\n *   4. Constructors should not create other custom elements before the emulated\r\n *      super() call. This is the same restriction as with native custom\r\n *      elements.\r\n *   5. Code inside of eval mustn't be compiled to ES5 syntax\r\n *\r\n *  Compiling valid class-based custom elements to ES5 will satisfy these\r\n *  requirements with the latest version of popular transpilers.\r\n */\r\n// @ts-ignore\r\nif ('customElements' in window && !window.es5HTMLElemeentInheritanceShim) {\r\n  try {\r\n    eval('(()=>{\\'use strict\\';const a=window.HTMLElement,b=window.customElements.define,' +\r\n      'c=window.customElements.get,d=new Map,e=new Map;let f=!1,g=!1;window.HTMLElement=function(){if(!f){' +\r\n      'const j=d.get(this.constructor),k=c.call(window.customElements,j);g=!0;const l=new k;return l}f=!1},' +\r\n      'window.HTMLElement.prototype=a.prototype;Object.defineProperty(window,\\'customElements\\',' +\r\n      '{value:window.customElements,configurable:!0,writable:!0}),Object.defineProperty(window.customElements,' +\r\n      '\\'define\\',{value:(j,k)=>{const l=k.prototype,m=class extends a{constructor(){super(),Object.setPrototypeOf(this,l),' +\r\n      'g||(f=!0,k.call(this)),g=!1}},n=m.prototype;m.observedAttributes=k.observedAttributes,' +\r\n      'n.connectedCallback=l.connectedCallback,n.disconnectedCallback=l.disconnectedCallback,' +\r\n      'n.attributeChangedCallback=l.attributeChangedCallback,n.adoptedCallback=l.adoptedCallback,d.set(k,j),' +\r\n      'e.set(j,k),b.call(window.customElements,j,m)},configurable:!0,writable:!0}),Object.defineProperty(' +\r\n      'window.customElements,\\'get\\',{value:j=>e.get(j),configurable:!0,writable:!0})})();');\r\n    // @ts-ignore-file\r\n    window.es5HTMLElemeentInheritanceShim = true;\r\n  } catch (e) {\r\n    //\r\n  }\r\n}\r\n","// Blatantly stolen from ES6 specs. Kept here for reference.\r\n// http://wiki.ecmascript.org/doku.php?id=harmony:egal\r\n\r\nif (!Object.is) {\r\n\tObject.defineProperty(Object, 'is', {\r\n\t\tvalue(x: any, y: any) {\r\n\t\t\treturn (x === y) ? (x !== 0 || 1 / x === 1 / y) : (x !== x && y !== y);\r\n\t\t},\r\n\t\tconfigurable: true,\r\n\t\tenumerable: false,\r\n\t\twritable: true\r\n\t});\r\n}\r\n","/**\r\n * Element.closest polyfill\r\n */\r\n\r\n/**\r\n * Cross-browser Element interface\r\n */\r\ninterface ElementEx extends Element {\r\n\tmsMatchesSelector?(selectors: string): boolean;\r\n\tmozMatchesSelector?(selectors: string): boolean;\r\n}\r\n\r\n(function (e: ElementEx) {\r\n\te.matches = e.matches || e.msMatchesSelector || e.mozMatchesSelector || e.webkitMatchesSelector;\r\n\te.closest = e.closest || function (css: string) {\r\n\t\tlet node = this;\r\n\t\twhile (node) {\r\n\t\t\tif (node.matches(css)) return node;\r\n\t\t\tnode = node.parentElement;\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n})(Element.prototype as ElementEx);\r\n","interface AttrDescriptor {\r\n\tconditional?: boolean;\r\n\treadonly?: boolean;\r\n\tdataAttr?: boolean;\r\n\tdefaultValue?: string;\r\n}\r\n\r\nexport const toKebabCase = (str: string) => {\r\n\treturn str.replace(/([a-z])([A-Z])/g, '$1-$2').replace(/[\\s_]+/g, '-').toLowerCase();\r\n};\r\n\r\nfunction buildSimpleMapping(target: object, propName: string, attrName: string, defaultValue: string) {\r\n\r\n\tfunction get() {\r\n\t\treturn this.getAttribute(attrName) || defaultValue;\r\n\t}\r\n\tfunction set(value: string) {\r\n\t\tthis.setAttribute(attrName, value);\r\n\t}\r\n\r\n\tObject.defineProperty(target, propName, {get, set});\r\n}\r\n\r\nfunction buildConditionalMapping(target: object, propName: string, attrName: string, readOnly: boolean) {\r\n\r\n\tfunction get() {\r\n\t\treturn this.hasAttribute(attrName);\r\n\t}\r\n\tfunction set(value: string) {\r\n\t\tvalue ? this.setAttribute(attrName, 'true') : this.removeAttribute(attrName);\r\n\t}\r\n\r\n\treadOnly ? Object.defineProperty(target, propName, {get}) : Object.defineProperty(target, propName, {get, set});\r\n}\r\n\r\nexport const attr = (config: AttrDescriptor = {defaultValue: '', readonly: false}) => {\r\n\treturn (target: object, propName: string) => {\r\n\t\tconst attrName = config.dataAttr ? `data-${toKebabCase(propName)}` : toKebabCase(propName);\r\n\t\tconfig.conditional ? buildConditionalMapping(target, propName, attrName, config.readonly) : buildSimpleMapping(target, propName, attrName, config.defaultValue);\r\n\t};\r\n};\r\n","/**\r\n * Smart Image\r\n * @version 1.1.0\r\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya\r\n *\r\n * @description:\r\n * SmartImage - custom element, that provide flexible abilities to include images on web pages.\r\n * Originally developed as alternative for picture component, but with more features inside.\r\n * Supported features:\r\n * - different render modes: with or without inner img tag; object-fit options emulation like cover, inscribe, etc.\r\n * - manual loading (start loading image by manually provided marker)\r\n * - lazy loading (image start loading only if it is visible and in or closer to browser viewport area\r\n * - SmartQuery (special syntax that allows define different sources for different media queries, also supports shortcuts for media-queries)\r\n * - flexible class markers. Smart Image can add specific class on any parent element when image is ready,\r\n * the Smart Image itself also has markers that indicate it state\r\n * - provides events on state change (also support inline syntax like <smart-image-tag onload=\"\">)\r\n * - hot changes\r\n *\r\n * @attr:\r\n *  {String} data-src - src paths per queries (watched value)\r\n *    NOTE: query support shortcuts for\r\n *     - Breakpoints like @MD, @SM (defined), @+SM (SM and larger), @-LG(LG and smaller)\r\n *     - Device point resolutions: @1x, @2x, @3x\r\n *    all conditions must be separated by conjunction ('and')\r\n *    @example: '@+MD and @2x'\r\n *  {String} [data-src-base] - base src path for pathes described in data-src\r\n *\r\n *  {String} alt | data-alt - alt text (watched value)\r\n *\r\n *  {'origin' | 'cover' | 'save-ratio' | 'fit'} mode - rendering mode (default 'save-ratio') (watched value)\r\n *    WHEN mode is 'origin' - save origin image size\r\n *                            (use inner img tag for rendering)\r\n *    WHEN mode is 'fit' - use inner img but not force it width\r\n *    WHEN mode is 'cover' - didn't have self size use 100% w/h of container\r\n *                           (use background-image for rendering)\r\n *    WHEN mode is 'save-ratio' - fill 100% of container width and set self height according to image ratio\r\n *                                (use background-image for rendering)\r\n *\r\n *  {Boolean} [lazy] - enable lazy loading triggered by IntersectionObserver by default\r\n *                    (image start loading as soon as it becomes visible in visual area)\r\n *  {Boolean} [lazy-manual] - just says not to load image until lazy-triggered attribute appears\r\n *\r\n *  {Boolean} [refresh-on-update] - Always update original image as soon as image source changed\r\n *\r\n *  {String}  [container-class] - class that will be added to container when image will be ready\r\n *  {String}  [container-class-onload] - marks that container-class shouldn't be added if image load ends with exception\r\n *  {String}  [container-class-target] - target parent selector to add container-class (parentNode by default).\r\n *\r\n *  Events html connection points (see @events section)\r\n *  {Function | Evaluated Expression} onready\r\n *  {Function | Evaluated Expression} onload\r\n *  {Function | Evaluated Expression} onerror\r\n *\r\n *  @readonly {Boolean} ready - appears once when image first time loaded\r\n *  @readonly {Boolean} loaded - appears once when image first time loaded\r\n *  @readonly {Boolean} error - appears when current src isn't load\r\n *\r\n *  NOTE: Smart Image supports title attribute as any html element, no additional reflection for that attribute needed\r\n *  it will work correctly according to HTML5.* REC\r\n *\r\n * @param:\r\n *  {String} src - srcset (see data-src attribute for details)\r\n *  {String} srcBase - base path (see data-src-base attribute for details)\r\n *  {String} alt - alt text\r\n *  {'origin' | 'cover' | 'save-ratio' | 'fit'} mode - mode of image renderer\r\n *  {Array} srcRules - array of srcRules parsed from src\r\n *  {Boolean} refreshOnUpdate - see proactive-update attribute\r\n *\r\n *  @readonly {Function} triggerLoad - shortcut function for manually adding lazy-triggered marker\r\n *\r\n *  @readonly {SmartImageSrcRule} targetRule - satisfied rule that need to be applied in current state\r\n *  @readonly {Boolean} ready\r\n *  @readonly {Boolean} loaded\r\n *  @readonly {Boolean} error\r\n *\r\n * @event:\r\n *  ready - emits when image ready (loaded or load fail)\r\n *  load - emits every time when image loaded (including on path change)\r\n *  error - emits every time when current source loading fails.\r\n *\r\n * @example:\r\n *  <smart-image-tag mode=\"save-ratio\"\r\n *      data-src='..defaultPath [| mediaQuery => src [| ...]]'\r\n *  ></smart-image-tag>\r\n *  // also instead of mediaQuery you could use breakpoint shortcut like:\r\n *  <smart-image-tag mode=\"save-ratio\"\r\n *      data-src='..defaultPath [| @+MD => src [| ...]]'\r\n *  ></smart-image-tag>\r\n *  or\r\n *  <smart-image-tag mode=\"save-ratio\"\r\n *      data-src='..defaultPath [| @1x => src [| ...]]'\r\n *  ></smart-image-tag>\r\n */\r\nimport {attr} from '@helpers/decorators/attr';\r\nimport {isMobile} from '@helpers/device-utils';\r\nimport {triggerComponentEvent} from '@helpers/component-utils';\r\nimport SmartRuleList from '@components/smart-query/ts/smart-rule-list';\r\n\r\n// Mods configurations\r\ninterface Strategy {\r\n\t[mode: string]: { useInnerImg: boolean, afterLoad?: (shadowImg: ShadowImageElement, empty: boolean) => void }\r\n}\r\n\r\ninterface ShadowImageElement extends HTMLImageElement {\r\n\tdpr?: number\r\n}\r\n\r\nconst STRATEGIES: Strategy = {\r\n\t'cover': {\r\n\t\tuseInnerImg: false,\r\n\t},\r\n\t'save-ratio': {\r\n\t\tuseInnerImg: false,\r\n\t\tafterLoad(shadowImg, empty) {\r\n\t\t\tthis.style.paddingTop = empty ? null : `${(shadowImg.height * 100 / shadowImg.width)}%`;\r\n\t\t}\r\n\t},\r\n\t'fit': {\r\n\t\tuseInnerImg: true\r\n\t},\r\n\t'origin': {\r\n\t\tuseInnerImg: true,\r\n\t\tafterLoad(shadowImg) {\r\n\t\t\tthis._innerImage.width = shadowImg.width / shadowImg.dpr;\r\n\t\t}\r\n\t}\r\n};\r\n\r\n// Intersection Observer for lazy init functionality\r\nlet intersectionObserver: IntersectionObserver;\r\n\r\nfunction getIObserver() {\r\n\tif (!intersectionObserver) {\r\n\t\tintersectionObserver = new IntersectionObserver(function intersectionCallback(entries) {\r\n\t\t\t(entries || []).forEach(function (entry) {\r\n\t\t\t\tif ((entry.isIntersecting || entry.intersectionRatio > 0) && entry.target instanceof SmartImage) {\r\n\t\t\t\t\tentry.target.triggerLoad();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}, {\r\n\t\t\tthreshold: [0.01],\r\n\t\t\trootMargin: isMobile ? '250px' : '500px'// rootMargin value for IntersectionObserver\r\n\t\t});\r\n\t}\r\n\treturn intersectionObserver;\r\n}\r\n\r\nexport class SmartImage extends HTMLElement {\r\n\t@attr({dataAttr: true, defaultValue: ''}) private src: string;\r\n\t@attr({dataAttr: true, defaultValue: ''}) private srcBase: string;\r\n\t@attr({defaultValue: ''}) private alt: string;\r\n\t@attr({defaultValue: 'save-ratio'}) private mode: string;\r\n\t@attr({conditional: true}) private refreshOnUpdate: boolean;\r\n\t@attr({conditional: true, readonly: true}) private lazyManual: boolean;\r\n\t@attr({conditional: true, readonly: true}) private lazyTriggered: boolean;\r\n\t@attr({conditional: true, readonly: true}) private ready: boolean;\r\n\t@attr({conditional: true, readonly: true}) private loaded: boolean;\r\n\t@attr({conditional: true, readonly: true}) private error: boolean;\r\n\r\n\tprivate _innerImg: HTMLImageElement;\r\n\tprivate _srcRules: SmartRuleList<string>;\r\n\tprivate _currentSrc: string;\r\n\tprivate _detachLazyTrigger: () => void;\r\n\tprivate _shadowImageElement: ShadowImageElement;\r\n\tprivate readonly _onMatchChange: () => void;\r\n\r\n\tstatic get EMPTY_IMAGE() {\r\n\t\treturn 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';\r\n\t}\r\n\r\n\tstatic get observedAttributes() {\r\n\t\treturn ['alt', 'data-alt', 'data-src', 'data-src-base', 'mode', 'lazy-triggered'];\r\n\t}\r\n\r\n\tprivate static className: string;\r\n\r\n\tpublic static register(tagName: string, className: string = tagName) {\r\n\t\tSmartImage.className = className;\r\n\t\tcustomElements.define(tagName, SmartImage);\r\n\t}\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis._onLoad = this._onLoad.bind(this);\r\n\t\tthis._onError = this._onError.bind(this);\r\n\t\tthis._onMatchChange = this.update.bind(this, false);\r\n\t}\r\n\r\n\tget lazy(): boolean {\r\n\t\treturn this.hasAttribute('lazy') || this.lazyManual;\r\n\t}\r\n\r\n\tget lazyAuto(): boolean {\r\n\t\treturn this.hasAttribute('lazy') && !this.lazyManual;\r\n\t}\r\n\r\n\tget srcRules() {\r\n\t\tif (!this._srcRules) {\r\n\t\t\tthis.srcRules = SmartRuleList.parse<string>(this.src, SmartRuleList.STRING_PARSER);\r\n\t\t}\r\n\t\treturn this._srcRules;\r\n\t}\r\n\r\n\tset srcRules(rules: SmartRuleList<string>) {\r\n\t\tif (this._srcRules) {\r\n\t\t\tthis._srcRules.removeListener(this._onMatchChange);\r\n\t\t}\r\n\t\tthis._srcRules = rules;\r\n\t\tthis._srcRules.addListener(this._onMatchChange);\r\n\t}\r\n\r\n\tget currentSrc() {\r\n\t\treturn this._currentSrc;\r\n\t}\r\n\r\n\tget empty() {\r\n\t\treturn !this._currentSrc || SmartImage.isEmptyImage(this._currentSrc);\r\n\t}\r\n\r\n\tpublic triggerLoad() {\r\n\t\tthis.setAttribute('lazy-triggered', '');\r\n\t}\r\n\r\n\tprotected changeMode(oldVal: string, newVal: string) {\r\n\t\toldVal = oldVal || 'save-ratio';\r\n\t\tnewVal = newVal || 'save-ratio';\r\n\t\tif (oldVal !== newVal) {\r\n\t\t\tif (!STRATEGIES[newVal]) {\r\n\t\t\t\tthrow new Error('Smart Image: Unsupported mode: ' + newVal);\r\n\t\t\t}\r\n\t\t\tif (this.mode !== newVal) {\r\n\t\t\t\tthis.mode = newVal;\r\n\t\t\t}\r\n\t\t\tif (this.mode !== 'origin' && this._innerImg) {\r\n\t\t\t\tthis.removeChild(this._innerImg);\r\n\t\t\t\tthis._innerImg = null;\r\n\t\t\t}\r\n\t\t\tthis.update(true);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected update(force: boolean = false) {\r\n\t\tif (this.lazy && !this.lazyTriggered) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst rule = this.srcRules.active;\r\n\t\tconst src = this.getPath(rule.payload);\r\n\t\tconst dpr = rule.DPR;\r\n\r\n\t\tif (this._currentSrc !== src || force) {\r\n\t\t\tthis._currentSrc = src;\r\n\t\t\tthis._shadowImg.src = src;\r\n\t\t\tthis._shadowImg.dpr = dpr;\r\n\r\n\t\t\tif (this.refreshOnUpdate || !this.ready) {\r\n\t\t\t\tthis.syncImage();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._detachLazyTrigger && this._detachLazyTrigger();\r\n    }\r\n\r\n\tprotected getPath(src: string) {\r\n\t\tif (!src || src === '0' || src === 'none') {\r\n\t\t\treturn SmartImage.EMPTY_IMAGE;\r\n\t\t}\r\n\t\treturn this.srcBase + src;\r\n\t}\r\n\r\n\tpublic refresh() {\r\n\t\tthis.removeAttribute('loaded');\r\n\t\tthis.removeAttribute('ready');\r\n\t\tthis.style.paddingTop = null;\r\n\t\tthis.style.background = null;\r\n\t\tthis.update(true);\r\n\t}\r\n\r\n\tprivate syncImage() {\r\n\t\tconst shadowImg = this._shadowImg;\r\n\t\tconst src = shadowImg.src;\r\n\t\tconst isEmpty = !src || SmartImage.isEmptyImage(src);\r\n\r\n\t\tif (STRATEGIES[this.mode].useInnerImg) {\r\n\t\t\tthis._innerImage.src = src;\r\n\t\t\tthis.style.backgroundImage = null;\r\n\t\t} else {\r\n\t\t\tthis.style.backgroundImage = isEmpty ? null : `url(\"${src}\")`;\r\n\t\t}\r\n\t\tif (STRATEGIES[this.mode].afterLoad) {\r\n\t\t\tSTRATEGIES[this.mode].afterLoad.call(this, shadowImg, isEmpty);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected connectedCallback() {\r\n\t\tif ((this.constructor as typeof SmartImage).className) {\r\n\t\t\tthis.classList.add((this.constructor as typeof SmartImage).className);\r\n\t\t}\r\n\t\tthis.alt = this.alt || this.getAttribute('data-alt') || '';\r\n\t\tif (!this.hasAttribute('role')) {\r\n\t\t\tthis.setAttribute('role', 'img');\r\n\t\t}\r\n\t\tthis.update(true);\r\n\t\tif (this.lazyAuto && !this.lazyTriggered) {\r\n\t\t\tgetIObserver().observe(this);\r\n\t\t\tthis._detachLazyTrigger = function () {\r\n\t\t\t\tgetIObserver().unobserve(this);\r\n\t\t\t\tthis._detachLazyTrigger = null;\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\tprotected disconnectedCallback() {\r\n\t\tthis.removeAttribute('lazy-triggered');\r\n\t\tthis._detachLazyTrigger && this._detachLazyTrigger();\r\n\t\tif (this._srcRules) {\r\n\t\t\tthis._srcRules.removeListener(this._onMatchChange);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected attributeChangedCallback(attrName: string, oldVal: string, newVal: string) {\r\n\t\tswitch (attrName) {\r\n\t\t\tcase 'data-alt':\r\n\t\t\t\tthis.alt = this.alt || this.getAttribute('data-alt') || '';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'alt':\r\n\t\t\t\tthis._innerImg && (this._innerImg.alt = this.alt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'data-src':\r\n\t\t\t\tthis.srcRules = SmartRuleList.parse<string>(newVal, SmartRuleList.STRING_PARSER);\r\n\t\t\t\tthis.refresh();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'data-src-base':\r\n\t\t\t\tthis.refresh();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'mode':\r\n\t\t\t\tthis.changeMode(oldVal, newVal);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'lazy-triggered':\r\n\t\t\t\tthis.update(true);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected get _innerImage() {\r\n\t\tif (!this._innerImg) {\r\n\t\t\tthis._innerImg = this.querySelector('img');\r\n\t\t\tif (!this._innerImg) {\r\n\t\t\t\tthis._innerImg = document.createElement('img');\r\n\t\t\t\tthis.appendChild(this._innerImg);\r\n\t\t\t}\r\n\t\t\tthis._innerImg.className = 'inner-image';\r\n\t\t\tthis._innerImg.alt = this.alt;\r\n\t\t}\r\n\t\treturn this._innerImg;\r\n\t}\r\n\r\n\tprotected get _shadowImg() {\r\n\t\tif (!this._shadowImageElement) {\r\n\t\t\tthis._shadowImageElement = new Image();\r\n\t\t\tthis._shadowImageElement.onload = this._onLoad;\r\n\t\t\tthis._shadowImageElement.onerror = this._onError;\r\n\t\t}\r\n\t\treturn this._shadowImageElement;\r\n\t}\r\n\r\n\tprivate _onLoad() {\r\n\t\tthis.syncImage();\r\n\t\tthis.removeAttribute('error');\r\n\t\tthis.setAttribute('loaded', '');\r\n\t\ttriggerComponentEvent(this, 'load');\r\n\t\tthis._onReady();\r\n\t}\r\n\r\n\tprivate _onError() {\r\n\t\tthis.setAttribute('error', '');\r\n\t\ttriggerComponentEvent(this, 'error');\r\n\t\tthis._onReady();\r\n\t}\r\n\r\n\tprivate _onReady() {\r\n\t\tif (!this.ready) {\r\n\t\t\tthis.setAttribute('ready', '');\r\n\t\t\ttriggerComponentEvent(this, 'ready');\r\n\t\t\tif (this.hasAttribute('container-class') || this.hasAttribute('container-class-target')) {\r\n\t\t\t\tif (this.hasAttribute('container-class-onload') && this.error) return;\r\n\t\t\t\tconst containerCls = this.getAttribute('container-class') || 'img-container-loaded';\r\n\t\t\t\tconst target = this.getAttribute('container-class-target');\r\n\t\t\t\tconst targetEl = target ? this.closest(target) : this.parentNode;\r\n\t\t\t\t(targetEl) && (targetEl as HTMLElement).classList.add(containerCls);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static isEmptyImage(src: string) {\r\n\t\treturn src === SmartImage.EMPTY_IMAGE;\r\n\t}\r\n}\r\n\r\nexport default SmartImage;\r\n","/**\r\n * Group restriction manager for {@link SmartVideo}\r\n * Only one video in group can be played\r\n * Empty group is ignored\r\n * @version 1.0.1\r\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya\r\n */\r\nimport SmartVideo from './smart-video';\r\n\r\ninterface VideoManager {\r\n\t[key: string]: SmartVideo\r\n}\r\n\r\nconst managerMap: VideoManager = {};\r\n\r\nexport class VideoGroupRestrictionManager {\r\n\t/**\r\n\t * @debug info\r\n\t */\r\n\tstatic get _managerMap() {\r\n\t\treturn managerMap;\r\n\t}\r\n\r\n\t/**\r\n\t * Register instance play state in group\r\n\t */\r\n\tpublic static registerPlay(instance: SmartVideo) {\r\n\t\tif (instance.group) {\r\n\t\t\tconst current = managerMap[instance.group];\r\n\t\t\tif (current && current !== instance && current.active) {\r\n\t\t\t\tif (current.dispatchEvent(new Event('evideo:mangedpause', {bubbles: true}))) {\r\n\t\t\t\t\tcurrent.pause();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tmanagerMap[instance.group] = instance;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Unregister instance\r\n\t */\r\n\tpublic static unregister(instance: SmartVideo) {\r\n\t\tif (instance.group) {\r\n\t\t\tconst reg = managerMap[instance.group];\r\n\t\t\tif (reg === instance) {\r\n\t\t\t\tmanagerMap[instance.group] = null;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default VideoGroupRestrictionManager;\r\n","import SmartVideo from './smart-video';\r\n\r\nconst RATIO_TO_ACTIVATE = 0.75; // TODO: customizable\r\nconst RATIO_TO_DEACTIVATE = 0.20; // TODO: customizable\r\n\r\nlet iObserver: IntersectionObserver;\r\n\r\nexport function getIObserver(lazy: boolean = false) {\r\n\tif (!iObserver && !lazy) {\r\n\t\tiObserver = new IntersectionObserver(function (entries) {\r\n\t\t\tentries.forEach(handleViewport);\r\n\t\t}, {\r\n\t\t\tthreshold: [RATIO_TO_DEACTIVATE, RATIO_TO_ACTIVATE]\r\n\t\t});\r\n\t}\r\n\treturn iObserver;\r\n}\r\n\r\nfunction handleViewport(entire: IntersectionObserverEntry) {\r\n\tif (!(entire.target instanceof SmartVideo)) return;\r\n\tconst {target: video} = entire;\r\n\t// Videos that playing and out of min ratio RATIO_TO_DEACTIVATE should be stopped\r\n\tif (video.onplaying && entire.intersectionRatio <= RATIO_TO_DEACTIVATE) {\r\n\t\tvideo.pause();\r\n\t}\r\n\t// Play should starts only for inactive and background(muted) videos that are visible more then on RATIO_TO_ACTIVATE\r\n\tif (!video.onplaying && video.muted && entire.intersectionRatio >= RATIO_TO_ACTIVATE) {\r\n\t\tvideo.play(true);\r\n\t}\r\n}\r\n","/**\r\n * BaseProvider class for video API providers\r\n * @version 1.0.0\r\n * @author Alexey Stsefanovich (ala'n)\r\n */\r\nimport SmartVideo from './smart-video';\r\nimport PlayerState = YT.PlayerState;\r\n\r\nexport enum PlayerStates {\r\n\tBUFFERING = 3,\r\n\tENDED = 0,\r\n\tPAUSED = 2,\r\n\tPLAYING = 1,\r\n\tUNSTARTED = -1,\r\n\tVIDEO_CUED = 5,\r\n\tUNINITIALIZED = null\r\n}\r\n\r\nexport type BaseProviderConstructor = new(component: SmartVideo) => BaseProvider;\r\n\r\nexport abstract class BaseProvider {\r\n\tprotected component: SmartVideo;\r\n\tprotected _ready: Promise<any>;\r\n\r\n\tpublic constructor(component: SmartVideo) {\r\n\t\tthis.component = component;\r\n\t}\r\n\r\n\t/**\r\n\t * Wraps _ready promise\r\n\t * @returns {Promise}\r\n\t */\r\n\tget ready() {\r\n\t\tif (!this._ready) {\r\n\t\t\tconst res = Promise.reject('Not Initialized');\r\n\t\t\t// eslint-disable-next-line no-console\r\n\t\t\tres.catch((e) => console.log('Rejected Video Operation: ', e));\r\n\t\t\treturn res;\r\n\t\t}\r\n\t\treturn this._ready;\r\n\t}\r\n\r\n\tpublic abstract bind(): void;\r\n\tpublic abstract unbind(): void;\r\n\r\n\tpublic abstract getState(): PlayerStates | PlayerState;\r\n\r\n\tprotected abstract seekTo(pos?: number): void;\r\n\tprotected abstract play(): void;\r\n\tprotected abstract pause(): void;\r\n\tprotected abstract stop(): void;\r\n\r\n\tpublic abstract focus(): void;\r\n\r\n\tprotected toggle() {\r\n\t\tif (this.getState() === PlayerStates.PAUSED) {\r\n\t\t\tthis.play();\r\n\t\t} else {\r\n\t\t\tthis.pause();\r\n\t\t}\r\n\t}\r\n\r\n\t// Safe methods executed after api ready\r\n\tpublic safeSeekTo(pos: number) {\r\n\t\tthis.ready.then(() => this.seekTo(pos));\r\n\t}\r\n\r\n\tpublic safePlay() {\r\n\t\tthis.ready.then(() => this.play());\r\n\t}\r\n\r\n\tpublic safePause() {\r\n\t\tthis.ready.then(() => this.pause());\r\n\t}\r\n\r\n\tpublic safeStop() {\r\n\t\tthis.ready.then(() => this.stop());\r\n\t}\r\n\r\n\tpublic safeToggle() {\r\n\t\tthis.ready.then(() => this.toggle());\r\n\t}\r\n}\r\n","/**\r\n * Video Registry class to store video API providers\r\n * @version 1.0.0\r\n * @author Yuliya Adamskaya\r\n */\r\nimport {Observable} from '@helpers/abstract/observable';\r\nimport {BaseProviderConstructor} from './smart-video-provider';\r\n\r\ninterface ProviderMap {\r\n\t[name: string]: BaseProviderConstructor;\r\n}\r\n\r\nexport class EmbeddedVideoProviderRegistry extends Observable {\r\n\tprivate static _instance: EmbeddedVideoProviderRegistry = null;\r\n\r\n\tprivate providers: ProviderMap = {};\r\n\r\n\tpublic static get instance() {\r\n\t\tif (!EmbeddedVideoProviderRegistry._instance) {\r\n\t\t\tEmbeddedVideoProviderRegistry._instance = new EmbeddedVideoProviderRegistry();\r\n\t\t}\r\n\t\treturn EmbeddedVideoProviderRegistry._instance;\r\n\t}\r\n\r\n\tpublic register(provider: BaseProviderConstructor, name: string) {\r\n\t\tthis.providers[name] = provider;\r\n\t\tthis.fire(name, provider);\r\n\t}\r\n\r\n\tpublic getProvider(name: string) {\r\n\t\treturn this.providers[name.toLowerCase()];\r\n\t}\r\n}\r\n\r\nexport default EmbeddedVideoProviderRegistry.instance;\r\n","/**\r\n * Smart Video Embedded\r\n * @version 1.0.2\r\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya\r\n *\r\n * @description:\r\n * SmartVideoEmbedded - custom element, that provides ability to add and configure embedded video using one tag.\r\n * Supported features:\r\n * - extendable 'Providers' realization for different video types, support 'youtube' and 'brightcove' out of box\r\n * - single active player restriction by grouping elements\r\n * - provides events on state change\r\n * - provides 'HTMLMedia like' API that is safe and will executed after real api will be ready\r\n * - manual initialization - disabled component will not be initialized until it not enabled or play action triggered\r\n * - hot changes\r\n *\r\n * Attributes:\r\n * {String} video-id - id of embedded video\r\n * {String} video-type - type of video provider ('youtube', 'video')\r\n *\r\n * {String} [group] - group name, only one video player in group can be active\r\n *\r\n * {Boolean} [disabled] - prevents video api initialization\r\n *\r\n * {Boolean} [autofocus] - set focus to player on play\r\n * {Boolean} [autoplay] - start play automatically on initialization (note initialization not happens until video is disabled)\r\n * {Boolean} [hide-controls] - hiding video player controls\r\n * {Boolean} [hide-subtitles] - disable subtitles settings if player supports subtitles\r\n *\r\n *\r\n * @readonly {Boolean} ready - marker that indicates that video api loaded\r\n * @readonly {Boolean} active - marker that indicates that video paying\r\n *\r\n *\r\n * @event evideo:ready - (bubbles) happens when video api is ready\r\n * @event evideo:play - (bubbles) happens when video starts playing\r\n * @event evideo:paused - (bubbles) happens when video paused\r\n * @event evideo:ended - (bubbles) happens when video ends\r\n *\r\n * @event evideo:mangedpause - (bubbles) happens when video paused by video group restriction manager\r\n *\r\n * @example:\r\n * <smart-video\r\n *    [disabled]\r\n *    title=\"Video Title\"\r\n *    [group=\"videoGroup\"]\r\n *    video-type=\"youtube|video\"\r\n *    data-id=\"##VIDEOID##\"></smart-video-embedded>\r\n */\r\nimport {debounce} from '@helpers/function-utils';\r\n\r\nimport VideoGroupRestrictionManager from './smart-video-manager';\r\n\r\nimport {getIObserver} from './smart-video-iobserver';\r\nimport {attr} from '@helpers/decorators/attr';\r\nimport {BaseProvider, PlayerStates} from './smart-video-provider';\r\nimport providerRegistry from './smart-video-registry';\r\nimport SmartQuery from '../../smart-query/ts/smart-query';\r\nimport {triggerComponentEvent} from '@helpers/component-utils';\r\n\r\nexport class SmartVideo extends HTMLElement {\r\n    @attr() public videoType: string;\r\n    @attr() public group: string;\r\n    @attr({conditional: true}) public disabled: boolean;\r\n    @attr({conditional: true}) public autoplay: boolean;\r\n    @attr({conditional: true}) public autofocus: boolean;\r\n    @attr({conditional: true}) public preload: boolean;\r\n    @attr({conditional: true}) public muted: boolean;\r\n    @attr({conditional: true}) public loop: boolean;\r\n    @attr({conditional: true}) public hideControls: boolean;\r\n    @attr({conditional: true}) public hideSubtitles: boolean;\r\n    @attr({conditional: true, readonly: true}) public ready: boolean;\r\n    @attr({conditional: true, readonly: true}) public active: boolean;\r\n    @attr({conditional: true, readonly: true}) public playInViewport: boolean;\r\n\r\n    private _provider: BaseProvider;\r\n    private _conditionQuery: SmartQuery;\r\n\r\n    static get is() {\r\n        return 'smart-video';\r\n    }\r\n\r\n    /**\r\n     * @enum Map with possible Player States\r\n     * values: BUFFERING, ENDED, PAUSED, PLAYING, UNSTARTED, VIDEO_CUED, UNINITIALIZED\r\n     */\r\n    static get PLAYER_STATES() {\r\n        return PlayerStates;\r\n    }\r\n\r\n    static get observedAttributes() {\r\n        return ['video-type', 'disabled', 'data-id', 'data-src'];\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        this._onError = this._onError.bind(this);\r\n        this._onConditionStateChange = this._onConditionStateChange.bind(this);\r\n    }\r\n\r\n    private connectedCallback() {\r\n        this.classList.add(SmartVideo.is);\r\n        this.setAttribute('role', 'application');\r\n        this.innerHTML += '<!-- Inner Content, do not modify it manually -->';\r\n        providerRegistry.addListener(this._onRegistryStateChange);\r\n        this._onConditionStateChange();\r\n        if (this.conditionQuery) {\r\n            this.conditionQuery.addListener(this._onConditionStateChange);\r\n        }\r\n        !this.disabled && this.reinitInstance();\r\n    }\r\n\r\n    private disconnectedCallback() {\r\n        providerRegistry.removeListener(this._onRegistryStateChange);\r\n        if (this.conditionQuery) {\r\n            this.conditionQuery.removeListener(this._onConditionStateChange);\r\n        }\r\n        this.detachViewportConstraint();\r\n        this._provider && this._provider.unbind();\r\n    }\r\n\r\n    private attributeChangedCallback(attrName: string, oldVal: string, newVal: string) {\r\n        if (oldVal === newVal) return;\r\n        switch (attrName) {\r\n            case 'data-id':\r\n            case 'data-src':\r\n            case 'video-type':\r\n                if (this._provider || this._provider === null) {\r\n                    this.deferedReinit();\r\n                }\r\n                break;\r\n            case 'disabled':\r\n                if (!this._provider) {\r\n                    this.deferedReinit();\r\n                }\r\n                break;\r\n        }\r\n    }\r\n\r\n    private reinitInstance() {\r\n        if (!this.disabled) {\r\n            this._provider && this._provider.unbind();\r\n\r\n            const provider = providerRegistry.getProvider(this.videoType);\r\n            if (provider) {\r\n                this._provider = new provider(this);\r\n                this._provider.bind();\r\n                if (this.playInViewport) {\r\n                    this.attachViewportConstraint();\r\n                }\r\n            } else {\r\n                this._provider = null;\r\n            }\r\n        }\r\n    }\r\n\r\n    public deferedReinit = debounce(() => this.reinitInstance());\r\n\r\n    public buildOptions() {\r\n        return {\r\n            title: this.title,\r\n            autoplay: this.autoplay,\r\n            muted: this.muted,\r\n            hideControls: this.hideControls,\r\n            dataId: this.dataset.id,\r\n            dataSrc: this.dataset.src,\r\n        };\r\n    }\r\n\r\n    private _updateMarkers(addValue: string, removeValue: string) {\r\n        const target = this.getAttribute('marker-target');\r\n        const targetEl = target ? this.closest(target) : this;\r\n        (targetEl && addValue) && targetEl.classList.add(addValue);\r\n        (targetEl && removeValue) && targetEl.classList.remove(removeValue);\r\n    }\r\n\r\n    private _onConditionStateChange() {\r\n        if (!this.conditionQuery || this.conditionQuery.matches) {\r\n            this.deferedReinit();\r\n            if (this.state === PlayerStates.PAUSED) {\r\n                this.play(true);\r\n            }\r\n            this._updateMarkers(\r\n                this.getAttribute('load-condition-marker'),\r\n                this.getAttribute('load-condition-declined-marker')\r\n            );\r\n        } else {\r\n            this.pause();\r\n            this._updateMarkers(\r\n                this.getAttribute('load-condition-declined-marker'),\r\n                this.getAttribute('load-condition-marker')\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Seek to given position of video\r\n     * @returns {Promise | void}\r\n     */\r\n    public seekTo(pos: number) {\r\n        return this._provider && this._provider.safeSeekTo(pos);\r\n    }\r\n\r\n    /**\r\n     * Start playing video\r\n     * @returns {Promise | void}\r\n     */\r\n    public play(reset: boolean = false) {\r\n        if (this.disabled && reset) {\r\n            this.disabled = false;\r\n        }\r\n        return this._provider && this._provider.safePlay();\r\n    }\r\n\r\n    /**\r\n     * Pause playing video\r\n     * @returns {Promise | void}\r\n     */\r\n    public pause() {\r\n        return this._provider && this._provider.safePause();\r\n    }\r\n\r\n    /**\r\n     * Stop playing video\r\n     * @returns {Promise | void}\r\n     */\r\n    public stop() {\r\n        return this._provider && this._provider.safeStop();\r\n    }\r\n\r\n    /**\r\n     * Toggle play/pause state of the video\r\n     * @returns {Promise | void}\r\n     */\r\n    public toggle() {\r\n        return this._provider && this._provider.safeToggle();\r\n    }\r\n\r\n    /**\r\n     * @override\r\n     */\r\n    public focus() {\r\n        this._provider && this._provider.focus();\r\n    }\r\n\r\n    // Video live-cycle handlers\r\n    public _onReady() {\r\n        this.setAttribute('ready', 'true');\r\n        if (this.hasAttribute('ready-class')) {\r\n            this.classList.add(this.getAttribute('ready-class'));\r\n        }\r\n        this.dispatchEvent(new Event('evideo:ready', {bubbles: true}));\r\n    }\r\n\r\n    public _onError() {\r\n        this.setAttribute('ready', '');\r\n        this.setAttribute('error', '');\r\n        triggerComponentEvent(this, 'error');\r\n        triggerComponentEvent(this, 'ready');\r\n    }\r\n\r\n    public _onDetach() {\r\n        this.removeAttribute('active');\r\n        this.removeAttribute('ready');\r\n        if (this.hasAttribute('ready-class')) {\r\n            this.classList.remove(this.getAttribute('ready-class'));\r\n        }\r\n    }\r\n\r\n    public _onPlay() {\r\n        if (this.autofocus) {\r\n            this.focus();\r\n        }\r\n        this.setAttribute('active', '');\r\n        this.dispatchEvent(new Event('evideo:play', {bubbles: true}));\r\n        VideoGroupRestrictionManager.registerPlay(this);\r\n    }\r\n\r\n    public _onPaused() {\r\n        this.removeAttribute('active');\r\n        this.dispatchEvent(new Event('evideo:paused', {bubbles: true}));\r\n        VideoGroupRestrictionManager.unregister(this);\r\n    }\r\n\r\n    public _onEnded() {\r\n        this.removeAttribute('active');\r\n        this.dispatchEvent(new Event('evideo:ended', {bubbles: true}));\r\n        VideoGroupRestrictionManager.unregister(this);\r\n    }\r\n\r\n    /**\r\n     * Current player state, see {@link SmartVideo.PLAYER_STATES} values\r\n     */\r\n    get state() {\r\n        return this._provider ? this._provider.getState() : PlayerStates.UNINITIALIZED;\r\n    }\r\n\r\n    get conditionQuery() {\r\n        if (!this._conditionQuery && this._conditionQuery !== null) {\r\n            const query = this.getAttribute('load-condition');\r\n            this._conditionQuery = query ? new SmartQuery(query) : null;\r\n        }\r\n        return this._conditionQuery;\r\n    }\r\n\r\n    private _onRegistryStateChange = (name: string) => {\r\n        if (name === this.videoType) {\r\n            this.reinitInstance();\r\n        }\r\n    };\r\n\r\n    public attachViewportConstraint() {\r\n        getIObserver().observe(this);\r\n    }\r\n\r\n    public detachViewportConstraint() {\r\n        const observer = getIObserver(true);\r\n        observer && observer.unobserve(this);\r\n    }\r\n}\r\n\r\ncustomElements.define(SmartVideo.is, SmartVideo);\r\nexport default SmartVideo;\r\n","/***\r\n * Function that do nothing\r\n */\r\n/* tslint:disable-next-line no-empty */\r\nexport function noop() {\r\n\r\n}\r\n\r\n/***\r\n * Creates a debounced function that delays invoking func until after wait milliseconds have elapsed\r\n * since the last time the debounced function was invoked.\r\n * The func is invoked with the last arguments provided to the debounced function.\r\n * @param fn\r\n * @param wait\r\n * @param immediate indicate whether func should be invoked on the leading and/or trailing edge of the wait timeout.\r\n * @returns {Function}\r\n */\r\n/* tslint:disable-next-line ban-types */\r\nexport function debounce<T extends Function>(fn: T, wait: number = 10, immediate: boolean = false): T {\r\n    let timeout: ReturnType<typeof setTimeout> = null;\r\n    return function (...args: any) {\r\n        const context = this;\r\n        const later = function () {\r\n            timeout = null;\r\n            if (!immediate) fn.apply(context, args);\r\n        };\r\n        const callNow = immediate && !timeout;\r\n        clearTimeout(timeout);\r\n        timeout = setTimeout(later, wait);\r\n        if (callNow) fn.apply(context, args);\r\n    } as any as T\r\n}\r\n\r\n/***\r\n * Creates a throttled executed function.\r\n * The func is invoked with the last arguments provided to the throttled function.\r\n * @param fn\r\n * @param threshold - indicates how often function could be called\r\n * @returns {Function}\r\n */\r\n/* tslint:disable-next-line ban-types */\r\nexport function throttle <T extends Function>(fn: T, threshold: number = 250): T {\r\n    let last: number;\r\n    let deferTimer: ReturnType<typeof setTimeout>;\r\n    return function (...args: any) {\r\n        const context = this;\r\n        const now = Date.now();\r\n        if (last && now < last + threshold) {\r\n            // hold on to it\r\n            clearTimeout(deferTimer);\r\n            deferTimer = setTimeout(function () {\r\n                last = now;\r\n                fn.apply(context, args);\r\n            }, threshold);\r\n        } else {\r\n            last = now;\r\n            fn.apply(context, args);\r\n        }\r\n    } as any as T;\r\n}\r\n","/**\r\n * Youtube API provider for {@link SmartVideo}\r\n * @version 1.0.0\r\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya\r\n * @extends BaseProvider\r\n * @protected\r\n */\r\nimport {generateUId, loadScript} from '@helpers/common-utils';\r\nimport SmartVideo from '../smart-video';\r\nimport {BaseProvider, PlayerStates} from '../smart-video-provider';\r\nimport EmbeddedVideoProviderRegistry from '../smart-video-registry';\r\n\r\ndeclare global {\r\n\tinterface YT extends Promise<void> {\r\n\t\tPlayer: YT.Player,\r\n\t}\r\n\tinterface Window {\r\n\t\tYT?: YT;\r\n\t\tonYouTubeIframeAPIReady?: () => void;\r\n\t}\r\n}\r\n\r\ninterface VideoOptions {\r\n\ttitle: string,\r\n\tdataId: string,\r\n\tautoplay: boolean,\r\n\thideControls: boolean\r\n}\r\n\r\nexport class YouTubeProvider extends BaseProvider {\r\n\tprivate _el: HTMLIFrameElement;\r\n\tprivate _api: YT.Player;\r\n\r\n\tstatic get videoName() {\r\n\t\treturn 'youtube';\r\n\t}\r\n\r\n\tprivate static _coreApiPromise: Promise<void>;\r\n\r\n\tprotected static getCoreApi() {\r\n\t\tif (!YouTubeProvider._coreApiPromise) {\r\n\t\t\tYouTubeProvider._coreApiPromise = new Promise((resolve) => {\r\n\t\t\t\tif (window.YT && window.YT.Player) {\r\n\t\t\t\t\treturn resolve(window.YT);\r\n\t\t\t\t}\r\n\t\t\t\tloadScript('YT_API_SOURCE', '//www.youtube.com/iframe_api');\r\n\t\t\t\tconst cbOrigin = window.onYouTubeIframeAPIReady;\r\n\t\t\t\twindow.onYouTubeIframeAPIReady = () => {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\t(typeof cbOrigin === 'function') && cbOrigin.apply(window);\r\n\t\t\t\t\t} catch (err) { // eslint-disable-line\r\n\t\t\t\t\t\t// Do Nothing\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn resolve(window.YT);\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn YouTubeProvider._coreApiPromise;\r\n\t}\r\n\r\n\tprotected static buildIframeUrl(id: string, autoplay: boolean) {\r\n\t\treturn `//www.youtube.com/embed/${id}?wmode=transparent&rel=0&showinfo=0&iv_load_policy=3&enablejsapi=1&autoplay=${Number(autoplay)}`;\r\n\t}\r\n\r\n\tprotected static buildIframe(data: VideoOptions) {\r\n\t\tconst el = document.createElement('iframe');\r\n\t\tel.id = 'yt-video-' + generateUId();\r\n\t\tel.className = 'sev-inner sev-youtube';\r\n\t\tel.style.width = '100%';\r\n\t\tel.style.height = '100%';\r\n\t\tel.title = data.title;\r\n\t\tel.setAttribute('aria-label', data.title);\r\n\t\tel.setAttribute('frameborder', '0');\r\n\t\tel.setAttribute('tabindex', '0');\r\n\t\tel.setAttribute('allowfullscreen', 'yes');\r\n\t\tel.src = YouTubeProvider.buildIframeUrl(data.dataId, data.autoplay);\r\n\t\treturn el;\r\n\t}\r\n\r\n\tpublic bind() {\r\n\t\tconst iframeLoad = new Promise((resolve) => {\r\n\t\t\tthis._el = YouTubeProvider.buildIframe(this.component.buildOptions());\r\n\t\t\tthis._el.onload = function () {\r\n\t\t\t\tresolve();\r\n\t\t\t};\r\n\t\t\tthis.component.appendChild(this._el);\r\n\t\t});\r\n\r\n\t\tthis._ready = Promise.all([YouTubeProvider.getCoreApi(), iframeLoad]).then(\r\n\t\t\t() => (new Promise((resolve, reject) => {\r\n\t\t\t\tthis._api = new YT.Player(this._el, {\r\n\t\t\t\t\tevents: {\r\n\t\t\t\t\t\tonError: () => reject(this), // TODO do smth with it\r\n\t\t\t\t\t\tonReady: () => resolve(this),\r\n\t\t\t\t\t\tonStateChange: this._onStateChange\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}))\r\n\t\t);\r\n\t\tthis._ready.then(() => this.component._onReady());\r\n\t}\r\n\r\n\tpublic unbind() {\r\n\t\tthis.component._onDetach();\r\n\t\tif (this._api) {\r\n\t\t\tthis._api.destroy();\r\n\t\t\tthis._api = null;\r\n\t\t}\r\n\t\tif (this._el && this._el.parentNode) {\r\n\t\t\tthis._el.parentNode.removeChild(this._el);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _onStateChange = (event: YT.OnStateChangeEvent) => {\r\n\t\tswitch (+event.data) {\r\n\t\t\tcase PlayerStates.PLAYING:\r\n\t\t\t\tthis.component._onPlay();\r\n\t\t\t\tbreak;\r\n\t\t\tcase PlayerStates.PAUSED:\r\n\t\t\t\tthis.component._onPaused();\r\n\t\t\t\tbreak;\r\n\t\t\tcase PlayerStates.ENDED:\r\n\t\t\t\tthis.component._onEnded();\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t};\r\n\r\n\tpublic focus() {\r\n\t\tif (this._el && this._el.contentWindow) {\r\n\t\t\tthis._el.contentWindow.focus();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getState() {\r\n\t\tif (this._api && typeof this._api.getPlayerState === 'function') {\r\n\t\t\treturn this._api.getPlayerState();\r\n\t\t}\r\n\t\treturn PlayerStates.UNINITIALIZED;\r\n\t}\r\n\r\n\tpublic seekTo(pos: number) {\r\n\t\tthis._api.seekTo(pos, false);\r\n\t}\r\n\r\n\tpublic play() {\r\n\t\tif (this.getState() === PlayerStates.ENDED) {\r\n\t\t\tthis._api.seekTo(0, false);\r\n\t\t}\r\n\t\tthis._api.playVideo();\r\n\t}\r\n\r\n\tpublic pause() {\r\n\t\tthis._api.pauseVideo();\r\n\t}\r\n\r\n\tpublic stop() {\r\n\t\tthis._api.stopVideo();\r\n\t}\r\n}\r\n\r\nEmbeddedVideoProviderRegistry.register(YouTubeProvider, YouTubeProvider.videoName);\r\n","/**\r\n * Common function that loads script async\r\n * @param {String} id - unique script id that used as a marker to prevent feature load\r\n * @param {String} src - script src (url) to load\r\n */\r\nexport function loadScript(id: string, src: string) {\r\n\tif (!document.getElementById(id)) {\r\n\t\tconst tag = document.createElement('script');\r\n\t\ttag.id = id;\r\n\t\ttag.async = true;\r\n\t\ttag.src = src;\r\n\t\tconst firstScriptTag = document.getElementsByTagName('script')[0];\r\n\t\tfirstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\r\n\t}\r\n}\r\n\r\n/**\r\n * Generate unique id\r\n * @returns {String}\r\n */\r\nexport function generateUId(): string {\r\n\tconst fp = Date.now().toString(32);\r\n\tconst sp = Math.round(Math.random() * 1024 * 1024).toString(32);\r\n\treturn fp + '-' + sp;\r\n}\r\n/**\r\n * Deep compare\r\n */\r\nexport function deepCompare(obj1: any, obj2: any): boolean {\r\n\tif (Object.is(obj1, obj2)) return true;\r\n\tif (typeof obj1 !== typeof obj1) return false;\r\n\tif (typeof obj1 === 'object') {\r\n\t\tconst keys1 = Object.keys(obj1);\r\n\t\tconst keys2 = Object.keys(obj2);\r\n\t\tif (keys1.length !== keys2.length) return false;\r\n\t\treturn !keys1.some((key) => !deepCompare(obj1[key], obj2[key]));\r\n\t}\r\n\treturn false;\r\n}\r\n","/**\r\n * Simple Video API provider for {@link SmartVideo}\r\n * @author Yuliya Adamskaya\r\n */\r\n\r\nimport SmartVideo from '../smart-video';\r\nimport {BaseProvider, PlayerStates} from '../smart-video-provider';\r\nimport EmbeddedVideoProviderRegistry from '../smart-video-registry';\r\n\r\ninterface VideoOptions {\r\n    autoplay: boolean,\r\n    muted: boolean,\r\n    hideControls: boolean,\r\n    dataSrc: string,\r\n}\r\n\r\nexport class VideoProvider extends BaseProvider {\r\n    private _el: HTMLVideoElement;\r\n\r\n    static get videoName() {\r\n        return 'video';\r\n    }\r\n\r\n    protected static buildSrc(src: string, type?: string) {\r\n        return `<source src=${src} type=\"${type ? type : 'video/mp4'}\">`;\r\n    }\r\n\r\n    protected static build(data: VideoOptions) {\r\n        const el = document.createElement('video');\r\n        el.innerHTML = VideoProvider.buildSrc(data.dataSrc);\r\n        el.className = 'sev-inner';\r\n        el.autoplay = data.autoplay;\r\n        el.preload = 'auto';\r\n        el.loop = false;\r\n        el.tabIndex = 0;\r\n        el.muted = data.muted;\r\n        if (!data.hideControls) {\r\n            el.controls = true;\r\n        }\r\n        return el;\r\n    }\r\n\r\n    public bind() {\r\n        this._el = VideoProvider.build(this.component.buildOptions());\r\n        this.component.appendChild(this._el);\r\n        this._el.onerror = this.component._onError;\r\n        this._el.addEventListener('loadedmetadata', () => this.component._onReady());\r\n    }\r\n\r\n    public unbind() {\r\n        this.component._onDetach();\r\n        if (this._el && this._el.parentNode) {\r\n            this._el.parentNode.removeChild(this._el);\r\n        }\r\n    }\r\n\r\n    get ready() {\r\n        return Promise.resolve();\r\n    }\r\n\r\n    public focus() {\r\n        if (this._el) {\r\n            this._el.focus();\r\n        }\r\n    }\r\n\r\n    public getState() {\r\n        return PlayerStates.UNINITIALIZED;\r\n    }\r\n\r\n    public seekTo(pos: number) {\r\n        this._el.currentTime = pos;\r\n    }\r\n\r\n    public play() {\r\n        return this._el.play();\r\n    }\r\n\r\n    public pause() {\r\n        return this._el.pause()\r\n    }\r\n\r\n    public stop() {\r\n        return new Promise(() => {\r\n            this._el.pause();\r\n            this._el.currentTime = 0;\r\n        })\r\n    }\r\n}\r\n\r\nEmbeddedVideoProviderRegistry.register(VideoProvider, VideoProvider.videoName);\r\n\r\n","import { ISmartPopupActionParams, SmartPopup } from '@components/smart-popup/smart-popup';\r\n\r\nexport default class Group {\r\n  protected popups: object[] = [];\r\n\r\n  protected register(popup: SmartPopup) {\r\n    this.popups.push(popup);\r\n  }\r\n\r\n  protected remove(popup: SmartPopup) {\r\n    const index = this.popups.indexOf(popup);\r\n    (index >= 0) && this.popups.splice(index, 1);\r\n  }\r\n\r\n  protected show(popup: SmartPopup, params: ISmartPopupActionParams) {\r\n    this.popups.forEach((p: SmartPopup) => p.hide());\r\n    popup._show(params);\r\n  }\r\n\r\n  get size() {\r\n    return this.popups.length;\r\n  }\r\n}\r\n","import { ISmartPopupActionParams, SmartPopup } from '@components/smart-popup/smart-popup';\r\nimport Group from './smart-popup-manager.group';\r\n\r\nconst all: SmartPopup[] = [];\r\n\r\n// document.body.onclick = () => all.forEach((popup) => {\r\n//   popup.hide();\r\n// });\r\n\r\nfunction uniqueId(prefix: any) {\r\n  let idCounter = 0;\r\n  const id = ++idCounter;\r\n  return prefix.toString + id;\r\n}\r\n\r\nexport default {\r\n  groups: {},\r\n  register(popup: any) {\r\n    const { options: { group } } = popup;\r\n    if (group) {\r\n      this.groups[group] = this.groups[group] || new Group();\r\n      this.groups[group].register(popup);\r\n    }\r\n    all.push(popup);\r\n  },\r\n  remove(popup: any) {\r\n    const index = all.indexOf(popup);\r\n    if (index < 0) return;\r\n    all.splice(index, 1);\r\n    const { options: { group } } = popup;\r\n    if ((this.groups)[group]) {\r\n      this.groups[group].remove(popup);\r\n      if (!this.groups[group].size) {\r\n        delete this.groups[group];\r\n      }\r\n    }\r\n  },\r\n  show(popup: any, params: ISmartPopupActionParams) {\r\n    const { options: { group } } = popup;\r\n    if (this.groups[group]) {\r\n      this.groups[group].show(popup, params);\r\n    } else {\r\n      popup.show(params);\r\n    }\r\n  },\r\n  bindTriggerAndTarget(trigger: any, target: any) {\r\n    const uid = target.attr('id') || uniqueId('smart-popup-');\r\n    trigger.attr('data-target-id', uid);\r\n    target.attr('id', uid);\r\n  }\r\n};\r\n\r\n","import { triggerComponentEvent } from '../../helpers/component-utils';\r\nimport { ISmartTrigger } from '../smart-trigger/smart-triger-interface';\r\nimport Manager from '../smart-manager/smart-popup-manager';\r\n\r\nexport enum STATES { CLOSE, OPEN }\r\n\r\nexport interface ISmartPopupActionParams {\r\n  trigger?: ISmartTrigger;\r\n}\r\n\r\nexport interface ISmartPopup {\r\n  isOpen: boolean;\r\n\r\n  show(params?: ISmartPopupActionParams): this;\r\n\r\n  _show(params?: ISmartPopupActionParams): this;\r\n\r\n  hide(params?: ISmartPopupActionParams): this;\r\n\r\n  toggle(newState?: STATES): this;\r\n\r\n  lazyInit?(): Promise<boolean> | void;\r\n}\r\n\r\nclass SmartPopup extends HTMLElement implements ISmartPopup {\r\n  protected options = {\r\n    group: ''\r\n  };\r\n  protected Manager = Manager;\r\n\r\n  static readonly is: string = 'smart-popup';\r\n\r\n  static observedAttributes: Array<string> = ['class', 'data-close-on-esc', 'data-group'];\r\n\r\n  protected attributeChangedCallback(attr: string, prevValue: string, value: string) {\r\n    switch (attr) {\r\n      case 'class':\r\n        if (prevValue !== null && prevValue !== value) {\r\n          const wasClosed = prevValue.split(' ').indexOf(this.activeClass) === -1;\r\n          if (this.isOpen && wasClosed || !this.isOpen && !wasClosed) {\r\n            triggerComponentEvent(this, 'popupStateChange');\r\n          }\r\n        }\r\n        break;\r\n      case 'data-close-on-esc':\r\n        this.closeOnEsc();\r\n        break;\r\n      case 'data-group':\r\n        this.options.group = value;\r\n        this.Manager.remove(this);\r\n        this.Manager.register(this);\r\n    }\r\n  }\r\n\r\n  get activeClass(): string {\r\n    return this.getAttribute('active-class') || 'opened';\r\n  }\r\n\r\n  get isOpen(): boolean {\r\n    return this.classList.contains(this.activeClass);\r\n  }\r\n\r\n  get state(): STATES {\r\n    return this.isOpen ? STATES.OPEN : STATES.CLOSE;\r\n  }\r\n\r\n  get newState(): STATES {\r\n    return this.isOpen ? STATES.CLOSE : STATES.OPEN;\r\n  }\r\n\r\n  protected closeOnEsc() {\r\n    document.addEventListener('keydown', (evt) => {\r\n      if (evt.key === 'Escape') {\r\n        this.classList.remove(this.activeClass);\r\n      }\r\n    })\r\n  };\r\n\r\n  public show(params: ISmartPopupActionParams = {}) {\r\n    if (!this.isOpen) {\r\n      this.Manager.show(this, params);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  public _show(params: ISmartPopupActionParams = {}) {\r\n    this.classList.add(this.activeClass);\r\n    return this;\r\n  }\r\n\r\n  public hide(params: ISmartPopupActionParams = {}) {\r\n    this.classList.remove(this.activeClass);\r\n    return this;\r\n  }\r\n\r\n  public toggle(newState: STATES = this.newState, params?: ISmartPopupActionParams) {\r\n    switch (newState) {\r\n      case STATES.OPEN:\r\n        this.show(params);\r\n        break;\r\n      case STATES.CLOSE:\r\n        this.hide(params);\r\n        break;\r\n    }\r\n    return this;\r\n  }\r\n}\r\n\r\ncustomElements.define(SmartPopup.is, SmartPopup);\r\n\r\nexport { SmartPopup };\r\n","import { isTouch } from '../../helpers/device-utils';\r\nimport { ISmartTrigger } from './smart-triger-interface';\r\nimport { SmartPopup } from '../smart-popup/smart-popup';\r\n\r\nconst hoverHideDelay = isTouch() ? 0 : 1000;\r\nconst hoverShowEvent = isTouch() ? 'click' : 'mouseenter';\r\nconst hoverHideEvent = isTouch() ? 'click' : 'mouseleave';\r\n\r\nclass SmartPopupTrigger extends HTMLElement implements ISmartTrigger {\r\n  protected options = {\r\n    showEvent: '',\r\n    hideEvent: '',\r\n    mode: ''\r\n  };\r\n  protected popupShow: EventListener;\r\n  protected popupHide: EventListener;\r\n  protected timerId: number;\r\n\r\n  static readonly is: string = 'smart-popup-trigger';\r\n  public popup: SmartPopup;\r\n\r\n  static observedAttributes: Array<string> = ['data-target-id', 'data-event', 'data-mode'];\r\n\r\n  protected attributeChangedCallback(attr: string, prevValue: string, value: string) {\r\n    this.removeEvent();\r\n    switch (attr) {\r\n      case 'data-target-id':\r\n        if (prevValue !== value) {\r\n          this.popup = document.getElementById(value) as SmartPopup;\r\n        }\r\n        break;\r\n      case 'data-event':\r\n        this.setEvents(value);\r\n        break;\r\n      case 'data-mode':\r\n        this.setMode(value);\r\n    }\r\n    if (this.popup && this.options.showEvent && this.options.mode) {\r\n      this.attachEvents();\r\n    }\r\n  }\r\n\r\n  protected setEvents(value: string) {\r\n    switch (value) {\r\n      case 'hover':\r\n        this.options.showEvent = hoverShowEvent;\r\n        this.options.hideEvent = hoverHideEvent;\r\n        break;\r\n      default:\r\n        this.options.showEvent = this.options.hideEvent = value;\r\n    }\r\n  }\r\n\r\n  setMode(value: string) {\r\n    this.options.mode = value;\r\n  }\r\n\r\n  attachEvents() {\r\n    const options = this.popup;\r\n    switch (this.options.mode) {\r\n      case 'show':\r\n        this.addShowEvent(options);\r\n        break;\r\n      case 'hide':\r\n        this.addHideEvent(options);\r\n        break;\r\n      default:\r\n        if (this.options.showEvent === this.options.hideEvent) {\r\n          this.addEventListener(this.options.showEvent, this.togglePopup(options));\r\n        } else {\r\n          if (this.options.hideEvent === 'mouseleave') {\r\n            this.hoverSubEvents();\r\n          }\r\n          this.addShowEvent(options);\r\n          this.addHideEvent(options);\r\n        }\r\n    }\r\n  }\r\n\r\n  protected hoverSubEvents() {\r\n    this.popup.addEventListener('mouseenter', () => clearTimeout(this.timerId));\r\n    this.popup.addEventListener('mouseleave', (evt: Event) => this.popupHide(evt))\r\n  }\r\n\r\n  protected removeEvent() {\r\n    this.removeEventListener(this.options.showEvent, this.popupShow);\r\n    this.removeEventListener(this.options.hideEvent, this.popupHide);\r\n  }\r\n\r\n  protected addShowEvent(options: SmartPopup) {\r\n    this.popupShow = () => options.show();\r\n    this.addEventListener(this.options.showEvent, this.popupShow)\r\n  }\r\n\r\n  protected addHideEvent(options: SmartPopup) {\r\n    this.popupHide = () => {\r\n      this.timerId = setTimeout(() => {\r\n        options.hide();\r\n      }, hoverHideDelay);\r\n    };\r\n    this.addEventListener(this.options.hideEvent, this.popupHide);\r\n  }\r\n\r\n  protected togglePopup(options: SmartPopup) {\r\n    return this.popupShow = () => options.toggle();\r\n  }\r\n}\r\n\r\ncustomElements.define(SmartPopupTrigger.is, SmartPopupTrigger);\r\nexport {\r\n  SmartPopupTrigger\r\n}\r\n","import SmartCarousel from '../smart-carousel';\r\n\r\nabstract class SmartCarouselStrategy {\r\n\r\n\tprotected carousel: SmartCarousel;\r\n\r\n\tprotected constructor(carousel: SmartCarousel) {\r\n\t\tthis.carousel = carousel;\r\n\t}\r\n\r\n\tpublic abstract onAnimate(nextIndex: number, direction: string): void;\r\n\r\n\tpublic abstract cleanStyles(): void;\r\n}\r\n\r\nexport default SmartCarouselStrategy;\r\n","import SmartCarouselStrategy from './smart-carousel-strategy';\r\nimport SmartCarousel from '../smart-carousel';\r\n\r\nclass SmartSingleCarouselStrategy extends SmartCarouselStrategy {\r\n\r\n\tconstructor(carousel: SmartCarousel) {\r\n\t\tsuper(carousel);\r\n\t}\r\n\r\n\tpublic onAnimate(nextIndex: number, direction: string) {\r\n\t\tif (this.carousel.firstIndex === nextIndex) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.carousel.setAttribute('data-is-animated', 'true');\r\n\t\tthis.carousel.setAttribute('direction', direction);\r\n\r\n\t\tconst activeSlide = this.carousel.$slides[this.carousel.firstIndex];\r\n\t\tconst nextSlide = this.carousel.$slides[nextIndex];\r\n\r\n\t\tactiveSlide.classList.add(direction);\r\n\t\tnextSlide.classList.add(direction);\r\n\r\n\t\tactiveSlide.classList.add('prev');\r\n\r\n\t\tactiveSlide.addEventListener('animationend', (e) => this._cleanAnimation(e));\r\n\t\tnextSlide.addEventListener('animationend', (e) => this._cleanAnimation(e));\r\n\t}\r\n\r\n\tprivate _cleanAnimation(event: Event) {\r\n\t\tconst target = event.target as HTMLElement;\r\n\t\tconst direction = this.carousel.getAttribute('direction');\r\n\r\n\t\ttarget.classList.remove(direction);\r\n\t\ttarget.classList.remove('prev');\r\n\r\n\t\tthis.carousel.removeAttribute('data-is-animated');\r\n\t}\r\n\r\n\tpublic cleanStyles() {\r\n\r\n\t}\r\n}\r\n\r\nexport default SmartSingleCarouselStrategy;\r\n","import SmartCarouselStrategy from './smart-carousel-strategy';\r\nimport SmartCarousel from '../smart-carousel';\r\n\r\n\r\nclass SmartMultiCarouselStrategy extends SmartCarouselStrategy {\r\n\r\n\tconstructor(carousel: SmartCarousel) {\r\n\t\tsuper(carousel);\r\n\t}\r\n\r\n\tpublic onAnimate(nextIndex: number, direction: string) {\r\n\t\tconst slideStyles = getComputedStyle(this.carousel.$slides[this.carousel.firstIndex]);\r\n\t\tconst slideWidth = parseFloat(slideStyles.width) +\r\n\t\t\tparseFloat(slideStyles.marginLeft) +\r\n\t\t\tparseFloat(slideStyles.marginRight);\r\n\t\tconst areaWidth = slideWidth * this.carousel.$slides.length;\r\n\r\n\t\tconst transitionDuration = parseFloat(slideStyles.transitionDuration) * 1000; // ms\r\n\t\tconst currentLeft = parseFloat(slideStyles.left);\r\n\r\n\t\tif (this.carousel.firstIndex === nextIndex) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\tlet trans = 0;\r\n\r\n\t\tif ((nextIndex === 0 && direction === 'right' && this.carousel.firstIndex !== 0) || (this.carousel.firstIndex === 0 && direction === 'left')) {\r\n\t\t\tconst left = (direction === 'right') ? currentLeft + areaWidth : currentLeft - areaWidth;\r\n\r\n\t\t\tfor (let index = 0; index < this.carousel.activeCount; ++index) {\r\n\t\t\t\tthis.carousel.$slides[nextIndex + index].style.left = left + 'px';\r\n\t\t\t}\r\n\r\n\t\t\ttrans = -nextIndex * slideWidth - left;\r\n\t\t\tthis.carousel.$slides.forEach((el) => {\r\n\t\t\t\tel.style.transform = `translateX(${trans}px)`;\r\n\t\t\t});\r\n\r\n\t\t\tfor (let i = 0; i < this.carousel.activeCount; i++) {\r\n\t\t\t\tthis.carousel.$slides[this.carousel.firstIndex + i].style.left = currentLeft + 'px';\r\n\t\t\t\tconst time = (direction === 'right') ?\r\n\t\t\t\t\t(transitionDuration / this.carousel.activeCount) * i :\r\n\t\t\t\t\t(transitionDuration / this.carousel.activeCount) * (this.carousel.activeCount - i - 1);\r\n\t\t\t\tif (this.carousel.activeIndexes.indexOf(nextIndex + i) !== -1) {\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tthis.carousel.$slides[this.carousel.firstIndex + i].style.left = left + 'px';\r\n\t\t\t\t\t\tconst nextTrans = -nextIndex * slideWidth - left;\r\n\t\t\t\t\t\tthis.carousel.$slides[this.carousel.firstIndex + i].style.transform = `translateX(${nextTrans}px)`;\r\n\t\t\t\t\t}, time);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\ttrans = -nextIndex * slideWidth - currentLeft;\r\n\t\t\tthis.carousel.$slides.forEach((el) => {\r\n\t\t\t\tel.style.transform = `translateX(${trans}px)`;\r\n\t\t\t\tel.style.left = currentLeft + 'px';\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tthis.carousel.setAttribute('data-is-animated', 'true');\r\n\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.carousel.removeAttribute('data-is-animated');\r\n\t\t}, transitionDuration);\r\n\r\n\t}\r\n\r\n\tpublic cleanStyles() {\r\n\t}\r\n}\r\n\r\nexport default SmartMultiCarouselStrategy;\r\n","class SmartCarouselSlide extends HTMLElement {\r\n\tstatic get is() { return 'smart-carousel-slide'; }\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tprotected connectedCallback() {\r\n\t\t//\r\n\t}\r\n\r\n\tpublic get index(): number {\r\n\t\treturn Array.prototype.indexOf.call(this.parentNode.childNodes, this);\r\n\t}\r\n\r\n\tpublic get active(): boolean {\r\n\t\treturn this.hasAttribute('active');\r\n\t}\r\n\tpublic _setActive(active: boolean) {\r\n\t\tthis.toggleAttribute('active', active);\r\n\t}\r\n}\r\n\r\ncustomElements.define(SmartCarouselSlide.is, SmartCarouselSlide);\r\nexport default SmartCarouselSlide;\r\n","import {attr} from '@helpers/decorators/attr';\r\nimport {deepCompare} from '@helpers/common-utils';\r\nimport {triggerComponentEvent} from '@helpers/component-utils';\r\nimport SmartRuleList from '@components/smart-query/ts/smart-rule-list';\r\nimport SmartCarouselStrategy from './strategy/smart-carousel-strategy';\r\nimport SmartSingleCarouselStrategy from './strategy/smart-single-carousel-strategy';\r\nimport SmartMultiCarouselStrategy from './strategy/smart-multi-carousel-strategy';\r\nimport SmartCarouselSlide from './smart-carousel-slide';\r\n\r\ninterface StrategyMap {\r\n    [type: string]: (carousel: SmartCarousel) => SmartCarouselStrategy\r\n}\r\n\r\ninterface CarouselCurrentConfig {\r\n    strategy?: 'single' | 'multiple',\r\n    count?: number,\r\n    className?: string\r\n}\r\n\r\nconst STRATEGIES: StrategyMap = { // TODO registry\r\n    single: (carousel: SmartCarousel) => new SmartSingleCarouselStrategy(carousel),\r\n    multi: (carousel: SmartCarousel) => new SmartMultiCarouselStrategy(carousel),\r\n};\r\n\r\nclass SmartCarousel extends HTMLElement {\r\n\r\n    static get is() {\r\n        return 'smart-carousel';\r\n    }\r\n\r\n    static get observedAttributes() {\r\n        return ['config', 'strategy'];\r\n    }\r\n\r\n    @attr() public config: string;\r\n    @attr({defaultValue: 'single'}) public strategy: string;\r\n\r\n    private _configRules: SmartRuleList<CarouselCurrentConfig>;\r\n    private _currentConfig: CarouselCurrentConfig;\r\n    private _strategy: SmartCarouselStrategy;\r\n\r\n    private readonly _onMatchChange: () => void;\r\n\r\n    constructor() {\r\n        super();\r\n        this._onMatchChange = this.update.bind(this, false);\r\n        this._currentConfig = {};\r\n    }\r\n\r\n    get $slidesArea(): HTMLElement {\r\n        return this.querySelector('[data-slides-area]');\r\n    }\r\n\r\n    get $slides(): SmartCarouselSlide[] {\r\n        // TODO cache\r\n        const els = this.$slidesArea.querySelectorAll(SmartCarouselSlide.is) as NodeListOf<SmartCarouselSlide>;\r\n        return els ? Array.from(els) : [];\r\n    }\r\n\r\n    get count(): number {\r\n        return this.$slides.length || 0;\r\n    }\r\n\r\n    get activeIndexes(): number[] {\r\n        return this.$slides.reduce((activeIndexes: number[], el, index) => {\r\n            if (el.active) {\r\n                activeIndexes.push(index);\r\n            }\r\n            return activeIndexes;\r\n        }, []);\r\n    }\r\n\r\n    get activeCount(): number {\r\n        return this._currentConfig.count || 0;\r\n    }\r\n\r\n    get customClass(): string {\r\n        return this._currentConfig.className;\r\n    }\r\n\r\n    public goTo(nextIndex: number, direction?: string, force: boolean = false) {\r\n        if (this.dataset.isAnimated) {\r\n            return;\r\n        }\r\n        // show last slides if count of slides isn't enough\r\n        if (nextIndex + this.activeCount > this.count || nextIndex < 0) {\r\n            nextIndex = this.count - this.activeCount;\r\n        }\r\n\r\n        if (this.firstIndex === nextIndex && !force) {\r\n            return;\r\n        }\r\n\r\n        if (!direction) {\r\n            direction = (nextIndex > this.firstIndex) ? 'right' : 'left';\r\n        }\r\n\r\n        const approved = triggerComponentEvent(this, 'sc:slide:change', {bubbles: true}); // Todo change info\r\n\r\n        if (this._strategy && approved && this.firstIndex !== nextIndex) {\r\n            this._strategy.onAnimate(nextIndex, direction);\r\n        }\r\n\r\n        if (this._strategy && approved) {\r\n            this.$slides.forEach((el, index) => {\r\n                el._setActive((nextIndex <= index) && (index < nextIndex + this.activeCount));\r\n            });\r\n        }\r\n\r\n        triggerComponentEvent(this, 'sc:slide:changed', {bubbles: true}); // Todo change info\r\n    }\r\n\r\n    public prev() {\r\n        const nextGroup = this.getNextGroup(-1);\r\n        this.goTo(nextGroup * this.activeCount, 'left');\r\n    }\r\n\r\n    public next() {\r\n        const nextGroup = this.getNextGroup(1);\r\n        this.goTo(nextGroup * this.activeCount, 'right');\r\n    }\r\n\r\n    protected connectedCallback() {\r\n        this.classList.add(SmartCarousel.is);\r\n       // this.$slides.forEach((slide: SmartCarouselSlide, index) => slide.index = index);\r\n\r\n        this.update(true);\r\n        this._bindEvents();\r\n    }\r\n\r\n    protected disconnectedCallback() {\r\n        this._unbindEvents();\r\n    }\r\n\r\n    private attributeChangedCallback(attrName: string, oldVal: string, newVal: string) {\r\n        switch (attrName) {\r\n            case 'config':\r\n            case 'strategy':\r\n                this.updateStrategy();\r\n                this.configRules = SmartRuleList.parse<object>(this.config, SmartRuleList.OBJECT_PARSER) as SmartRuleList<CarouselCurrentConfig>;\r\n                this.update(true);\r\n                break;\r\n        }\r\n    }\r\n\r\n    protected _bindEvents() {\r\n        this.addEventListener('click', this._onClick, false);\r\n    }\r\n\r\n    protected _unbindEvents() {\r\n        this.removeEventListener('click', this._onClick, false);\r\n    }\r\n\r\n    protected updateStrategy() {\r\n        this._strategy = STRATEGIES[this.strategy](this);\r\n    }\r\n\r\n    get configRules() {\r\n        if (!this._configRules) {\r\n            this.configRules = SmartRuleList.parse<CarouselCurrentConfig>(this.config, SmartRuleList.OBJECT_PARSER);\r\n        }\r\n        return this._configRules;\r\n    }\r\n\r\n    set configRules(rules: SmartRuleList<CarouselCurrentConfig>) {\r\n        if (this._configRules) {\r\n            this._configRules.removeListener(this._onMatchChange);\r\n        }\r\n        this._configRules = rules;\r\n        this._configRules.addListener(this._onMatchChange);\r\n    }\r\n\r\n    private update(force: boolean = false) {\r\n        const config: CarouselCurrentConfig = Object.assign(\r\n            {strategy: 'single', count: 1},\r\n            this.configRules.activeValue\r\n        );\r\n        if (deepCompare(this._currentConfig, config) || !force) {\r\n           return;\r\n        }\r\n        this._currentConfig = config;\r\n        const count = (this._currentConfig) ? this._currentConfig.count : config.count;\r\n        if (force || this.activeIndexes.length !== count || count !== config.count) {\r\n            const slideStyles = getComputedStyle(this.$slides[this.firstIndex]);\r\n            const currentTrans = parseFloat(slideStyles.transform.split(',')[4]);\r\n            const slidesAreaStyles = getComputedStyle(this.$slidesArea);\r\n            const slideWidth = parseFloat(slidesAreaStyles.width) / count - parseFloat(slideStyles.marginLeft) - parseFloat(slideStyles.marginRight);\r\n            const computedLeft = -(parseFloat(slidesAreaStyles.width) / count * this.firstIndex) - (currentTrans);\r\n            this.$slides.forEach((slide) => {\r\n                slide.style.minWidth =  slideWidth + 'px';\r\n                slide.style.left = computedLeft + 'px';\r\n            });\r\n            this.goTo(this.firstIndex, '', true);\r\n        }\r\n    }\r\n\r\n    private getNextGroup(shiftGroupsCount: number) {\r\n        // get number of group of current active slides by last index of this group\r\n        const lastIndex = this.activeIndexes.length - 1;\r\n        const currentGroup = Math.floor(this.activeIndexes[lastIndex] / this.activeCount);\r\n        // get count of groups of slides\r\n        const countGroups = Math.ceil(this.count / this.activeCount);\r\n        // get number of group of next active slides\r\n        return (currentGroup + shiftGroupsCount + countGroups) % countGroups;\r\n    }\r\n\r\n    /**\r\n     * @returns {number} first active index\r\n     */\r\n    get firstIndex(): number {\r\n        return this.$slides.findIndex((slide) => {\r\n            return slide.active;\r\n        });\r\n    }\r\n\r\n    protected _onClick(event: MouseEvent) {\r\n        const eventTarget = event.target as HTMLElement;\r\n        const markedTarget = eventTarget.closest('[data-slide-target]') as HTMLElement;\r\n        if (markedTarget && markedTarget.dataset.slideTarget) {\r\n            const target = markedTarget.dataset.slideTarget;\r\n            if ('prev' === target) {\r\n                this.prev();\r\n            } else if ('next' === target) {\r\n                this.next();\r\n            } else {\r\n                this.goTo(this.activeCount * +target);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\ncustomElements.define(SmartCarousel.is, SmartCarousel);\r\nexport default SmartCarousel;\r\n","import SmartCarousel from './smart-carousel';\r\n\r\nclass SmartCarouselDots extends HTMLElement {\r\n    static get is() {\r\n        return 'smart-carousel-dots';\r\n    }\r\n\r\n    private _onUpdate = () => this.rerender();\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    protected connectedCallback() {\r\n        this.classList.add(SmartCarouselDots.is);\r\n        this.rerender();\r\n        this._bindEvents();\r\n    }\r\n\r\n    protected disconnectedCallback() {\r\n        this._unbindEvents();\r\n    }\r\n\r\n    protected _bindEvents() {\r\n        this.$parent.addEventListener('sc:slide:changed', this._onUpdate);\r\n    }\r\n\r\n    protected _unbindEvents() {\r\n        this.$parent.removeEventListener('sc:slide:changed', this._onUpdate);\r\n    }\r\n\r\n\r\n    get $parent(): SmartCarousel {\r\n        return this.closest('.' + SmartCarousel.is) as SmartCarousel;\r\n    }\r\n\r\n    public rerender() {\r\n        let html = '';\r\n        const activeDot = Math.floor(this.$parent.activeIndexes[this.$parent.activeCount - 1] / this.$parent.activeCount);\r\n        for (let i = 0; i < Math.ceil(this.$parent.count / this.$parent.activeCount); ++i) {\r\n            html += this.buildDot(i, i === activeDot);\r\n        }\r\n        this.innerHTML = html;\r\n    }\r\n\r\n    public buildDot(index: number, isActive: boolean) {\r\n        return `<button role=\"button\" class=\"carousel-dot ${isActive ? 'active-dot' : ''}\" data-slide-target=\"${index}\"></button>`;\r\n    }\r\n}\r\n\r\ncustomElements.define(SmartCarouselDots.is, SmartCarouselDots);\r\nexport default SmartCarouselDots;\r\n","// HTMLElement ES6 extends shim\r\nimport '@helpers/es5-support/es6-htmlelement-shim';\r\n\r\n// Builtin polyfills\r\nimport '@helpers/builtin-polyfils/object-polyfils';\r\nimport '@helpers/builtin-polyfils/closest-polyfill';\r\n\r\nimport {\r\n  BreakpointRegistry,\r\n  SmartQuery,\r\n  SmartRuleList\r\n} from '@components/smart-query/smart-query';\r\nimport { SmartImage } from '@components/smart-image/smart-image';\r\nimport { SmartVideo } from '@components/smart-video/smart-video';\r\nimport { SmartPopup } from '@components/smart-popup/smart-popup';\r\nimport { SmartPopupTrigger } from '@components/smart-trigger/smart-popup-trigger';\r\nimport { SmartCarousel, SmartCarouselDots } from '@components/smart-carousel/smart-carousel';\r\n\r\n// TODO separate config\r\n// BreakpointRegistry.addCustomBreakpoint('xxs', 300, 600); // Definition\r\n// BreakpointRegistry.addCustomBreakpoint('xl', 1600, 2000); // Redefinition\r\n\r\n// Default definition\r\nSmartImage.register('smart-image');\r\n\r\nexport {\r\n  BreakpointRegistry,\r\n  SmartQuery,\r\n  SmartRuleList,\r\n  SmartImage,\r\n  SmartPopup,\r\n  SmartPopupTrigger,\r\n  SmartVideo,\r\n  SmartCarousel,\r\n  SmartCarouselDots\r\n};\r\n"],"sourceRoot":""}