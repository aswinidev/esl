{"version":3,"sources":["webpack://EWC/webpack/universalModuleDefinition","webpack://EWC/webpack/bootstrap","webpack://EWC/./src/components/smart-query/ts/smart-rule-list.ts","webpack://EWC/./src/helpers/component-utils.ts","webpack://EWC/./src/components/smart-query/ts/smart-query.ts","webpack://EWC/./src/components/smart-query/ts/smart-query-breakpoints.ts","webpack://EWC/./src/helpers/device-utils.ts","webpack://EWC/./src/helpers/abstract/observable.ts","webpack://EWC/./src/helpers/es5-support/es6-htmlelement-shim.ts","webpack://EWC/./src/helpers/builtin-polyfils/object-polyfils.ts","webpack://EWC/./src/helpers/builtin-polyfils/closest-polyfill.ts","webpack://EWC/./src/helpers/decorators/attr.ts","webpack://EWC/./src/components/smart-image/ts/smart-image.ts","webpack://EWC/./src/components/smart-video/ts/smart-video-manager.ts","webpack://EWC/./src/components/smart-video/ts/smart-video-iobserver.ts","webpack://EWC/./src/components/smart-video/ts/smart-video-provider.ts","webpack://EWC/./src/components/smart-video/ts/smart-video-registry.ts","webpack://EWC/./src/components/smart-video/ts/smart-video.ts","webpack://EWC/./src/helpers/function-utils.ts","webpack://EWC/./src/components/smart-video/ts/video-providers/youtube-provider.ts","webpack://EWC/./src/helpers/common-utils.ts","webpack://EWC/./src/components/smart-video/ts/video-providers/video-provider.ts","webpack://EWC/./src/components/smart-carousel/ts/strategy/smart-carousel-strategy.ts","webpack://EWC/./src/components/smart-carousel/ts/strategy/smart-single-carousel-strategy.ts","webpack://EWC/./src/components/smart-carousel/ts/strategy/smart-multi-carousel-strategy.ts","webpack://EWC/./src/components/smart-carousel/ts/smart-carousel-slide.ts","webpack://EWC/./src/components/smart-carousel/ts/smart-carousel.ts","webpack://EWC/./src/components/smart-carousel/ts/smart-carousel-dots.ts","webpack://EWC/./src/bundles/all.ts"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","SmartRule","_super","payload","query","_this","this","_default","_payload","__extends","toString","media","parse","lex","parser","_a","split","trim","all","empty","_smart_query__WEBPACK_IMPORTED_MODULE_0__","SmartRuleList","_onMatchChanged","rule","_activeRule","_active","fire","Error","_rules","parseRules","forEach","addListener","filter","default","str","parts","rules","_lex","indexOf","unshift","push","satisfied","matches","length","active","assign","STRING_PARSER","val","OBJECT_PARSER","eval","e","_helpers_abstract_observable__WEBPACK_IMPORTED_MODULE_1__","__webpack_exports__","triggerComponentEvent","target","eventName","args","eventHandlerName","eventHandlerAttr","getAttribute","apply","console","log","tagName","dispatchEvent","CustomEvent","_helpers_device_utils__WEBPACK_IMPORTED_MODULE_0__","_smart_query_breakpoints__WEBPACK_IMPORTED_MODULE_1__","QUERY_CACHE","SmartQuery","_dpr","replace","match","ratio","Math","floor","navigator","userAgent","round","getDprMediaQuery","pre","type","post","_mobileOnly","toUpperCase","_query","matcher","matchMedia","getQuery","listener","addEventListener","removeListener","removeEventListener","BreakpointRegistry","ScreenBreakpoint","min","max","registry","xs","sm","md","lg","xl","BP_NAME_REGEXP","addCustomBreakpoint","minWidth","maxWidth","toLowerCase","test","current","getBreakpoint","getAllBreakpointsNames","keys","breakpoints","breakpointRegex","RegExp","join","sign","bp","shortcut","mediaQueryGE","mediaQueryLE","mediaQuery","isMobile","Observable","_listeners","index","splice","_i","arguments","es5HTMLElemeentInheritanceShim","is","x","y","configurable","writable","Element","msMatchesSelector","mozMatchesSelector","webkitMatchesSelector","closest","css","node","parentElement","toKebabCase","intersectionObserver","attr","config","defaultValue","readonly","propName","attrName","dataAttr","conditional","readOnly","hasAttribute","set","setAttribute","removeAttribute","buildConditionalMapping","buildSimpleMapping","STRATEGIES","cover","useInnerImg","save-ratio","afterLoad","shadowImg","style","paddingTop","height","width","fit","origin","_innerImage","dpr","getIObserver","IntersectionObserver","entries","entry","isIntersecting","intersectionRatio","smart_image_SmartImage","triggerLoad","threshold","rootMargin","device_utils","SmartImage","_onLoad","_onError","_onMatchChange","update","register","className","customElements","lazyManual","_srcRules","srcRules","smart_rule_list","src","_currentSrc","isEmptyImage","changeMode","oldVal","newVal","_innerImg","removeChild","force","lazy","lazyTriggered","getPath","DPR","_shadowImg","refreshOnUpdate","ready","syncImage","_detachLazyTrigger","srcBase","EMPTY_IMAGE","refresh","background","isEmpty","backgroundImage","connectedCallback","constructor","classList","add","alt","lazyAuto","observe","unobserve","disconnectedCallback","attributeChangedCallback","querySelector","document","createElement","appendChild","_shadowImageElement","Image","onload","onerror","component_utils","_onReady","error","containerCls","targetEl","parentNode","__decorate","HTMLElement","smart_image","iObserver","PlayerStates","managerMap","smart_video_manager","VideoGroupRestrictionManager","registerPlay","instance","group","Event","bubbles","pause","unregister","RATIO_TO_ACTIVATE","RATIO_TO_DEACTIVATE","smart_video_iobserver_getIObserver","handleViewport","entire","smart_video","video","onplaying","muted","play","BaseProvider","component","_ready","res","Promise","reject","catch","toggle","getState","PAUSED","safeSeekTo","pos","then","seekTo","safePlay","safePause","safeStop","stop","safeToggle","smart_video_registry","EmbeddedVideoProviderRegistry","providers","smart_video_registry_extends","_instance","provider","getProvider","observable","smart_video_SmartVideo","SmartVideo","deferedReinit","fn","wait","immediate","timeout","context","later","callNow","clearTimeout","setTimeout","debounce","reinitInstance","_onRegistryStateChange","videoType","_onConditionStateChange","smart_video_extends","innerHTML","conditionQuery","disabled","detachViewportConstraint","_provider","unbind","playInViewport","attachViewportConstraint","buildOptions","title","autoplay","hideControls","dataId","dataset","id","dataSrc","_updateMarkers","addValue","removeValue","remove","state","reset","focus","_onDetach","_onPlay","autofocus","_onPaused","_onEnded","UNINITIALIZED","_conditionQuery","smart_query","observer","smart_video_decorate","youtube_provider_YouTubeProvider","YouTubeProvider","_onStateChange","event","data","PLAYING","ENDED","youtube_provider_extends","getCoreApi","_coreApiPromise","resolve","YT","Player","getElementById","tag","async","firstScriptTag","getElementsByTagName","insertBefore","loadScript","cbOrigin","onYouTubeIframeAPIReady","err","buildIframeUrl","Number","buildIframe","el","Date","now","random","iframeLoad","_el","_api","events","onError","onReady","onStateChange","destroy","contentWindow","getPlayerState","playVideo","pauseVideo","stopVideo","videoName","video_provider_VideoProvider","VideoProvider","video_provider_extends","buildSrc","build","preload","loop","tabIndex","controls","currentTime","smart_carousel_strategy","carousel","smart_single_carousel_strategy","SmartSingleCarouselStrategy","smart_single_carousel_strategy_extends","onAnimate","nextIndex","direction","firstIndex","activeSlide","$slides","nextSlide","_cleanAnimation","cleanStyles","smart_multi_carousel_strategy","SmartMultiCarouselStrategy","smart_multi_carousel_strategy_extends","slideStyles","getComputedStyle","slideWidth","parseFloat","marginLeft","marginRight","areaWidth","transitionDuration","currentLeft","left","trans","left_1","activeCount","transform","this_1","time","activeIndexes","nextTrans","SmartCarouselSlide","smart_carousel_slide_extends","Array","childNodes","_setActive","toggleAttribute","smart_carousel_slide","smart_carousel_STRATEGIES","single","multi","smart_carousel_SmartCarousel","SmartCarousel","_currentConfig","smart_carousel_extends","els","$slidesArea","querySelectorAll","from","reduce","count","goTo","isAnimated","approved","_strategy","prev","nextGroup","getNextGroup","next","_bindEvents","_unbindEvents","updateStrategy","configRules","_onClick","strategy","_configRules","activeValue","deepCompare","obj1","obj2","keys1","keys2","some","currentTrans","slidesAreaStyles","slideWidth_1","computedLeft_1","slide","shiftGroupsCount","lastIndex","currentGroup","countGroups","ceil","findIndex","markedTarget","slideTarget","smart_carousel_decorate","smart_carousel","smart_carousel_dots_SmartCarouselDots","SmartCarouselDots","_onUpdate","rerender","smart_carousel_dots_extends","$parent","html","activeDot","buildDot","isActive","smart_carousel_dots","smart_query_breakpoints"],"mappings":"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","file":"all.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"EWC\"] = factory();\n\telse\n\t\troot[\"EWC\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n","/**\r\n * Smart Rule List\r\n * @version 1.0.0\r\n * @author Yuliya Adamskaya\r\n *\r\n * Helper class that extend provide Observable Rule Handler that resolve payload based on current device configuration.\r\n * Supports\r\n * - CSS query matching check\r\n * - DPR display queries (@x1 | @x2 | @x3)\r\n * - Screen default sizes shortcuts @[-|+](XS|SM|MD|LG|XL)\r\n * - Query matching change listeners\r\n * - Mobile / full browser detection (@MOBILE|@DESKTOP)\r\n */\r\n\r\nimport SmartQuery from './smart-query';\r\nimport {Observable} from '../../../helpers/abstract/observable';\r\n\r\ntype PayloadParser<T> = (val: string) => T;\r\n\r\nclass SmartRule<T> extends SmartQuery {\r\n\tprivate readonly _payload: T;\r\n\tprivate readonly _default: boolean;\r\n\r\n\tconstructor(payload: T, query: string) {\r\n\t\tsuper(query);\r\n\t\tthis._default = !query;\r\n\t\tthis._payload = payload;\r\n\t}\r\n\r\n\tpublic toString() {\r\n\t\treturn `${this.query.media} => ${this._payload}`;\r\n\t}\r\n\r\n\tget payload(): T {\r\n\t\treturn this._payload;\r\n\t}\r\n\tget default(): boolean {\r\n\t\treturn this._default;\r\n\t}\r\n\r\n\tpublic static parse<T>(lex: string, parser: PayloadParser<T>) {\r\n\t\tconst [query, payload] = lex.split('=>');\r\n\t\treturn new SmartRule<T>(parser(payload.trim()), query.trim());\r\n\t}\r\n\r\n\tpublic static all<T>(payload: T) {\r\n\t\treturn new SmartRule<T>(payload, 'all');\r\n\t}\r\n\tpublic static empty() {\r\n\t\treturn SmartRule.all(null);\r\n\t}\r\n}\r\n\r\nexport default class SmartRuleList<T extends string | object> extends Observable {\r\n\tprivate _active: SmartRule<T>;\r\n\tprivate _default: SmartRule<T>;\r\n\tprivate readonly _rules: Array<SmartRule<T>>;\r\n\r\n\tpublic static STRING_PARSER = (val: string) => val;\r\n\tpublic static OBJECT_PARSER = <T extends object> (val: string): T => {\r\n\t\ttry {\r\n\t\t\treturn eval('(' + val + ')') as T;\r\n\t\t} catch (e) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t};\r\n\r\n\tprivate static parseRules<T>(str: string, parser: PayloadParser<T>): Array<SmartRule<T>> {\r\n\t\tconst parts = str.split('|');\r\n\t\tconst rules: Array<SmartRule<T>> = [];\r\n\t\tparts.forEach((_lex: string) => {\r\n\t\t\tconst lex = _lex.trim();\r\n\t\t\tif (!lex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (lex.indexOf('=>') === -1) {\r\n\t\t\t\t// Default rule should have lower priority\r\n\t\t\t\trules.unshift(SmartRule.all(parser(lex)));\r\n\t\t\t} else {\r\n\t\t\t\tconst rule = SmartRule.parse(lex, parser);\r\n\t\t\t\trule && rules.push(rule);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn rules;\r\n\t}\r\n\r\n\tpublic static parse<T extends string | object>(query: string, parser: PayloadParser<T>) {\r\n\t\treturn new SmartRuleList<T>(query, parser);\r\n\t}\r\n\r\n\tprivate constructor(query: string, parser: PayloadParser<T>) {\r\n\t\tsuper();\r\n\t\tif (typeof query !== 'string') {\r\n\t\t\tthrow new Error('SmartRuleList require first parameter (query) typeof string');\r\n\t\t}\r\n\t\tthis._rules = SmartRuleList.parseRules(query, parser);\r\n\t\tthis._rules.forEach((rule) => rule.addListener(this._onMatchChanged));\r\n\t\tthis._default = this._rules.filter((rule) => rule.default)[0];\r\n\t}\r\n\r\n\tget rules() {\r\n\t\treturn this._rules;\r\n\t}\r\n\r\n\tget _activeRule() {\r\n\t\tconst satisfied = this.rules.filter((rule) => rule.matches);\r\n\t\treturn satisfied.length > 0 ? satisfied[satisfied.length - 1] : SmartRule.empty();\r\n\t}\r\n\r\n\tget active() {\r\n\t\tif (!this._active) {\r\n\t\t\tthis._active = this._activeRule;\r\n\t\t}\r\n\t\treturn this._active;\r\n\t}\r\n\r\n\tget activeValue(): T {\r\n\t\tconst value = this.active.payload;\r\n\t\tif (typeof value === 'string' || !this._default) {\r\n\t\t\treturn value;\r\n\t\t}\r\n\t\treturn Object.assign({}, this._default.payload || {}, value);\r\n\t}\r\n\r\n\tprivate _onMatchChanged = () => {\r\n\t\tconst rule = this._activeRule;\r\n\t\tif (this._active !== rule) {\r\n\t\t\tthis._active = rule;\r\n\t\t\tthis.fire(rule);\r\n\t\t}\r\n\t};\r\n}\r\n","/**\r\n * Common method that initiate event handler defined by on{eventName} attribute and then trigger simple custom event on the element\r\n * @param target - target HTMLElement\r\n * @param eventName - name of event\r\n * @param args - arguments for custom event\r\n */\r\nexport function triggerComponentEvent(target: HTMLElement, eventName: string, args?: any): boolean {\r\n    const eventHandlerName = 'on' + eventName;\r\n    const eventHandlerAttr = target.getAttribute(eventHandlerName);\r\n    if (eventHandlerAttr) {\r\n        try {\r\n            if (typeof (target as any)[eventHandlerName] !== 'function') {\r\n                (target as any)[eventHandlerName] = function () { eval(eventHandlerAttr); };\r\n            }\r\n            (target as any)[eventHandlerName].apply(target, args);\r\n        } catch (e) {\r\n            console.log(`Error executing ${target.tagName} ${eventName} hook function.\\n ${e}`);\r\n        }\r\n    }\r\n    return target.dispatchEvent(new CustomEvent(eventName, args)); // TODO: check args usage\r\n}\r\n","/**\r\n * Smart Query\r\n * @version 1.2.0\r\n * @author Alexey Stsefanovich (ala'n)\r\n *\r\n * Helper class that extend MediaQueryList class\r\n * Supports\r\n * - CSS query matching check\r\n * - DPR display queries (@x1 | @x2 | @x3)\r\n * - Screen default sizes shortcuts @[-|+](XS|SM|MD|LG|XL)\r\n * - Query matching change listeners\r\n * - Mobile / full browser detection (@MOBILE|@DESKTOP)\r\n */\r\n\r\nimport {isMobile} from '../../../helpers/device-utils';\r\nimport {BreakpointRegistry} from './smart-query-breakpoints';\r\n\r\nconst QUERY_CACHE: any = {};\r\n\r\nfunction getQuery(query: string): MediaQueryList {\r\n\tif (query) {\r\n\t\tconst matcher = QUERY_CACHE[query] ? QUERY_CACHE[query] : window.matchMedia(query);\r\n\t\tif (matcher) {\r\n\t\t\tQUERY_CACHE[query] = matcher;\r\n\t\t}\r\n\t\treturn matcher;\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction getDprMediaQuery(ratio: number) {\r\n\tconst isWebkit = navigator.userAgent.indexOf('AppleWebKit') !== -1;\r\n\treturn isWebkit ? `(-webkit-min-device-pixel-ratio: ${ratio})` : `(min-resolution: ${Math.round(96 * ratio)}dpi)`;\r\n}\r\n\r\nexport class SmartQuery {\r\n\tstatic get BreakpointRegistry() {\r\n\t\treturn BreakpointRegistry;\r\n\t}\r\n\r\n\tprivate _dpr: number;\r\n\tprivate _mobileOnly: boolean;\r\n\tprivate readonly _query: MediaQueryList;\r\n\r\n\tconstructor(query: string) {\r\n\r\n\t\t// Applying known breakpoints shortcut\r\n\t\tquery = BreakpointRegistry.apply(query);\r\n\r\n\t\t// Applying dpr shortcut\r\n\t\tthis._dpr = 1;\r\n\t\tquery = query.replace(/@(1|2|3)x/, (match, ratio) => {\r\n\t\t\tthis._dpr = Math.floor(ratio);\r\n\t\t\treturn getDprMediaQuery(ratio);\r\n\t\t});\r\n\r\n\t\t// Applying dpr shortcut for device detection\r\n\t\tquery = query.replace(/(and ){0,1}(@MOBILE|@DESKTOP)( and){0,1}/i, (match, pre, type, post) => {\r\n\t\t\tthis._mobileOnly = (type.toUpperCase() === '@MOBILE');\r\n\t\t\tif (isMobile !== this._mobileOnly) {\r\n\t\t\t\treturn 'not all';\r\n\t\t\t}\r\n\t\t\treturn pre && post ? ' and ' : '';\r\n\t\t});\r\n\r\n\t\tthis._query = getQuery(query.trim() || 'all');\r\n\t}\r\n\r\n\tget isMobileOnly() {\r\n\t\treturn this._mobileOnly === true;\r\n\t}\r\n\r\n\tget isFullOnly() {\r\n\t\treturn this._mobileOnly === false;\r\n\t}\r\n\r\n\tget DPR() {\r\n\t\treturn this._dpr;\r\n\t}\r\n\r\n\tget query() {\r\n\t\treturn this._query;\r\n\t}\r\n\r\n\tget matches() {\r\n\t\treturn this.query && this.query.matches;\r\n\t}\r\n\r\n\tpublic addListener(listener: () => void) {\r\n\t\tif (!this.query) return;\r\n\t\tif (typeof this.query.addEventListener === 'function') {\r\n\t\t\tthis.query.addEventListener('change', listener);\r\n\t\t} else {\r\n\t\t\tthis.query.addListener(listener);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic removeListener(listener: () => void)  {\r\n\t\tif (!this.query) return;\r\n\t\tif (typeof this.query.removeEventListener === 'function') {\r\n\t\t\tthis.query.removeEventListener('change', listener);\r\n\t\t} else {\r\n\t\t\tthis.query.removeListener(listener);\r\n\t\t}\r\n\t}\r\n}\r\nexport default SmartQuery;\r\n","/**\r\n * Smart Query Breakpoint Registry\r\n * @version 1.0.0\r\n * @author Yuliya Adamskaya\r\n *\r\n * Breakpoint Registry is used to provide custom breakpoints for Smart Query\r\n */\r\n\r\nclass ScreenBreakpoint {\r\n\tpublic min: number;\r\n\tpublic max: number;\r\n\r\n\tconstructor(min: number, max: number) {\r\n\t\tthis.min = min;\r\n\t\tthis.max = max;\r\n\t}\r\n\r\n\tget mediaQuery(): string {\r\n\t\treturn `(min-width: ${this.min}px) and (max-width: ${this.max}px)`;\r\n\t}\r\n\r\n\tget mediaQueryGE(): string {\r\n\t\treturn `(min-width: ${this.min}px)`;\r\n\t}\r\n\r\n\tget mediaQueryLE(): string {\r\n\t\treturn `(max-width: ${this.max}px)`;\r\n\t}\r\n}\r\n\r\ninterface BreakpointsMapping {\r\n\t[key: string]: ScreenBreakpoint\r\n}\r\n\r\n// Default breakpoints provided in registry\r\nconst registry: BreakpointsMapping = {\r\n\txs: new ScreenBreakpoint(1, 767),\r\n\tsm: new ScreenBreakpoint(768, 991),\r\n\tmd: new ScreenBreakpoint(992, 1199),\r\n\tlg: new ScreenBreakpoint(1200, 1599),\r\n\txl: new ScreenBreakpoint(1600, 999999)\r\n};\r\n\r\nconst BP_NAME_REGEXP = /^[a-z]{1,}/i;\r\n\r\nexport abstract class BreakpointRegistry {\r\n\t/**\r\n\t * Add or replace breakpoint shortcut that could be used inside of SmartQuery\r\n\t * @param name - name of shortcut\r\n\t * @param minWidth - min width for breakpoint\r\n\t * @param maxWidth - max width for breakpoint\r\n\t */\r\n\tpublic static addCustomBreakpoint(name: string, minWidth: number, maxWidth: number): ScreenBreakpoint {\r\n\t\tname = name.toLowerCase();\r\n\t\tif (BP_NAME_REGEXP.test(name)) {\r\n\t\t\tconst current = registry[name];\r\n\t\t\tregistry[name] = new ScreenBreakpoint(minWidth, maxWidth);\r\n\t\t\treturn current;\r\n\t\t}\r\n\t\tthrow new Error('Shortcut should consist only from Latin characters. Length should be at least one character.');\r\n\t}\r\n\r\n\t/**\r\n\t * @return known breakpoint shortcut instance\r\n\t */\r\n\tpublic static getBreakpoint(name: string): ScreenBreakpoint {\r\n\t\treturn registry[(name || '').toLowerCase()];\r\n\t}\r\n\r\n\t/**\r\n\t * @returns all available breakpoints shortcuts\r\n\t */\r\n\tpublic static getAllBreakpointsNames() {\r\n\t\treturn Object.keys(registry);\r\n\t}\r\n\r\n\t/**\r\n\t * Replaces known breakpoints shortcuts to the real media queries\r\n\t * @param query - original query string\r\n\t */\r\n\tpublic static apply(query: string) {\r\n\t\tconst breakpoints = Object.keys(registry);\r\n\t\tconst breakpointRegex = new RegExp(`@([+-]{0,1})(${breakpoints.join('|')})`, 'ig');\r\n\r\n\t\treturn query.replace(breakpointRegex, (match, sign, bp) => {\r\n\t\t\tconst shortcut = BreakpointRegistry.getBreakpoint(bp);\r\n\t\t\tswitch (sign) {\r\n\t\t\t\tcase '+':\r\n\t\t\t\t\treturn shortcut.mediaQueryGE;\r\n\t\t\t\tcase '-':\r\n\t\t\t\t\treturn shortcut.mediaQueryLE;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn shortcut.mediaQuery;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport default BreakpointRegistry;\r\n","export const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\r\n","export class Observable {\r\n\tprivate _listeners: Array<() => void> = [];\r\n\r\n\tpublic addListener(listener: (...args: any) => void) {\r\n\t\tconst index = this._listeners.indexOf(listener);\r\n\t\tif (index === -1) {\r\n\t\t\tthis._listeners.push(listener);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic removeListener(listener: (...args: any) => void) {\r\n\t\tconst index = this._listeners.indexOf(listener);\r\n\t\tif (index !== -1) {\r\n\t\t\tthis._listeners.splice(index);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected fire(...args: any) {\r\n\t\tthis._listeners.forEach((listener) => {\r\n\t\t\ttry {\r\n\t\t\t\tlistener.apply(this, args);\r\n\t\t\t} catch (e) {\r\n\t\t\t\t// Don't care\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n","/**\r\n * Shim based on https://github.com/webcomponents/custom-elements/blob/master/src/native-shim.js\r\n *\r\n * This shim allows elements written in, or compiled to, ES5 to work on native\r\n * implementations of Custom Elements.\r\n *\r\n * There are some restrictions and requirements on ES5 constructors:\r\n *   1. All constructors in a inheritance hierarchy must be ES5-style, so that\r\n *      they can be called with Function.call(). This effectively means that the\r\n *      whole application must be compiled to ES5.\r\n *   2. Constructors must return the value of the emulated super() call. Like\r\n *      `return SuperClass.call(this)`\r\n *   3. The `this` reference should not be used before the emulated super() call\r\n *      just like `this` is illegal to use before super() in ES6.\r\n *   4. Constructors should not create other custom elements before the emulated\r\n *      super() call. This is the same restriction as with native custom\r\n *      elements.\r\n *   5. Code inside of eval mustn't be compiled to ES5 syntax\r\n *\r\n *  Compiling valid class-based custom elements to ES5 will satisfy these\r\n *  requirements with the latest version of popular transpilers.\r\n */\r\n// @ts-ignore\r\nif ('customElements' in window && !window.es5HTMLElemeentInheritanceShim) {\r\n  try {\r\n    eval('(()=>{\\'use strict\\';const a=window.HTMLElement,b=window.customElements.define,' +\r\n      'c=window.customElements.get,d=new Map,e=new Map;let f=!1,g=!1;window.HTMLElement=function(){if(!f){' +\r\n      'const j=d.get(this.constructor),k=c.call(window.customElements,j);g=!0;const l=new k;return l}f=!1},' +\r\n      'window.HTMLElement.prototype=a.prototype;Object.defineProperty(window,\\'customElements\\',' +\r\n      '{value:window.customElements,configurable:!0,writable:!0}),Object.defineProperty(window.customElements,' +\r\n      '\\'define\\',{value:(j,k)=>{const l=k.prototype,m=class extends a{constructor(){super(),Object.setPrototypeOf(this,l),' +\r\n      'g||(f=!0,k.call(this)),g=!1}},n=m.prototype;m.observedAttributes=k.observedAttributes,' +\r\n      'n.connectedCallback=l.connectedCallback,n.disconnectedCallback=l.disconnectedCallback,' +\r\n      'n.attributeChangedCallback=l.attributeChangedCallback,n.adoptedCallback=l.adoptedCallback,d.set(k,j),' +\r\n      'e.set(j,k),b.call(window.customElements,j,m)},configurable:!0,writable:!0}),Object.defineProperty(' +\r\n      'window.customElements,\\'get\\',{value:j=>e.get(j),configurable:!0,writable:!0})})();');\r\n    // @ts-ignore-file\r\n    window.es5HTMLElemeentInheritanceShim = true;\r\n  } catch (e) {\r\n    //\r\n  }\r\n}\r\n","// Blatantly stolen from ES6 specs. Kept here for reference.\r\n// http://wiki.ecmascript.org/doku.php?id=harmony:egal\r\n\r\nif (!Object.is) {\r\n\tObject.defineProperty(Object, 'is', {\r\n\t\tvalue(x: any, y: any) {\r\n\t\t\treturn (x === y) ? (x !== 0 || 1 / x === 1 / y) : (x !== x && y !== y);\r\n\t\t},\r\n\t\tconfigurable: true,\r\n\t\tenumerable: false,\r\n\t\twritable: true\r\n\t});\r\n}\r\n","/**\r\n * Element.closest polyfill\r\n */\r\n\r\n/**\r\n * Cross-browser Element interface\r\n */\r\ninterface ElementEx extends Element {\r\n\tmsMatchesSelector?(selectors: string): boolean;\r\n\tmozMatchesSelector?(selectors: string): boolean;\r\n}\r\n\r\n(function (e: ElementEx) {\r\n\te.matches = e.matches || e.msMatchesSelector || e.mozMatchesSelector || e.webkitMatchesSelector;\r\n\te.closest = e.closest || function (css: string) {\r\n\t\tlet node = this;\r\n\t\twhile (node) {\r\n\t\t\tif (node.matches(css)) return node;\r\n\t\t\tnode = node.parentElement;\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n})(Element.prototype as ElementEx);\r\n","interface AttrDescriptor {\r\n\tconditional?: boolean;\r\n\treadonly?: boolean;\r\n\tdataAttr?: boolean;\r\n\tdefaultValue?: string;\r\n}\r\n\r\nexport const toKebabCase = (str: string) => {\r\n\treturn str.replace(/([a-z])([A-Z])/g, '$1-$2').replace(/[\\s_]+/g, '-').toLowerCase();\r\n};\r\n\r\nfunction buildSimpleMapping(target: object, propName: string, attrName: string, defaultValue: string) {\r\n\r\n\tfunction get() {\r\n\t\treturn this.getAttribute(attrName) || defaultValue;\r\n\t}\r\n\tfunction set(value: string) {\r\n\t\tthis.setAttribute(attrName, value);\r\n\t}\r\n\r\n\tObject.defineProperty(target, propName, {get, set});\r\n}\r\n\r\nfunction buildConditionalMapping(target: object, propName: string, attrName: string, readOnly: boolean) {\r\n\r\n\tfunction get() {\r\n\t\treturn this.hasAttribute(attrName);\r\n\t}\r\n\tfunction set(value: string) {\r\n\t\tvalue ? this.setAttribute(attrName, 'true') : this.removeAttribute(attrName);\r\n\t}\r\n\r\n\treadOnly ? Object.defineProperty(target, propName, {get}) : Object.defineProperty(target, propName, {get, set});\r\n}\r\n\r\nexport const attr = (config: AttrDescriptor = {defaultValue: '', readonly: false}) => {\r\n\treturn (target: object, propName: string) => {\r\n\t\tconst attrName = config.dataAttr ? `data-${toKebabCase(propName)}` : toKebabCase(propName);\r\n\t\tconfig.conditional ? buildConditionalMapping(target, propName, attrName, config.readonly) : buildSimpleMapping(target, propName, attrName, config.defaultValue);\r\n\t};\r\n};\r\n","/**\r\n * Smart Image\r\n * @version 1.1.0\r\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya\r\n *\r\n * @description:\r\n * SmartImage - custom element, that provide flexible abilities to include images on web pages.\r\n * Originally developed as alternative for picture component, but with more features inside.\r\n * Supported features:\r\n * - different render modes: with or without inner img tag; object-fit options emulation like cover, inscribe, etc.\r\n * - manual loading (start loading image by manually provided marker)\r\n * - lazy loading (image start loading only if it is visible and in or closer to browser viewport area\r\n * - SmartQuery (special syntax that allows define different sources for different media queries, also supports shortcuts for media-queries)\r\n * - flexible class markers. Smart Image can add specific class on any parent element when image is ready,\r\n * the Smart Image itself also has markers that indicate it state\r\n * - provides events on state change (also support inline syntax like <smart-image-tag onload=\"\">)\r\n * - hot changes\r\n *\r\n * @attr:\r\n *  {String} data-src - src paths per queries (watched value)\r\n *    NOTE: query support shortcuts for\r\n *     - Breakpoints like @MD, @SM (defined), @+SM (SM and larger), @-LG(LG and smaller)\r\n *     - Device point resolutions: @1x, @2x, @3x\r\n *    all conditions must be separated by conjunction ('and')\r\n *    @example: '@+MD and @2x'\r\n *  {String} [data-src-base] - base src path for pathes described in data-src\r\n *\r\n *  {String} alt | data-alt - alt text (watched value)\r\n *\r\n *  {'origin' | 'cover' | 'save-ratio' | 'fit'} mode - rendering mode (default 'save-ratio') (watched value)\r\n *    WHEN mode is 'origin' - save origin image size\r\n *                            (use inner img tag for rendering)\r\n *    WHEN mode is 'fit' - use inner img but not force it width\r\n *    WHEN mode is 'cover' - didn't have self size use 100% w/h of container\r\n *                           (use background-image for rendering)\r\n *    WHEN mode is 'save-ratio' - fill 100% of container width and set self height according to image ratio\r\n *                                (use background-image for rendering)\r\n *\r\n *  {Boolean} [lazy] - enable lazy loading triggered by IntersectionObserver by default\r\n *                    (image start loading as soon as it becomes visible in visual area)\r\n *  {Boolean} [lazy-manual] - just says not to load image until lazy-triggered attribute appears\r\n *\r\n *  {Boolean} [refresh-on-update] - Always update original image as soon as image source changed\r\n *\r\n *  {String}  [container-class] - class that will be added to container when image will be ready\r\n *  {String}  [container-class-onload] - marks that container-class shouldn't be added if image load ends with exception\r\n *  {String}  [container-class-target] - target parent selector to add container-class (parentNode by default).\r\n *\r\n *  Events html connection points (see @events section)\r\n *  {Function | Evaluated Expression} onready\r\n *  {Function | Evaluated Expression} onload\r\n *  {Function | Evaluated Expression} onerror\r\n *\r\n *  @readonly {Boolean} ready - appears once when image first time loaded\r\n *  @readonly {Boolean} loaded - appears once when image first time loaded\r\n *  @readonly {Boolean} error - appears when current src isn't load\r\n *\r\n *  NOTE: Smart Image supports title attribute as any html element, no additional reflection for that attribute needed\r\n *  it will work correctly according to HTML5.* REC\r\n *\r\n * @param:\r\n *  {String} src - srcset (see data-src attribute for details)\r\n *  {String} srcBase - base path (see data-src-base attribute for details)\r\n *  {String} alt - alt text\r\n *  {'origin' | 'cover' | 'save-ratio' | 'fit'} mode - mode of image renderer\r\n *  {Array} srcRules - array of srcRules parsed from src\r\n *  {Boolean} refreshOnUpdate - see proactive-update attribute\r\n *\r\n *  @readonly {Function} triggerLoad - shortcut function for manually adding lazy-triggered marker\r\n *\r\n *  @readonly {SmartImageSrcRule} targetRule - satisfied rule that need to be applied in current state\r\n *  @readonly {Boolean} ready\r\n *  @readonly {Boolean} loaded\r\n *  @readonly {Boolean} error\r\n *\r\n * @event:\r\n *  ready - emits when image ready (loaded or load fail)\r\n *  load - emits every time when image loaded (including on path change)\r\n *  error - emits every time when current source loading fails.\r\n *\r\n * @example:\r\n *  <smart-image-tag mode=\"save-ratio\"\r\n *      data-src='..defaultPath [| mediaQuery => src [| ...]]'\r\n *  ></smart-image-tag>\r\n *  // also instead of mediaQuery you could use breakpoint shortcut like:\r\n *  <smart-image-tag mode=\"save-ratio\"\r\n *      data-src='..defaultPath [| @+MD => src [| ...]]'\r\n *  ></smart-image-tag>\r\n *  or\r\n *  <smart-image-tag mode=\"save-ratio\"\r\n *      data-src='..defaultPath [| @1x => src [| ...]]'\r\n *  ></smart-image-tag>\r\n */\r\nimport {isMobile} from '../../../helpers/device-utils';\r\nimport {triggerComponentEvent} from '../../../helpers/component-utils';\r\nimport SmartRuleList from '../../smart-query/ts/smart-rule-list';\r\nimport {attr} from '../../../helpers/decorators/attr';\r\n\r\n// Mods configurations\r\ninterface Strategy {\r\n\t[mode: string]: { useInnerImg: boolean, afterLoad?: (shadowImg: ShadowImageElement, empty: boolean) => void }\r\n}\r\n\r\ninterface ShadowImageElement extends HTMLImageElement {\r\n\tdpr?: number\r\n}\r\n\r\nconst STRATEGIES: Strategy = {\r\n\t'cover': {\r\n\t\tuseInnerImg: false,\r\n\t},\r\n\t'save-ratio': {\r\n\t\tuseInnerImg: false,\r\n\t\tafterLoad(shadowImg, empty) {\r\n\t\t\tthis.style.paddingTop = empty ? null : `${(shadowImg.height * 100 / shadowImg.width)}%`;\r\n\t\t}\r\n\t},\r\n\t'fit': {\r\n\t\tuseInnerImg: true\r\n\t},\r\n\t'origin': {\r\n\t\tuseInnerImg: true,\r\n\t\tafterLoad(shadowImg) {\r\n\t\t\tthis._innerImage.width = shadowImg.width / shadowImg.dpr;\r\n\t\t}\r\n\t}\r\n};\r\n\r\n// Intersection Observer for lazy init functionality\r\nlet intersectionObserver: IntersectionObserver;\r\n\r\nfunction getIObserver() {\r\n\tif (!intersectionObserver) {\r\n\t\tintersectionObserver = new IntersectionObserver(function intersectionCallback(entries) {\r\n\t\t\t(entries || []).forEach(function (entry) {\r\n\t\t\t\tif ((entry.isIntersecting || entry.intersectionRatio > 0) && entry.target instanceof SmartImage) {\r\n\t\t\t\t\tentry.target.triggerLoad();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}, {\r\n\t\t\tthreshold: [0.01],\r\n\t\t\trootMargin: isMobile ? '250px' : '500px'// rootMargin value for IntersectionObserver\r\n\t\t});\r\n\t}\r\n\treturn intersectionObserver;\r\n}\r\n\r\nexport class SmartImage extends HTMLElement {\r\n\t@attr({dataAttr: true, defaultValue: ''}) private src: string;\r\n\t@attr({dataAttr: true, defaultValue: ''}) private srcBase: string;\r\n\t@attr({defaultValue: ''}) private alt: string;\r\n\t@attr({defaultValue: 'save-ratio'}) private mode: string;\r\n\t@attr({conditional: true}) private refreshOnUpdate: boolean;\r\n\t@attr({conditional: true, readonly: true}) private lazyManual: boolean;\r\n\t@attr({conditional: true, readonly: true}) private lazyTriggered: boolean;\r\n\t@attr({conditional: true, readonly: true}) private ready: boolean;\r\n\t@attr({conditional: true, readonly: true}) private loaded: boolean;\r\n\t@attr({conditional: true, readonly: true}) private error: boolean;\r\n\r\n\tprivate _innerImg: HTMLImageElement;\r\n\tprivate _srcRules: SmartRuleList<string>;\r\n\tprivate _currentSrc: string;\r\n\tprivate _detachLazyTrigger: () => void;\r\n\tprivate _shadowImageElement: ShadowImageElement;\r\n\tprivate readonly _onMatchChange: () => void;\r\n\r\n\tstatic get EMPTY_IMAGE() {\r\n\t\treturn 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';\r\n\t}\r\n\r\n\tstatic get observedAttributes() {\r\n\t\treturn ['alt', 'data-alt', 'data-src', 'data-src-base', 'mode', 'lazy-triggered'];\r\n\t}\r\n\r\n\tprivate static className: string;\r\n\r\n\tpublic static register(tagName: string, className: string = tagName) {\r\n\t\tSmartImage.className = className;\r\n\t\tcustomElements.define(tagName, SmartImage);\r\n\t}\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis._onLoad = this._onLoad.bind(this);\r\n\t\tthis._onError = this._onError.bind(this);\r\n\t\tthis._onMatchChange = this.update.bind(this, false);\r\n\t}\r\n\r\n\tget lazy(): boolean {\r\n\t\treturn this.hasAttribute('lazy') || this.lazyManual;\r\n\t}\r\n\r\n\tget lazyAuto(): boolean {\r\n\t\treturn this.hasAttribute('lazy') && !this.lazyManual;\r\n\t}\r\n\r\n\tget srcRules() {\r\n\t\tif (!this._srcRules) {\r\n\t\t\tthis.srcRules = SmartRuleList.parse<string>(this.src, SmartRuleList.STRING_PARSER);\r\n\t\t}\r\n\t\treturn this._srcRules;\r\n\t}\r\n\r\n\tset srcRules(rules: SmartRuleList<string>) {\r\n\t\tif (this._srcRules) {\r\n\t\t\tthis._srcRules.removeListener(this._onMatchChange);\r\n\t\t}\r\n\t\tthis._srcRules = rules;\r\n\t\tthis._srcRules.addListener(this._onMatchChange);\r\n\t}\r\n\r\n\tget currentSrc() {\r\n\t\treturn this._currentSrc;\r\n\t}\r\n\r\n\tget empty() {\r\n\t\treturn !this._currentSrc || SmartImage.isEmptyImage(this._currentSrc);\r\n\t}\r\n\r\n\tpublic triggerLoad() {\r\n\t\tthis.setAttribute('lazy-triggered', '');\r\n\t}\r\n\r\n\tprotected changeMode(oldVal: string, newVal: string) {\r\n\t\toldVal = oldVal || 'save-ratio';\r\n\t\tnewVal = newVal || 'save-ratio';\r\n\t\tif (oldVal !== newVal) {\r\n\t\t\tif (!STRATEGIES[newVal]) {\r\n\t\t\t\tthrow new Error('Smart Image: Unsupported mode: ' + newVal);\r\n\t\t\t}\r\n\t\t\tif (this.mode !== newVal) {\r\n\t\t\t\tthis.mode = newVal;\r\n\t\t\t}\r\n\t\t\tif (this.mode !== 'origin' && this._innerImg) {\r\n\t\t\t\tthis.removeChild(this._innerImg);\r\n\t\t\t\tthis._innerImg = null;\r\n\t\t\t}\r\n\t\t\tthis.update(true);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected update(force: boolean = false) {\r\n\t\tif (this.lazy && !this.lazyTriggered) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst rule = this.srcRules.active;\r\n\t\tconst src = this.getPath(rule.payload);\r\n\t\tconst dpr = rule.DPR;\r\n\r\n\t\tif (this._currentSrc !== src || force) {\r\n\t\t\tthis._currentSrc = src;\r\n\t\t\tthis._shadowImg.src = src;\r\n\t\t\tthis._shadowImg.dpr = dpr;\r\n\r\n\t\t\tif (this.refreshOnUpdate || !this.ready) {\r\n\t\t\t\tthis.syncImage();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._detachLazyTrigger && this._detachLazyTrigger();\r\n    }\r\n\r\n\tprotected getPath(src: string) {\r\n\t\tif (!src || src === '0' || src === 'none') {\r\n\t\t\treturn SmartImage.EMPTY_IMAGE;\r\n\t\t}\r\n\t\treturn this.srcBase + src;\r\n\t}\r\n\r\n\tpublic refresh() {\r\n\t\tthis.removeAttribute('loaded');\r\n\t\tthis.removeAttribute('ready');\r\n\t\tthis.style.paddingTop = null;\r\n\t\tthis.style.background = null;\r\n\t\tthis.update(true);\r\n\t}\r\n\r\n\tprivate syncImage() {\r\n\t\tconst shadowImg = this._shadowImg;\r\n\t\tconst src = shadowImg.src;\r\n\t\tconst isEmpty = !src || SmartImage.isEmptyImage(src);\r\n\r\n\t\tif (STRATEGIES[this.mode].useInnerImg) {\r\n\t\t\tthis._innerImage.src = src;\r\n\t\t\tthis.style.backgroundImage = null;\r\n\t\t} else {\r\n\t\t\tthis.style.backgroundImage = isEmpty ? null : `url(\"${src}\")`;\r\n\t\t}\r\n\t\tif (STRATEGIES[this.mode].afterLoad) {\r\n\t\t\tSTRATEGIES[this.mode].afterLoad.call(this, shadowImg, isEmpty);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected connectedCallback() {\r\n\t\tif ((this.constructor as typeof SmartImage).className) {\r\n\t\t\tthis.classList.add((this.constructor as typeof SmartImage).className);\r\n\t\t}\r\n\t\tthis.alt = this.alt || this.getAttribute('data-alt') || '';\r\n\t\tif (!this.hasAttribute('role')) {\r\n\t\t\tthis.setAttribute('role', 'img');\r\n\t\t}\r\n\t\tthis.update(true);\r\n\t\tif (this.lazyAuto && !this.lazyTriggered) {\r\n\t\t\tgetIObserver().observe(this);\r\n\t\t\tthis._detachLazyTrigger = function () {\r\n\t\t\t\tgetIObserver().unobserve(this);\r\n\t\t\t\tthis._detachLazyTrigger = null;\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\tprotected disconnectedCallback() {\r\n\t\tthis.removeAttribute('lazy-triggered');\r\n\t\tthis._detachLazyTrigger && this._detachLazyTrigger();\r\n\t\tif (this._srcRules) {\r\n\t\t\tthis._srcRules.removeListener(this._onMatchChange);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected attributeChangedCallback(attrName: string, oldVal: string, newVal: string) {\r\n\t\tswitch (attrName) {\r\n\t\t\tcase 'data-alt':\r\n\t\t\t\tthis.alt = this.alt || this.getAttribute('data-alt') || '';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'alt':\r\n\t\t\t\tthis._innerImg && (this._innerImg.alt = this.alt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'data-src':\r\n\t\t\t\tthis.srcRules = SmartRuleList.parse<string>(newVal, SmartRuleList.STRING_PARSER);\r\n\t\t\t\tthis.refresh();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'data-src-base':\r\n\t\t\t\tthis.refresh();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'mode':\r\n\t\t\t\tthis.changeMode(oldVal, newVal);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'lazy-triggered':\r\n\t\t\t\tthis.update(true);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected get _innerImage() {\r\n\t\tif (!this._innerImg) {\r\n\t\t\tthis._innerImg = this.querySelector('img');\r\n\t\t\tif (!this._innerImg) {\r\n\t\t\t\tthis._innerImg = document.createElement('img');\r\n\t\t\t\tthis.appendChild(this._innerImg);\r\n\t\t\t}\r\n\t\t\tthis._innerImg.className = 'inner-image';\r\n\t\t\tthis._innerImg.alt = this.alt;\r\n\t\t}\r\n\t\treturn this._innerImg;\r\n\t}\r\n\r\n\tprotected get _shadowImg() {\r\n\t\tif (!this._shadowImageElement) {\r\n\t\t\tthis._shadowImageElement = new Image();\r\n\t\t\tthis._shadowImageElement.onload = this._onLoad;\r\n\t\t\tthis._shadowImageElement.onerror = this._onError;\r\n\t\t}\r\n\t\treturn this._shadowImageElement;\r\n\t}\r\n\r\n\tprivate _onLoad() {\r\n\t\tthis.syncImage();\r\n\t\tthis.removeAttribute('error');\r\n\t\tthis.setAttribute('loaded', '');\r\n\t\ttriggerComponentEvent(this, 'load');\r\n\t\tthis._onReady();\r\n\t}\r\n\r\n\tprivate _onError() {\r\n\t\tthis.setAttribute('error', '');\r\n\t\ttriggerComponentEvent(this, 'error');\r\n\t\tthis._onReady();\r\n\t}\r\n\r\n\tprivate _onReady() {\r\n\t\tif (!this.ready) {\r\n\t\t\tthis.setAttribute('ready', '');\r\n\t\t\ttriggerComponentEvent(this, 'ready');\r\n\t\t\tif (this.hasAttribute('container-class') || this.hasAttribute('container-class-target')) {\r\n\t\t\t\tif (this.hasAttribute('container-class-onload') && this.error) return;\r\n\t\t\t\tconst containerCls = this.getAttribute('container-class') || 'img-container-loaded';\r\n\t\t\t\tconst target = this.getAttribute('container-class-target');\r\n\t\t\t\tconst targetEl = target ? this.closest(target) : this.parentNode;\r\n\t\t\t\t(targetEl) && (targetEl as HTMLElement).classList.add(containerCls);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static isEmptyImage(src: string) {\r\n\t\treturn src === SmartImage.EMPTY_IMAGE;\r\n\t}\r\n}\r\n\r\nexport default SmartImage;\r\n","/**\r\n * Group restriction manager for {@link SmartVideo}\r\n * Only one video in group can be played\r\n * Empty group is ignored\r\n * @version 1.0.1\r\n * @author Alexey Stsefanovich (ala'n)\r\n */\r\nimport SmartVideo from './smart-video';\r\n\r\n\r\ninterface VideoManager {\r\n\t[key: string]: SmartVideo\r\n}\r\n\r\nconst managerMap: VideoManager = {};\r\n\r\n\r\nexport class VideoGroupRestrictionManager {\r\n\t/**\r\n\t * @debug info\r\n\t */\r\n\tstatic get _managerMap() {\r\n\t\treturn managerMap;\r\n\t}\r\n\r\n\t/**\r\n\t * Register instance play state in group\r\n\t */\r\n\tpublic static registerPlay(instance: SmartVideo) {\r\n\t\tif (instance.group) {\r\n\t\t\tconst current = managerMap[instance.group];\r\n\t\t\tif (current && current !== instance && current.active) {\r\n\t\t\t\tif (current.dispatchEvent(new Event('evideo:mangedpause', {bubbles: true}))) {\r\n\t\t\t\t\tcurrent.pause();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tmanagerMap[instance.group] = instance;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Unregister instance\r\n\t */\r\n\tpublic static unregister(instance: SmartVideo) {\r\n\t\tif (instance.group) {\r\n\t\t\tconst reg = managerMap[instance.group];\r\n\t\t\tif (reg === instance) {\r\n\t\t\t\tmanagerMap[instance.group] = null;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default VideoGroupRestrictionManager;\r\n","import SmartVideo from './smart-video';\r\n\r\nconst RATIO_TO_ACTIVATE = 0.75; // TODO: customizable\r\nconst RATIO_TO_DEACTIVATE = 0.20; // TODO: customizable\r\n\r\nlet iObserver: IntersectionObserver;\r\n\r\nexport function getIObserver(lazy: boolean = false) {\r\n\tif (!iObserver && !lazy) {\r\n\t\tiObserver = new IntersectionObserver(function (entries) {\r\n\t\t\tentries.forEach(handleViewport);\r\n\t\t}, {\r\n\t\t\tthreshold: [RATIO_TO_DEACTIVATE, RATIO_TO_ACTIVATE]\r\n\t\t});\r\n\t}\r\n\treturn iObserver;\r\n}\r\n\r\nfunction handleViewport(entire: IntersectionObserverEntry) {\r\n\tif (!(entire.target instanceof SmartVideo)) return;\r\n\tconst {target: video} = entire;\r\n\t// Videos that playing and out of min ratio RATIO_TO_DEACTIVATE should be stopped\r\n\tif (video.onplaying && entire.intersectionRatio <= RATIO_TO_DEACTIVATE) {\r\n\t\tvideo.pause();\r\n\t}\r\n\t// Play should starts only for inactive and background(muted) videos that are visible more then on RATIO_TO_ACTIVATE\r\n\tif (!video.onplaying && video.muted && entire.intersectionRatio >= RATIO_TO_ACTIVATE) {\r\n\t\tvideo.play(true);\r\n\t}\r\n}\r\n","/**\r\n * BaseProvider class for video API providers\r\n * @version 1.0.0\r\n * @author Alexey Stsefanovich (ala'n)\r\n */\r\nimport SmartVideo from './smart-video';\r\nimport PlayerState = YT.PlayerState;\r\n\r\nexport enum PlayerStates {\r\n\tBUFFERING = 3,\r\n\tENDED = 0,\r\n\tPAUSED = 2,\r\n\tPLAYING = 1,\r\n\tUNSTARTED = -1,\r\n\tVIDEO_CUED = 5,\r\n\tUNINITIALIZED = null\r\n}\r\n\r\nexport type BaseProviderConstructor = new(component: SmartVideo) => BaseProvider;\r\n\r\nexport abstract class BaseProvider {\r\n\tprotected component: SmartVideo;\r\n\tprotected _ready: Promise<any>;\r\n\r\n\tpublic constructor(component: SmartVideo) {\r\n\t\tthis.component = component;\r\n\t}\r\n\r\n\t/**\r\n\t * Wraps _ready promise\r\n\t * @returns {Promise}\r\n\t */\r\n\tget ready() {\r\n\t\tif (!this._ready) {\r\n\t\t\tconst res = Promise.reject('Not Initialized');\r\n\t\t\t// eslint-disable-next-line no-console\r\n\t\t\tres.catch((e) => console.log('Rejected Video Operation: ', e));\r\n\t\t\treturn res;\r\n\t\t}\r\n\t\treturn this._ready;\r\n\t}\r\n\r\n\tpublic abstract bind(): void;\r\n\tpublic abstract unbind(): void;\r\n\r\n\tpublic abstract getState(): PlayerStates | PlayerState;\r\n\r\n\tprotected abstract seekTo(pos?: number): void;\r\n\tprotected abstract play(): void;\r\n\tprotected abstract pause(): void;\r\n\tprotected abstract stop(): void;\r\n\r\n\tpublic abstract focus(): void;\r\n\r\n\tprotected toggle() {\r\n\t\tif (this.getState() === PlayerStates.PAUSED) {\r\n\t\t\tthis.play();\r\n\t\t} else {\r\n\t\t\tthis.pause();\r\n\t\t}\r\n\t}\r\n\r\n\t// Safe methods executed after api ready\r\n\tpublic safeSeekTo(pos: number) {\r\n\t\tthis.ready.then(() => this.seekTo(pos));\r\n\t}\r\n\r\n\tpublic safePlay() {\r\n\t\tthis.ready.then(() => this.play());\r\n\t}\r\n\r\n\tpublic safePause() {\r\n\t\tthis.ready.then(() => this.pause());\r\n\t}\r\n\r\n\tpublic safeStop() {\r\n\t\tthis.ready.then(() => this.stop());\r\n\t}\r\n\r\n\tpublic safeToggle() {\r\n\t\tthis.ready.then(() => this.toggle());\r\n\t}\r\n}\r\n","/**\r\n * Video Registry class to store video API providers\r\n * @version 1.0.0\r\n * @author Yuliya Adamskaya\r\n */\r\nimport {Observable} from '../../../helpers/abstract/observable';\r\nimport {BaseProviderConstructor} from './smart-video-provider';\r\n\r\ninterface ProviderMap {\r\n\t[name: string]: BaseProviderConstructor;\r\n}\r\n\r\nexport class EmbeddedVideoProviderRegistry extends Observable {\r\n\tprivate static _instance: EmbeddedVideoProviderRegistry = null;\r\n\r\n\tprivate providers: ProviderMap = {};\r\n\r\n\tpublic static get instance() {\r\n\t\tif (!EmbeddedVideoProviderRegistry._instance) {\r\n\t\t\tEmbeddedVideoProviderRegistry._instance = new EmbeddedVideoProviderRegistry();\r\n\t\t}\r\n\t\treturn EmbeddedVideoProviderRegistry._instance;\r\n\t}\r\n\r\n\tpublic register(provider: BaseProviderConstructor, name: string) {\r\n\t\tthis.providers[name] = provider;\r\n\t\tthis.fire(name, provider);\r\n\t}\r\n\r\n\tpublic getProvider(name: string) {\r\n\t\treturn this.providers[name.toLowerCase()];\r\n\t}\r\n}\r\n\r\nexport default EmbeddedVideoProviderRegistry.instance;\r\n","/**\r\n * Smart Video Embedded\r\n * @version 1.0.2\r\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya\r\n *\r\n * @description:\r\n * SmartVideoEmbedded - custom element, that provides ability to add and configure embedded video using one tag.\r\n * Supported features:\r\n * - extendable 'Providers' realization for different video types, support 'youtube' and 'brightcove' out of box\r\n * - single active player restriction by grouping elements\r\n * - provides events on state change\r\n * - provides 'HTMLMedia like' API that is safe and will executed after real api will be ready\r\n * - manual initialization - disabled component will not be initialized until it not enabled or play action triggered\r\n * - hot changes\r\n *\r\n * Attributes:\r\n * {String} video-id - id of embedded video\r\n * {String} video-type - type of video provider ('youtube', 'video')\r\n *\r\n * {String} [group] - group name, only one video player in group can be active\r\n *\r\n * {Boolean} [disabled] - prevents video api initialization\r\n *\r\n * {Boolean} [autofocus] - set focus to player on play\r\n * {Boolean} [autoplay] - start play automatically on initialization (note initialization not happens until video is disabled)\r\n * {Boolean} [hide-controls] - hiding video player controls\r\n * {Boolean} [hide-subtitles] - disable subtitles settings if player supports subtitles\r\n *\r\n *\r\n * @readonly {Boolean} ready - marker that indicates that video api loaded\r\n * @readonly {Boolean} active - marker that indicates that video paying\r\n *\r\n *\r\n * @event evideo:ready - (bubbles) happens when video api is ready\r\n * @event evideo:play - (bubbles) happens when video starts playing\r\n * @event evideo:paused - (bubbles) happens when video paused\r\n * @event evideo:ended - (bubbles) happens when video ends\r\n *\r\n * @event evideo:mangedpause - (bubbles) happens when video paused by video group restriction manager\r\n *\r\n * @example:\r\n * <smart-video\r\n *    [disabled]\r\n *    title=\"Video Title\"\r\n *    [group=\"videoGroup\"]\r\n *    video-type=\"youtube|video\"\r\n *    data-id=\"##VIDEOID##\"></smart-video-embedded>\r\n */\r\nimport {debounce} from '../../../helpers/function-utils';\r\n\r\nimport VideoGroupRestrictionManager from './smart-video-manager';\r\n\r\nimport {getIObserver} from './smart-video-iobserver';\r\nimport {attr} from '../../../helpers/decorators/attr';\r\nimport {BaseProvider, PlayerStates} from './smart-video-provider';\r\nimport providerRegistry from './smart-video-registry';\r\nimport SmartQuery from '../../smart-query/ts/smart-query';\r\nimport {triggerComponentEvent} from '../../../helpers/component-utils';\r\n\r\nexport class SmartVideo extends HTMLElement {\r\n    @attr() public videoType: string;\r\n    @attr() public group: string;\r\n    @attr({conditional: true}) public disabled: boolean;\r\n    @attr({conditional: true}) public autoplay: boolean;\r\n    @attr({conditional: true}) public autofocus: boolean;\r\n    @attr({conditional: true}) public preload: boolean;\r\n    @attr({conditional: true}) public muted: boolean;\r\n    @attr({conditional: true}) public loop: boolean;\r\n    @attr({conditional: true}) public hideControls: boolean;\r\n    @attr({conditional: true}) public hideSubtitles: boolean;\r\n    @attr({conditional: true, readonly: true}) public ready: boolean;\r\n    @attr({conditional: true, readonly: true}) public active: boolean;\r\n    @attr({conditional: true, readonly: true}) public playInViewport: boolean;\r\n\r\n    private _provider: BaseProvider;\r\n    private _conditionQuery: SmartQuery;\r\n\r\n    static get is() {\r\n        return 'smart-video';\r\n    }\r\n\r\n    /**\r\n     * @enum Map with possible Player States\r\n     * values: BUFFERING, ENDED, PAUSED, PLAYING, UNSTARTED, VIDEO_CUED, UNINITIALIZED\r\n     */\r\n    static get PLAYER_STATES() {\r\n        return PlayerStates;\r\n    }\r\n\r\n    static get observedAttributes() {\r\n        return ['video-type', 'disabled', 'data-id', 'data-src'];\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        this._onError = this._onError.bind(this);\r\n        this._onConditionStateChange = this._onConditionStateChange.bind(this);\r\n    }\r\n\r\n    private connectedCallback() {\r\n        this.classList.add(SmartVideo.is);\r\n        this.setAttribute('role', 'application');\r\n        this.innerHTML += '<!-- Inner Content, do not modify it manually -->';\r\n        providerRegistry.addListener(this._onRegistryStateChange);\r\n        this._onConditionStateChange();\r\n        if (this.conditionQuery) {\r\n            this.conditionQuery.addListener(this._onConditionStateChange);\r\n        }\r\n        !this.disabled && this.reinitInstance();\r\n    }\r\n\r\n    private disconnectedCallback() {\r\n        providerRegistry.removeListener(this._onRegistryStateChange);\r\n        if (this.conditionQuery) {\r\n            this.conditionQuery.removeListener(this._onConditionStateChange);\r\n        }\r\n        this.detachViewportConstraint();\r\n        this._provider && this._provider.unbind();\r\n    }\r\n\r\n    private attributeChangedCallback(attrName: string, oldVal: string, newVal: string) {\r\n        if (oldVal === newVal) return;\r\n        switch (attrName) {\r\n            case 'data-id':\r\n            case 'data-src':\r\n            case 'video-type':\r\n                if (this._provider || this._provider === null) {\r\n                    this.deferedReinit();\r\n                }\r\n                break;\r\n            case 'disabled':\r\n                if (!this._provider) {\r\n                    this.deferedReinit();\r\n                }\r\n                break;\r\n        }\r\n    }\r\n\r\n    private reinitInstance() {\r\n        if (!this.disabled) {\r\n            this._provider && this._provider.unbind();\r\n\r\n            const provider = providerRegistry.getProvider(this.videoType);\r\n            if (provider) {\r\n                this._provider = new provider(this);\r\n                this._provider.bind();\r\n                if (this.playInViewport) {\r\n                    this.attachViewportConstraint();\r\n                }\r\n            } else {\r\n                this._provider = null;\r\n            }\r\n        }\r\n    }\r\n\r\n    public deferedReinit = debounce(() => this.reinitInstance());\r\n\r\n    public buildOptions() {\r\n        return {\r\n            title: this.title,\r\n            autoplay: this.autoplay,\r\n            muted: this.muted,\r\n            hideControls: this.hideControls,\r\n            dataId: this.dataset.id,\r\n            dataSrc: this.dataset.src,\r\n        };\r\n    }\r\n\r\n    private _updateMarkers(addValue: string, removeValue: string) {\r\n        const target = this.getAttribute('marker-target');\r\n        const targetEl = target ? this.closest(target) : this;\r\n        (targetEl && addValue) && targetEl.classList.add(addValue);\r\n        (targetEl && removeValue) && targetEl.classList.remove(removeValue);\r\n    }\r\n\r\n    private _onConditionStateChange() {\r\n        if (!this.conditionQuery || this.conditionQuery.matches) {\r\n            this.deferedReinit();\r\n            if (this.state === PlayerStates.PAUSED) {\r\n                this.play(true);\r\n            }\r\n            this._updateMarkers(\r\n                this.getAttribute('load-condition-marker'),\r\n                this.getAttribute('load-condition-declined-marker')\r\n            );\r\n        } else {\r\n            this.pause();\r\n            this._updateMarkers(\r\n                this.getAttribute('load-condition-declined-marker'),\r\n                this.getAttribute('load-condition-marker')\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Seek to given position of video\r\n     * @returns {Promise | void}\r\n     */\r\n    public seekTo(pos: number) {\r\n        return this._provider && this._provider.safeSeekTo(pos);\r\n    }\r\n\r\n    /**\r\n     * Start playing video\r\n     * @returns {Promise | void}\r\n     */\r\n    public play(reset: boolean = false) {\r\n        if (this.disabled && reset) {\r\n            this.disabled = false;\r\n        }\r\n        return this._provider && this._provider.safePlay();\r\n    }\r\n\r\n    /**\r\n     * Pause playing video\r\n     * @returns {Promise | void}\r\n     */\r\n    public pause() {\r\n        return this._provider && this._provider.safePause();\r\n    }\r\n\r\n    /**\r\n     * Stop playing video\r\n     * @returns {Promise | void}\r\n     */\r\n    public stop() {\r\n        return this._provider && this._provider.safeStop();\r\n    }\r\n\r\n    /**\r\n     * Toggle play/pause state of the video\r\n     * @returns {Promise | void}\r\n     */\r\n    public toggle() {\r\n        return this._provider && this._provider.safeToggle();\r\n    }\r\n\r\n    /**\r\n     * @override\r\n     */\r\n    public focus() {\r\n        this._provider && this._provider.focus();\r\n    }\r\n\r\n    // Video live-cycle handlers\r\n    public _onReady() {\r\n        this.setAttribute('ready', 'true');\r\n        if (this.hasAttribute('ready-class')) {\r\n            this.classList.add(this.getAttribute('ready-class'));\r\n        }\r\n        this.dispatchEvent(new Event('evideo:ready', {bubbles: true}));\r\n    }\r\n\r\n    public _onError() {\r\n        this.setAttribute('ready', '');\r\n        this.setAttribute('error', '');\r\n        triggerComponentEvent(this, 'error');\r\n        triggerComponentEvent(this, 'ready');\r\n    }\r\n\r\n    public _onDetach() {\r\n        this.removeAttribute('active');\r\n        this.removeAttribute('ready');\r\n        if (this.hasAttribute('ready-class')) {\r\n            this.classList.remove(this.getAttribute('ready-class'));\r\n        }\r\n    }\r\n\r\n    public _onPlay() {\r\n        if (this.autofocus) {\r\n            this.focus();\r\n        }\r\n        this.setAttribute('active', '');\r\n        this.dispatchEvent(new Event('evideo:play', {bubbles: true}));\r\n        VideoGroupRestrictionManager.registerPlay(this);\r\n    }\r\n\r\n    public _onPaused() {\r\n        this.removeAttribute('active');\r\n        this.dispatchEvent(new Event('evideo:paused', {bubbles: true}));\r\n        VideoGroupRestrictionManager.unregister(this);\r\n    }\r\n\r\n    public _onEnded() {\r\n        this.removeAttribute('active');\r\n        this.dispatchEvent(new Event('evideo:ended', {bubbles: true}));\r\n        VideoGroupRestrictionManager.unregister(this);\r\n    }\r\n\r\n    /**\r\n     * Current player state, see {@link SmartVideo.PLAYER_STATES} values\r\n     */\r\n    get state() {\r\n        return this._provider ? this._provider.getState() : PlayerStates.UNINITIALIZED;\r\n    }\r\n\r\n    get conditionQuery() {\r\n        if (!this._conditionQuery && this._conditionQuery !== null) {\r\n            const query = this.getAttribute('load-condition');\r\n            this._conditionQuery = query ? new SmartQuery(query) : null;\r\n        }\r\n        return this._conditionQuery;\r\n    }\r\n\r\n    private _onRegistryStateChange = (name: string) => {\r\n        if (name === this.videoType) {\r\n            this.reinitInstance();\r\n        }\r\n    };\r\n\r\n    public attachViewportConstraint() {\r\n        getIObserver().observe(this);\r\n    }\r\n\r\n    public detachViewportConstraint() {\r\n        const observer = getIObserver(true);\r\n        observer && observer.unobserve(this);\r\n    }\r\n}\r\n\r\ncustomElements.define(SmartVideo.is, SmartVideo);\r\nexport default SmartVideo;\r\n","/***\r\n * Function that do nothing\r\n */\r\n/* tslint:disable-next-line no-empty */\r\nexport function noop() {\r\n\r\n}\r\n\r\n/***\r\n * Creates a debounced function that delays invoking func until after wait milliseconds have elapsed\r\n * since the last time the debounced function was invoked.\r\n * The func is invoked with the last arguments provided to the debounced function.\r\n * @param fn\r\n * @param wait\r\n * @param immediate indicate whether func should be invoked on the leading and/or trailing edge of the wait timeout.\r\n * @returns {Function}\r\n */\r\n/* tslint:disable-next-line ban-types */\r\nexport function debounce<T extends Function>(fn: T, wait: number = 10, immediate: boolean = false): T {\r\n    let timeout: ReturnType<typeof setTimeout> = null;\r\n    return function (...args: any) {\r\n        const context = this;\r\n        const later = function () {\r\n            timeout = null;\r\n            if (!immediate) fn.apply(context, args);\r\n        };\r\n        const callNow = immediate && !timeout;\r\n        clearTimeout(timeout);\r\n        timeout = setTimeout(later, wait);\r\n        if (callNow) fn.apply(context, args);\r\n    } as any as T\r\n}\r\n\r\n/***\r\n * Creates a throttled executed function.\r\n * The func is invoked with the last arguments provided to the throttled function.\r\n * @param fn\r\n * @param threshold - indicates how often function could be called\r\n * @returns {Function}\r\n */\r\n/* tslint:disable-next-line ban-types */\r\nexport function throttle <T extends Function>(fn: T, threshold: number = 250): T {\r\n    let last: number;\r\n    let deferTimer: ReturnType<typeof setTimeout>;\r\n    return function (...args: any) {\r\n        const context = this;\r\n        const now = Date.now();\r\n        if (last && now < last + threshold) {\r\n            // hold on to it\r\n            clearTimeout(deferTimer);\r\n            deferTimer = setTimeout(function () {\r\n                last = now;\r\n                fn.apply(context, args);\r\n            }, threshold);\r\n        } else {\r\n            last = now;\r\n            fn.apply(context, args);\r\n        }\r\n    } as any as T;\r\n}\r\n","/**\r\n * Youtube API provider for {@link SmartVideo}\r\n * @version 1.0.0\r\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya\r\n * @extends BaseProvider\r\n * @protected\r\n */\r\nimport {generateUId, loadScript} from '../../../../helpers/common-utils';\r\nimport SmartVideo from '../smart-video';\r\nimport {BaseProvider, PlayerStates} from '../smart-video-provider';\r\nimport EmbeddedVideoProviderRegistry from '../smart-video-registry';\r\n\r\ndeclare global {\r\n\tinterface YT extends Promise<void> {\r\n\t\tPlayer: YT.Player,\r\n\t}\r\n\tinterface Window {\r\n\t\tYT?: YT;\r\n\t\tonYouTubeIframeAPIReady?: () => void;\r\n\t}\r\n}\r\n\r\ninterface VideoOptions {\r\n\ttitle: string,\r\n\tdataId: string,\r\n\tautoplay: boolean,\r\n\thideControls: boolean\r\n}\r\n\r\nexport class YouTubeProvider extends BaseProvider {\r\n\tprivate _el: HTMLIFrameElement;\r\n\tprivate _api: YT.Player;\r\n\r\n\tstatic get videoName() {\r\n\t\treturn 'youtube';\r\n\t}\r\n\r\n\tprivate static _coreApiPromise: Promise<void>;\r\n\r\n\tprotected static getCoreApi() {\r\n\t\tif (!YouTubeProvider._coreApiPromise) {\r\n\t\t\tYouTubeProvider._coreApiPromise = new Promise((resolve) => {\r\n\t\t\t\tif (window.YT && window.YT.Player) {\r\n\t\t\t\t\treturn resolve(window.YT);\r\n\t\t\t\t}\r\n\t\t\t\tloadScript('YT_API_SOURCE', '//www.youtube.com/iframe_api');\r\n\t\t\t\tconst cbOrigin = window.onYouTubeIframeAPIReady;\r\n\t\t\t\twindow.onYouTubeIframeAPIReady = () => {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\t(typeof cbOrigin === 'function') && cbOrigin.apply(window);\r\n\t\t\t\t\t} catch (err) { // eslint-disable-line\r\n\t\t\t\t\t\t// Do Nothing\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn resolve(window.YT);\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn YouTubeProvider._coreApiPromise;\r\n\t}\r\n\r\n\tprotected static buildIframeUrl(id: string, autoplay: boolean) {\r\n\t\treturn `//www.youtube.com/embed/${id}?wmode=transparent&rel=0&showinfo=0&iv_load_policy=3&enablejsapi=1&autoplay=${Number(autoplay)}`;\r\n\t}\r\n\r\n\tprotected static buildIframe(data: VideoOptions) {\r\n\t\tconst el = document.createElement('iframe');\r\n\t\tel.id = 'yt-video-' + generateUId();\r\n\t\tel.className = 'sev-inner sev-youtube';\r\n\t\tel.style.width = '100%';\r\n\t\tel.style.height = '100%';\r\n\t\tel.title = data.title;\r\n\t\tel.setAttribute('aria-label', data.title);\r\n\t\tel.setAttribute('frameborder', '0');\r\n\t\tel.setAttribute('tabindex', '0');\r\n\t\tel.setAttribute('allowfullscreen', 'yes');\r\n\t\tel.src = YouTubeProvider.buildIframeUrl(data.dataId, data.autoplay);\r\n\t\treturn el;\r\n\t}\r\n\r\n\tpublic bind() {\r\n\t\tconst iframeLoad = new Promise((resolve) => {\r\n\t\t\tthis._el = YouTubeProvider.buildIframe(this.component.buildOptions());\r\n\t\t\tthis._el.onload = function () {\r\n\t\t\t\tresolve();\r\n\t\t\t};\r\n\t\t\tthis.component.appendChild(this._el);\r\n\t\t});\r\n\r\n\t\tthis._ready = Promise.all([YouTubeProvider.getCoreApi(), iframeLoad]).then(\r\n\t\t\t() => (new Promise((resolve, reject) => {\r\n\t\t\t\tthis._api = new YT.Player(this._el, {\r\n\t\t\t\t\tevents: {\r\n\t\t\t\t\t\tonError: () => reject(this), // TODO do smth with it\r\n\t\t\t\t\t\tonReady: () => resolve(this),\r\n\t\t\t\t\t\tonStateChange: this._onStateChange\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}))\r\n\t\t);\r\n\t\tthis._ready.then(() => this.component._onReady());\r\n\t}\r\n\r\n\tpublic unbind() {\r\n\t\tthis.component._onDetach();\r\n\t\tif (this._api) {\r\n\t\t\tthis._api.destroy();\r\n\t\t\tthis._api = null;\r\n\t\t}\r\n\t\tif (this._el && this._el.parentNode) {\r\n\t\t\tthis._el.parentNode.removeChild(this._el);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _onStateChange = (event: YT.OnStateChangeEvent) => {\r\n\t\tswitch (+event.data) {\r\n\t\t\tcase PlayerStates.PLAYING:\r\n\t\t\t\tthis.component._onPlay();\r\n\t\t\t\tbreak;\r\n\t\t\tcase PlayerStates.PAUSED:\r\n\t\t\t\tthis.component._onPaused();\r\n\t\t\t\tbreak;\r\n\t\t\tcase PlayerStates.ENDED:\r\n\t\t\t\tthis.component._onEnded();\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t};\r\n\r\n\tpublic focus() {\r\n\t\tif (this._el && this._el.contentWindow) {\r\n\t\t\tthis._el.contentWindow.focus();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getState() {\r\n\t\tif (this._api && typeof this._api.getPlayerState === 'function') {\r\n\t\t\treturn this._api.getPlayerState();\r\n\t\t}\r\n\t\treturn PlayerStates.UNINITIALIZED;\r\n\t}\r\n\r\n\tpublic seekTo(pos: number) {\r\n\t\tthis._api.seekTo(pos, false);\r\n\t}\r\n\r\n\tpublic play() {\r\n\t\tif (this.getState() === PlayerStates.ENDED) {\r\n\t\t\tthis._api.seekTo(0, false);\r\n\t\t}\r\n\t\tthis._api.playVideo();\r\n\t}\r\n\r\n\tpublic pause() {\r\n\t\tthis._api.pauseVideo();\r\n\t}\r\n\r\n\tpublic stop() {\r\n\t\tthis._api.stopVideo();\r\n\t}\r\n}\r\n\r\nEmbeddedVideoProviderRegistry.register(YouTubeProvider, YouTubeProvider.videoName);\r\n\r\n","/**\r\n * Common function that loads script async\r\n * @param {String} id - unique script id that used as a marker to prevent feature load\r\n * @param {String} src - script src (url) to load\r\n */\r\nexport function loadScript(id: string, src: string) {\r\n\tif (!document.getElementById(id)) {\r\n\t\tconst tag = document.createElement('script');\r\n\t\ttag.id = id;\r\n\t\ttag.async = true;\r\n\t\ttag.src = src;\r\n\t\tconst firstScriptTag = document.getElementsByTagName('script')[0];\r\n\t\tfirstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\r\n\t}\r\n}\r\n\r\n/**\r\n * Generate unique id\r\n * @returns {String}\r\n */\r\nexport function generateUId(): string {\r\n\tconst fp = Date.now().toString(32);\r\n\tconst sp = Math.round(Math.random() * 1024 * 1024).toString(32);\r\n\treturn fp + '-' + sp;\r\n}\r\n/**\r\n * Deep compare\r\n */\r\nexport function deepCompare(obj1: any, obj2: any): boolean {\r\n\tif (Object.is(obj1, obj2)) return true;\r\n\tif (typeof obj1 !== typeof obj1) return false;\r\n\tif (typeof obj1 === 'object') {\r\n\t\tconst keys1 = Object.keys(obj1);\r\n\t\tconst keys2 = Object.keys(obj2);\r\n\t\tif (keys1.length !== keys2.length) return false;\r\n\t\treturn !keys1.some((key) => !deepCompare(obj1[key], obj2[key]));\r\n\t}\r\n\treturn false;\r\n}\r\n","/**\r\n * Simple Video API provider for {@link SmartVideo}\r\n * @author Yuliya Adamskaya\r\n */\r\n\r\nimport SmartVideo from '../smart-video';\r\nimport {BaseProvider, PlayerStates} from '../smart-video-provider';\r\nimport EmbeddedVideoProviderRegistry from '../smart-video-registry';\r\n\r\ninterface VideoOptions {\r\n    autoplay: boolean,\r\n    muted: boolean,\r\n    hideControls: boolean,\r\n    dataSrc: string,\r\n}\r\n\r\nexport class VideoProvider extends BaseProvider {\r\n    private _el: HTMLVideoElement;\r\n\r\n    static get videoName() {\r\n        return 'video';\r\n    }\r\n\r\n    protected static buildSrc(src: string, type?: string) {\r\n        return `<source src=${src} type=\"${type ? type : 'video/mp4'}\">`;\r\n    }\r\n\r\n    protected static build(data: VideoOptions) {\r\n        const el = document.createElement('video');\r\n        el.innerHTML = VideoProvider.buildSrc(data.dataSrc);\r\n        el.className = 'sev-inner';\r\n        el.autoplay = data.autoplay;\r\n        el.preload = 'auto';\r\n        el.loop = false;\r\n        el.tabIndex = 0;\r\n        el.muted = data.muted;\r\n        if (!data.hideControls) {\r\n            el.controls = true;\r\n        }\r\n        return el;\r\n    }\r\n\r\n    public bind() {\r\n        this._el = VideoProvider.build(this.component.buildOptions());\r\n        this.component.appendChild(this._el);\r\n        this._el.onerror = this.component._onError;\r\n        this._el.addEventListener('loadedmetadata', () => this.component._onReady());\r\n    }\r\n\r\n    public unbind() {\r\n        this.component._onDetach();\r\n        if (this._el && this._el.parentNode) {\r\n            this._el.parentNode.removeChild(this._el);\r\n        }\r\n    }\r\n\r\n    get ready() {\r\n        return Promise.resolve();\r\n    }\r\n\r\n    public focus() {\r\n        if (this._el) {\r\n            this._el.focus();\r\n        }\r\n    }\r\n\r\n    public getState() {\r\n        return PlayerStates.UNINITIALIZED;\r\n    }\r\n\r\n    public seekTo(pos: number) {\r\n        this._el.currentTime = pos;\r\n    }\r\n\r\n    public play() {\r\n        return this._el.play();\r\n    }\r\n\r\n    public pause() {\r\n        return this._el.pause()\r\n    }\r\n\r\n    public stop() {\r\n        return new Promise(() => {\r\n            this._el.pause();\r\n            this._el.currentTime = 0;\r\n        })\r\n    }\r\n}\r\n\r\nEmbeddedVideoProviderRegistry.register(VideoProvider, VideoProvider.videoName);\r\n\r\n","import SmartCarousel from '../smart-carousel';\r\n\r\nabstract class SmartCarouselStrategy {\r\n\r\n\tprotected carousel: SmartCarousel;\r\n\r\n\tprotected constructor(carousel: SmartCarousel) {\r\n\t\tthis.carousel = carousel;\r\n\t}\r\n\r\n\tpublic abstract onAnimate(nextIndex: number, direction: string): void;\r\n\r\n\tpublic abstract cleanStyles(): void;\r\n}\r\n\r\nexport default SmartCarouselStrategy;\r\n","import SmartCarouselStrategy from './smart-carousel-strategy';\r\nimport SmartCarousel from '../smart-carousel';\r\n\r\nclass SmartSingleCarouselStrategy extends SmartCarouselStrategy {\r\n\r\n\tconstructor(carousel: SmartCarousel) {\r\n\t\tsuper(carousel);\r\n\t}\r\n\r\n\tpublic onAnimate(nextIndex: number, direction: string) {\r\n\t\tif (this.carousel.firstIndex === nextIndex) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.carousel.setAttribute('data-is-animated', 'true');\r\n\t\tthis.carousel.setAttribute('direction', direction);\r\n\r\n\t\tconst activeSlide = this.carousel.$slides[this.carousel.firstIndex];\r\n\t\tconst nextSlide = this.carousel.$slides[nextIndex];\r\n\r\n\t\tactiveSlide.classList.add(direction);\r\n\t\tnextSlide.classList.add(direction);\r\n\r\n\t\tactiveSlide.classList.add('prev');\r\n\r\n\t\tactiveSlide.addEventListener('animationend', (e) => this._cleanAnimation(e));\r\n\t\tnextSlide.addEventListener('animationend', (e) => this._cleanAnimation(e));\r\n\t}\r\n\r\n\tprivate _cleanAnimation(event: Event) {\r\n\t\tconst target = event.target as HTMLElement;\r\n\t\tconst direction = this.carousel.getAttribute('direction');\r\n\r\n\t\ttarget.classList.remove(direction);\r\n\t\ttarget.classList.remove('prev');\r\n\r\n\t\tthis.carousel.removeAttribute('data-is-animated');\r\n\t}\r\n\r\n\tpublic cleanStyles() {\r\n\r\n\t}\r\n}\r\n\r\nexport default SmartSingleCarouselStrategy;\r\n","import SmartCarouselStrategy from './smart-carousel-strategy';\r\nimport SmartCarousel from '../smart-carousel';\r\n\r\n\r\nclass SmartMultiCarouselStrategy extends SmartCarouselStrategy {\r\n\r\n\tconstructor(carousel: SmartCarousel) {\r\n\t\tsuper(carousel);\r\n\t}\r\n\r\n\tpublic onAnimate(nextIndex: number, direction: string) {\r\n\t\tconst slideStyles = getComputedStyle(this.carousel.$slides[this.carousel.firstIndex]);\r\n\t\tconst slideWidth = parseFloat(slideStyles.width) +\r\n\t\t\tparseFloat(slideStyles.marginLeft) +\r\n\t\t\tparseFloat(slideStyles.marginRight);\r\n\t\tconst areaWidth = slideWidth * this.carousel.$slides.length;\r\n\r\n\t\tconst transitionDuration = parseFloat(slideStyles.transitionDuration) * 1000; // ms\r\n\t\tconst currentLeft = parseFloat(slideStyles.left);\r\n\r\n\t\tif (this.carousel.firstIndex === nextIndex) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\tlet trans = 0;\r\n\r\n\t\tif ((nextIndex === 0 && direction === 'right' && this.carousel.firstIndex !== 0) || (this.carousel.firstIndex === 0 && direction === 'left')) {\r\n\t\t\tconst left = (direction === 'right') ? currentLeft + areaWidth : currentLeft - areaWidth;\r\n\r\n\t\t\tfor (let index = 0; index < this.carousel.activeCount; ++index) {\r\n\t\t\t\tthis.carousel.$slides[nextIndex + index].style.left = left + 'px';\r\n\t\t\t}\r\n\r\n\t\t\ttrans = -nextIndex * slideWidth - left;\r\n\t\t\tthis.carousel.$slides.forEach((el) => {\r\n\t\t\t\tel.style.transform = `translateX(${trans}px)`;\r\n\t\t\t});\r\n\r\n\t\t\tfor (let i = 0; i < this.carousel.activeCount; i++) {\r\n\t\t\t\tthis.carousel.$slides[this.carousel.firstIndex + i].style.left = currentLeft + 'px';\r\n\t\t\t\tconst time = (direction === 'right') ?\r\n\t\t\t\t\t(transitionDuration / this.carousel.activeCount) * i :\r\n\t\t\t\t\t(transitionDuration / this.carousel.activeCount) * (this.carousel.activeCount - i - 1);\r\n\t\t\t\tif (this.carousel.activeIndexes.indexOf(nextIndex + i) !== -1) {\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tthis.carousel.$slides[this.carousel.firstIndex + i].style.left = left + 'px';\r\n\t\t\t\t\t\tconst nextTrans = -nextIndex * slideWidth - left;\r\n\t\t\t\t\t\tthis.carousel.$slides[this.carousel.firstIndex + i].style.transform = `translateX(${nextTrans}px)`;\r\n\t\t\t\t\t}, time);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\ttrans = -nextIndex * slideWidth - currentLeft;\r\n\t\t\tthis.carousel.$slides.forEach((el) => {\r\n\t\t\t\tel.style.transform = `translateX(${trans}px)`;\r\n\t\t\t\tel.style.left = currentLeft + 'px';\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tthis.carousel.setAttribute('data-is-animated', 'true');\r\n\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.carousel.removeAttribute('data-is-animated');\r\n\t\t}, transitionDuration);\r\n\r\n\t}\r\n\r\n\tpublic cleanStyles() {\r\n\t}\r\n}\r\n\r\nexport default SmartMultiCarouselStrategy;\r\n","class SmartCarouselSlide extends HTMLElement {\r\n\tstatic get is() { return 'smart-carousel-slide'; }\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tprotected connectedCallback() {\r\n\t\t//\r\n\t}\r\n\r\n\tpublic get index(): number {\r\n\t\treturn Array.prototype.indexOf.call(this.parentNode.childNodes, this);\r\n\t}\r\n\r\n\tpublic get active(): boolean {\r\n\t\treturn this.hasAttribute('active');\r\n\t}\r\n\r\n\tpublic _setActive(active: boolean) {\r\n\t\tthis.toggleAttribute('active', active);\r\n\t}\r\n}\r\n\r\ncustomElements.define(SmartCarouselSlide.is, SmartCarouselSlide);\r\nexport default SmartCarouselSlide;\r\n","import {attr} from '../../../helpers/decorators/attr';\r\nimport {deepCompare} from '../../../helpers/common-utils';\r\nimport {triggerComponentEvent} from '../../../helpers/component-utils';\r\nimport SmartRuleList from '../../smart-query/ts/smart-rule-list';\r\nimport SmartCarouselStrategy from './strategy/smart-carousel-strategy';\r\nimport SmartSingleCarouselStrategy from './strategy/smart-single-carousel-strategy';\r\nimport SmartMultiCarouselStrategy from './strategy/smart-multi-carousel-strategy';\r\nimport SmartCarouselSlide from './smart-carousel-slide';\r\n\r\ninterface StrategyMap {\r\n    [type: string]: (carousel: SmartCarousel) => SmartCarouselStrategy\r\n}\r\n\r\ninterface CarouselCurrentConfig {\r\n    strategy?: 'single' | 'multiple',\r\n    count?: number,\r\n    className?: string\r\n}\r\n\r\nconst STRATEGIES: StrategyMap = { // TODO registry\r\n    single: (carousel: SmartCarousel) => new SmartSingleCarouselStrategy(carousel),\r\n    multi: (carousel: SmartCarousel) => new SmartMultiCarouselStrategy(carousel),\r\n};\r\n\r\nclass SmartCarousel extends HTMLElement {\r\n\r\n    static get is() {\r\n        return 'smart-carousel';\r\n    }\r\n\r\n    static get observedAttributes() {\r\n        return ['config', 'strategy'];\r\n    }\r\n\r\n    @attr() public config: string;\r\n    @attr({defaultValue: 'single'}) public strategy: string;\r\n\r\n    private _configRules: SmartRuleList<CarouselCurrentConfig>;\r\n    private _currentConfig: CarouselCurrentConfig;\r\n    private _strategy: SmartCarouselStrategy;\r\n\r\n    private readonly _onMatchChange: () => void;\r\n\r\n    constructor() {\r\n        super();\r\n        this._onMatchChange = this.update.bind(this, false);\r\n        this._currentConfig = {};\r\n    }\r\n\r\n    get $slidesArea(): HTMLElement {\r\n        return this.querySelector('[data-slides-area]');\r\n    }\r\n\r\n    get $slides(): SmartCarouselSlide[] {\r\n        // TODO cache\r\n        const els = this.$slidesArea.querySelectorAll(SmartCarouselSlide.is) as NodeListOf<SmartCarouselSlide>;\r\n        return els ? Array.from(els) : [];\r\n    }\r\n\r\n    get count(): number {\r\n        return this.$slides.length || 0;\r\n    }\r\n\r\n    get activeIndexes(): number[] {\r\n        return this.$slides.reduce((activeIndexes: number[], el, index) => {\r\n            if (el.active) {\r\n                activeIndexes.push(index);\r\n            }\r\n            return activeIndexes;\r\n        }, []);\r\n    }\r\n\r\n    get activeCount(): number {\r\n        return this._currentConfig.count || 0;\r\n    }\r\n\r\n    get customClass(): string {\r\n        return this._currentConfig.className;\r\n    }\r\n\r\n    public goTo(nextIndex: number, direction?: string, force: boolean = false) {\r\n        if (this.dataset.isAnimated) {\r\n            return;\r\n        }\r\n        // show last slides if count of slides isn't enough\r\n        if (nextIndex + this.activeCount > this.count || nextIndex < 0) {\r\n            nextIndex = this.count - this.activeCount;\r\n        }\r\n\r\n        if (this.firstIndex === nextIndex && !force) {\r\n            return;\r\n        }\r\n\r\n        if (!direction) {\r\n            direction = (nextIndex > this.firstIndex) ? 'right' : 'left';\r\n        }\r\n\r\n        const approved = triggerComponentEvent(this, 'sc:slide:change', {bubbles: true}); // Todo change info\r\n\r\n        if (this._strategy && approved && this.firstIndex !== nextIndex) {\r\n            this._strategy.onAnimate(nextIndex, direction);\r\n        }\r\n\r\n        if (this._strategy && approved) {\r\n            this.$slides.forEach((el, index) => {\r\n                el._setActive((nextIndex <= index) && (index < nextIndex + this.activeCount));\r\n            });\r\n        }\r\n\r\n        triggerComponentEvent(this, 'sc:slide:changed', {bubbles: true}); // Todo change info\r\n    }\r\n\r\n    public prev() {\r\n        const nextGroup = this.getNextGroup(-1);\r\n        this.goTo(nextGroup * this.activeCount, 'left');\r\n    }\r\n\r\n    public next() {\r\n        const nextGroup = this.getNextGroup(1);\r\n        this.goTo(nextGroup * this.activeCount, 'right');\r\n    }\r\n\r\n    protected connectedCallback() {\r\n        this.classList.add(SmartCarousel.is);\r\n       // this.$slides.forEach((slide: SmartCarouselSlide, index) => slide.index = index);\r\n\r\n        this.update(true);\r\n        this._bindEvents();\r\n    }\r\n\r\n    protected disconnectedCallback() {\r\n        this._unbindEvents();\r\n    }\r\n\r\n    private attributeChangedCallback(attrName: string, oldVal: string, newVal: string) {\r\n        switch (attrName) {\r\n            case 'config':\r\n            case 'strategy':\r\n                this.updateStrategy();\r\n                this.configRules = SmartRuleList.parse<object>(this.config, SmartRuleList.OBJECT_PARSER) as SmartRuleList<CarouselCurrentConfig>;\r\n                this.update(true);\r\n                break;\r\n        }\r\n    }\r\n\r\n    protected _bindEvents() {\r\n        this.addEventListener('click', this._onClick, false);\r\n    }\r\n\r\n    protected _unbindEvents() {\r\n        this.removeEventListener('click', this._onClick, false);\r\n    }\r\n\r\n    protected updateStrategy() {\r\n        this._strategy = STRATEGIES[this.strategy](this);\r\n    }\r\n\r\n    get configRules() {\r\n        if (!this._configRules) {\r\n            this.configRules = SmartRuleList.parse<CarouselCurrentConfig>(this.config, SmartRuleList.OBJECT_PARSER);\r\n        }\r\n        return this._configRules;\r\n    }\r\n\r\n    set configRules(rules: SmartRuleList<CarouselCurrentConfig>) {\r\n        if (this._configRules) {\r\n            this._configRules.removeListener(this._onMatchChange);\r\n        }\r\n        this._configRules = rules;\r\n        this._configRules.addListener(this._onMatchChange);\r\n    }\r\n\r\n    private update(force: boolean = false) {\r\n        const config: CarouselCurrentConfig = Object.assign(\r\n            {strategy: 'single', count: 1},\r\n            this.configRules.activeValue\r\n        );\r\n        if (deepCompare(this._currentConfig, config) || !force) {\r\n           return;\r\n        }\r\n        this._currentConfig = config;\r\n        const count = (this._currentConfig) ? this._currentConfig.count : config.count;\r\n        if (force || this.activeIndexes.length !== count || count !== config.count) {\r\n            const slideStyles = getComputedStyle(this.$slides[this.firstIndex]);\r\n            const currentTrans = parseFloat(slideStyles.transform.split(',')[4]);\r\n            const slidesAreaStyles = getComputedStyle(this.$slidesArea);\r\n            const slideWidth = parseFloat(slidesAreaStyles.width) / count - parseFloat(slideStyles.marginLeft) - parseFloat(slideStyles.marginRight);\r\n            const computedLeft = -(parseFloat(slidesAreaStyles.width) / count * this.firstIndex) - (currentTrans);\r\n            this.$slides.forEach((slide) => {\r\n                slide.style.minWidth =  slideWidth + 'px';\r\n                slide.style.left = computedLeft + 'px';\r\n            });\r\n            this.goTo(this.firstIndex, '', true);\r\n        }\r\n    }\r\n\r\n    private getNextGroup(shiftGroupsCount: number) {\r\n        // get number of group of current active slides by last index of this group\r\n        const lastIndex = this.activeIndexes.length - 1;\r\n        const currentGroup = Math.floor(this.activeIndexes[lastIndex] / this.activeCount);\r\n        // get count of groups of slides\r\n        const countGroups = Math.ceil(this.count / this.activeCount);\r\n        // get number of group of next active slides\r\n        return (currentGroup + shiftGroupsCount + countGroups) % countGroups;\r\n    }\r\n\r\n    /**\r\n     * @returns {number} first active index\r\n     */\r\n    get firstIndex(): number {\r\n        return this.$slides.findIndex((slide) => {\r\n            return slide.active;\r\n        });\r\n    }\r\n\r\n    protected _onClick(event: MouseEvent) {\r\n        const eventTarget = event.target as HTMLElement;\r\n        const markedTarget = eventTarget.closest('[data-slide-target]') as HTMLElement;\r\n        if (markedTarget && markedTarget.dataset.slideTarget) {\r\n            const target = markedTarget.dataset.slideTarget;\r\n            if ('prev' === target) {\r\n                this.prev();\r\n            } else if ('next' === target) {\r\n                this.next();\r\n            } else {\r\n                this.goTo(this.activeCount * +target);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\ncustomElements.define(SmartCarousel.is, SmartCarousel);\r\nexport default SmartCarousel;\r\n","import SmartCarousel from './smart-carousel';\r\n\r\nclass SmartCarouselDots extends HTMLElement {\r\n    static get is() {\r\n        return 'smart-carousel-dots';\r\n    }\r\n\r\n    private _onUpdate = () => this.rerender();\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    protected connectedCallback() {\r\n        this.classList.add(SmartCarouselDots.is);\r\n        this.rerender();\r\n        this._bindEvents();\r\n    }\r\n\r\n    protected disconnectedCallback() {\r\n        this._unbindEvents();\r\n    }\r\n\r\n    protected _bindEvents() {\r\n        this.$parent.addEventListener('sc:slide:changed', this._onUpdate);\r\n    }\r\n\r\n    protected _unbindEvents() {\r\n        this.$parent.removeEventListener('sc:slide:changed', this._onUpdate);\r\n    }\r\n\r\n\r\n    get $parent(): SmartCarousel {\r\n        return this.closest('.' + SmartCarousel.is) as SmartCarousel;\r\n    }\r\n\r\n    public rerender() {\r\n        let html = '';\r\n        const activeDot = Math.floor(this.$parent.activeIndexes[this.$parent.activeCount - 1] / this.$parent.activeCount);\r\n        for (let i = 0; i < Math.ceil(this.$parent.count / this.$parent.activeCount); ++i) {\r\n            html += this.buildDot(i, i === activeDot);\r\n        }\r\n        this.innerHTML = html;\r\n    }\r\n\r\n    public buildDot(index: number, isActive: boolean) {\r\n        return `<button role=\"button\" class=\"carousel-dot ${isActive ? 'active-dot' : ''}\" data-slide-target=\"${index}\"></button>`;\r\n    }\r\n}\r\n\r\ncustomElements.define(SmartCarouselDots.is, SmartCarouselDots);\r\nexport default SmartCarouselDots;\r\n","// HTMLElement ES6 extends shim\r\nimport '../helpers/es5-support/es6-htmlelement-shim';\r\n\r\n// Builtin polyfills\r\nimport '../helpers/builtin-polyfils/object-polyfils';\r\nimport '../helpers/builtin-polyfils/closest-polyfill';\r\n\r\nimport {BreakpointRegistry, SmartQuery, SmartRuleList} from '../components/smart-query/smart-query';\r\nimport {SmartImage} from '../components/smart-image/smart-image';\r\nimport {SmartVideo} from '../components/smart-video/smart-video';\r\nimport {SmartCarousel, SmartCarouselDots} from '../components/smart-carousel/smart-carousel';\r\n\r\n\r\n// BreakpointRegistry.addCustomBreakpoint('xxs', 300, 600); // Definition\r\n// BreakpointRegistry.addCustomBreakpoint('xl', 1600, 2000); // Redefinition\r\n\r\n// Default definition\r\nSmartImage.register('smart-image');\r\n\r\nexport {\r\n    BreakpointRegistry,\r\n    SmartQuery,\r\n\tSmartRuleList,\r\n\tSmartImage,\r\n\tSmartVideo,\r\n    SmartCarousel,\r\n    SmartCarouselDots\r\n};\r\n"],"sourceRoot":""}